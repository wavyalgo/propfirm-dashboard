import{r as S,j as o,t as ue,a as io,R as te,b as oo,c as va,u as lo,L as rn}from"./index-lrUc2Tvq.js";import{c as Y,S as co,M as uo}from"./sun-aPxBaz-g.js";import{X as lr}from"./x-YxWIFiqt.js";import{C as ho}from"./check-yoCprAN3.js";import{M as fo}from"./monitor-Bucp1h9C.js";import{C as Ze}from"./chevron-down-nsGbgWRd.js";import{H as po}from"./house-mVvtvO8Z.js";const go=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Xt=Y("activity",go);const mo=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],bo=Y("arrow-right-left",mo);const xo=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],vo=Y("chart-column",xo);const yo=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],sn=Y("chart-pie",yo);const wo=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],_o=Y("circle-alert",wo);const ko=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],nn=Y("circle-arrow-down",ko);const So=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],an=Y("circle-arrow-up",So);const No=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],jo=Y("circle-check-big",No);const Eo=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Co=Y("dollar-sign",Eo);const Ro=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Ao=Y("ellipsis",Ro);const Io=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],ya=Y("funnel",Io);const Oo=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],ks=Y("grip-vertical",Oo);const To=[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]],Po=Y("key-round",To);const Do=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],$o=Y("layout-grid",Do);const Lo=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],wa=Y("loader-circle",Lo);const Bo=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Uo=Y("lock",Bo);const Mo=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Fo=Y("log-out",Mo);const Wo=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Go=Y("mail",Wo);const qo=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],wr=Y("pen",qo);const Vo=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],zo=Y("pencil",Vo);const Ho=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ir=Y("plus",Ho);const Ko=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ss=Y("settings",Ko);const Jo=[["path",{d:"M13.172 2a2 2 0 0 1 1.414.586l6.71 6.71a2.4 2.4 0 0 1 0 3.408l-4.592 4.592a2.4 2.4 0 0 1-3.408 0l-6.71-6.71A2 2 0 0 1 6 9.172V3a1 1 0 0 1 1-1z",key:"16rjxf"}],["path",{d:"M2 7v6.172a2 2 0 0 0 .586 1.414l6.71 6.71a2.4 2.4 0 0 0 3.191.193",key:"178nd4"}],["circle",{cx:"10.5",cy:"6.5",r:".5",fill:"currentColor",key:"12ikhr"}]],on=Y("tags",Jo);const Yo=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],pt=Y("trash-2",Yo);const Xo=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],_a=Y("user",Xo);const Qo=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],ka=Y("wallet",Qo);function _r(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r}function Zo(t,e,r,s){function n(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function l(h){try{d(s.next(h))}catch(u){i(u)}}function c(h){try{d(s.throw(h))}catch(u){i(u)}}function d(h){h.done?a(h.value):n(h.value).then(l,c)}d((s=s.apply(t,e||[])).next())})}const el=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Ns extends Error{constructor(e,r="FunctionsError",s){super(e),this.name=r,this.context=s}}class tl extends Ns{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ln extends Ns{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class cn extends Ns{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ns;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(ns||(ns={}));class rl{constructor(e,{headers:r={},customFetch:s,region:n=ns.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=el(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return Zo(this,arguments,void 0,function*(r,s={}){var n;let a,i;try{const{headers:l,method:c,body:d,signal:h,timeout:u}=s;let f={},{region:p}=s;p||(p=this.region);const g=new URL(`${this.url}/${r}`);p&&p!=="any"&&(f["x-region"]=p,g.searchParams.set("forceFunctionRegion",p));let m;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",m=d):typeof d=="string"?(f["Content-Type"]="text/plain",m=d):typeof FormData<"u"&&d instanceof FormData?m=d:(f["Content-Type"]="application/json",m=JSON.stringify(d)):m=d;let b=h;u&&(i=new AbortController,a=setTimeout(()=>i.abort(),u),h?(b=i.signal,h.addEventListener("abort",()=>i.abort())):b=i.signal);const x=yield this.fetch(g.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),l),body:m,signal:b}).catch(N=>{throw new tl(N)}),w=x.headers.get("x-relay-error");if(w&&w==="true")throw new ln(x);if(!x.ok)throw new cn(x);let v=((n=x.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),_;return v==="application/json"?_=yield x.json():v==="application/octet-stream"||v==="application/pdf"?_=yield x.blob():v==="text/event-stream"?_=x:v==="multipart/form-data"?_=yield x.formData():_=yield x.text(),{data:_,error:null,response:x}}catch(l){return{data:null,error:l,response:l instanceof cn||l instanceof ln?l.context:void 0}}finally{a&&clearTimeout(a)}})}}var sl=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},nl=class{constructor(t){var e,r;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(r=t.isMaybeSingle)!==null&&r!==void 0?r:!1,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let n=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{let i=null,l=null,c=null,d=a.status,h=a.statusText;if(a.ok){var u,f;if(r.method!=="HEAD"){var p;const x=await a.text();x===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((p=r.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?l=x:l=JSON.parse(x))}const m=(u=r.headers.get("Prefer"))===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),b=(f=a.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");m&&b&&b.length>1&&(c=parseInt(b[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(l)&&(l.length>1?(i={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,c=null,d=406,h="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var g;const m=await a.text();try{i=JSON.parse(m),Array.isArray(i)&&a.status===404&&(l=[],i=null,d=200,h="OK")}catch{a.status===404&&m===""?(d=204,h="No Content"):i={message:m}}if(i&&r.isMaybeSingle&&(!(i==null||(g=i.details)===null||g===void 0)&&g.includes("0 rows"))&&(i=null,d=200,h="OK"),i&&r.shouldThrowOnError)throw new sl(i)}return{error:i,data:l,count:c,status:d,statusText:h}});return this.shouldThrowOnError||(n=n.catch(a=>{var i;let l="";const c=a?.cause;if(c){var d,h,u,f;const g=(d=c?.message)!==null&&d!==void 0?d:"",m=(h=c?.code)!==null&&h!==void 0?h:"";l=`${(u=a?.name)!==null&&u!==void 0?u:"FetchError"}: ${a?.message}`,l+=`

Caused by: ${(f=c?.name)!==null&&f!==void 0?f:"Error"}: ${g}`,m&&(l+=` (${m})`),c?.stack&&(l+=`
${c.stack}`)}else{var p;l=(p=a?.stack)!==null&&p!==void 0?p:""}return{error:{message:`${(i=a?.name)!==null&&i!==void 0?i:"FetchError"}: ${a?.message}`,details:l,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),n.then(t,e)}returns(){return this}overrideTypes(){return this}},al=class extends nl{select(t){let e=!1;const r=(t??"*").split("").map(s=>/\s/.test(s)&&!e?"":(s==='"'&&(e=!e),s)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:r,foreignTable:s,referencedTable:n=s}={}){const a=n?`${n}.order`:"order",i=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${i?`${i},`:""}${t}.${e?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:r=e}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,e,{foreignTable:r,referencedTable:s=r}={}){const n=typeof s>"u"?"offset":`${s}.offset`,a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${t}`),this.url.searchParams.set(a,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:r=!1,buffers:s=!1,wal:n=!1,format:a="text"}={}){var i;const l=[t?"analyze":null,e?"verbose":null,r?"settings":null,s?"buffers":null,n?"wal":null].filter(Boolean).join("|"),c=(i=this.headers.get("Accept"))!==null&&i!==void 0?i:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${c}"; options=${l};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const dn=new RegExp("[,()]");var ct=class extends al{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const r=Array.from(new Set(e)).map(s=>typeof s=="string"&&dn.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}notIn(t,e){const r=Array.from(new Set(e)).map(s=>typeof s=="string"&&dn.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`not.in.(${r})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:r,type:s}={}){let n="";s==="plain"?n="pl":s==="phrase"?n="ph":s==="websearch"&&(n="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${n}fts${a}.${e}`),this}match(t){return Object.entries(t).forEach(([e,r])=>{this.url.searchParams.append(e,`eq.${r}`)}),this}not(t,e,r){return this.url.searchParams.append(t,`not.${e}.${r}`),this}or(t,{foreignTable:e,referencedTable:r=e}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,e,r){return this.url.searchParams.append(t,`${e}.${r}`),this}},il=class{constructor(t,{headers:e={},schema:r,fetch:s}){this.url=t,this.headers=new Headers(e),this.schema=r,this.fetch=s}select(t,e){const{head:r=!1,count:s}=e??{},n=r?"HEAD":"GET";let a=!1;const i=(t??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",i),s&&this.headers.append("Prefer",`count=${s}`),new ct({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:r=!0}={}){var s;const n="POST";if(e&&this.headers.append("Prefer",`count=${e}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const a=t.reduce((i,l)=>i.concat(Object.keys(l)),[]);if(a.length>0){const i=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",i.join(","))}}return new ct({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:r=!1,count:s,defaultToNull:n=!0}={}){var a;const i="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),e!==void 0&&this.url.searchParams.set("on_conflict",e),s&&this.headers.append("Prefer",`count=${s}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const l=t.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(l.length>0){const c=[...new Set(l)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new ct({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(t,{count:e}={}){var r;const s="PATCH";return e&&this.headers.append("Prefer",`count=${e}`),new ct({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:t}={}){var e;const r="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new ct({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}},ol=class Sa{constructor(e,{headers:r={},schema:s,fetch:n}={}){this.url=e,this.headers=new Headers(r),this.schemaName=s,this.fetch=n}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new il(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Sa(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:s=!1,get:n=!1,count:a}={}){var i;let l;const c=new URL(`${this.url}/rpc/${e}`);let d;s||n?(l=s?"HEAD":"GET",Object.entries(r).filter(([u,f])=>f!==void 0).map(([u,f])=>[u,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([u,f])=>{c.searchParams.append(u,f)})):(l="POST",d=r);const h=new Headers(this.headers);return a&&h.set("Prefer",`count=${a}`),new ct({method:l,url:c,headers:h,schema:this.schemaName,body:d,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};class ll{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const s=r.node,n=parseInt(s.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const s=this.getWebSocketConstructor();return new s(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const cl="2.89.0",dl=`realtime-js/${cl}`,Na="1.0.0",ul="2.0.0",un=Na,as=1e4,hl=1e3,fl=100;var Ue;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Ue||(Ue={}));var ae;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(ae||(ae={}));var Ie;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Ie||(Ie={}));var is;(function(t){t.websocket="websocket"})(is||(is={}));var Ye;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Ye||(Ye={}));class pl{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,s;const n=(s=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,n)}_encodeJsonUserBroadcastPush(e){var r,s;const n=(s=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:{},i=new TextEncoder().encode(JSON.stringify(n)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,i)}_encodeUserBroadcastPush(e,r,s){var n,a;const i=e.topic,l=(n=e.ref)!==null&&n!==void 0?n:"",c=(a=e.join_ref)!==null&&a!==void 0?a:"",d=e.payload.event,h=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},u=Object.keys(h).length===0?"":JSON.stringify(h);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(i.length>255)throw new Error(`topic length ${i.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`metadata length ${u.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+i.length+d.length+u.length,p=new ArrayBuffer(this.HEADER_LENGTH+f);let g=new DataView(p),m=0;g.setUint8(m++,this.KINDS.userBroadcastPush),g.setUint8(m++,c.length),g.setUint8(m++,l.length),g.setUint8(m++,i.length),g.setUint8(m++,d.length),g.setUint8(m++,u.length),g.setUint8(m++,r),Array.from(c,x=>g.setUint8(m++,x.charCodeAt(0))),Array.from(l,x=>g.setUint8(m++,x.charCodeAt(0))),Array.from(i,x=>g.setUint8(m++,x.charCodeAt(0))),Array.from(d,x=>g.setUint8(m++,x.charCodeAt(0))),Array.from(u,x=>g.setUint8(m++,x.charCodeAt(0)));var b=new Uint8Array(p.byteLength+s.byteLength);return b.set(new Uint8Array(p),0),b.set(new Uint8Array(s),p.byteLength),b.buffer}decode(e,r){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return r(s)}if(typeof e=="string"){const s=JSON.parse(e),[n,a,i,l,c]=s;return r({join_ref:n,ref:a,topic:i,event:l,payload:c})}return r({})}_binaryDecode(e){const r=new DataView(e),s=r.getUint8(0),n=new TextDecoder;if(s===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,r,n)}_decodeUserBroadcast(e,r,s){const n=r.getUint8(1),a=r.getUint8(2),i=r.getUint8(3),l=r.getUint8(4);let c=this.HEADER_LENGTH+4;const d=s.decode(e.slice(c,c+n));c=c+n;const h=s.decode(e.slice(c,c+a));c=c+a;const u=s.decode(e.slice(c,c+i));c=c+i;const f=e.slice(c,e.byteLength),p=l===this.JSON_ENCODING?JSON.parse(s.decode(f)):f,g={type:this.BROADCAST_EVENT,event:h,payload:p};return i>0&&(g.meta=JSON.parse(u)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:g}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(e,r){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([s])=>r.includes(s)))}}class ja{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var J;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(J||(J={}));const hn=(t,e,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((a,i)=>(a[i]=gl(i,t,e,n),a),{}):{}},gl=(t,e,r,s)=>{const n=e.find(l=>l.name===t),a=n?.type,i=r[t];return a&&!s.includes(a)?Ea(a,i):os(i)},Ea=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return vl(e,r)}switch(t){case J.bool:return ml(e);case J.float4:case J.float8:case J.int2:case J.int4:case J.int8:case J.numeric:case J.oid:return bl(e);case J.json:case J.jsonb:return xl(e);case J.timestamp:return yl(e);case J.abstime:case J.date:case J.daterange:case J.int4range:case J.int8range:case J.money:case J.reltime:case J.text:case J.time:case J.timestamptz:case J.timetz:case J.tsrange:case J.tstzrange:return os(e);default:return os(e)}},os=t=>t,ml=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},bl=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},xl=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},vl=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,s=t[r];if(t[0]==="{"&&s==="}"){let a;const i=t.slice(1,r);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(l=>Ea(e,l))}return t},yl=t=>typeof t=="string"?t.replace(" ","T"):t,Ca=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class $r{constructor(e,r,s={},n=as){this.channel=e,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var s;return this._hasReceived(e)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var fn;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(fn||(fn={}));class Rt{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:a,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Rt.syncState(this.state,n,a,i),this.pendingDiffs.forEach(c=>{this.state=Rt.syncDiff(this.state,c,a,i)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},n=>{const{onJoin:a,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Rt.syncDiff(this.state,n,a,i),l())}),this.onJoin((n,a,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:a,newPresences:i})}),this.onLeave((n,a,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,s,n){const a=this.cloneDeep(e),i=this.transformState(r),l={},c={};return this.map(a,(d,h)=>{i[d]||(c[d]=h)}),this.map(i,(d,h)=>{const u=a[d];if(u){const f=h.map(b=>b.presence_ref),p=u.map(b=>b.presence_ref),g=h.filter(b=>p.indexOf(b.presence_ref)<0),m=u.filter(b=>f.indexOf(b.presence_ref)<0);g.length>0&&(l[d]=g),m.length>0&&(c[d]=m)}else l[d]=h}),this.syncDiff(a,{joins:l,leaves:c},s,n)}static syncDiff(e,r,s,n){const{joins:a,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(a,(l,c)=>{var d;const h=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),h.length>0){const u=e[l].map(p=>p.presence_ref),f=h.filter(p=>u.indexOf(p.presence_ref)<0);e[l].unshift(...f)}s(l,h,c)}),this.map(i,(l,c)=>{let d=e[l];if(!d)return;const h=c.map(u=>u.presence_ref);d=d.filter(u=>h.indexOf(u.presence_ref)<0),e[l]=d,n(l,d,c),d.length===0&&delete e[l]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(s=>r(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,s)=>{const n=e[s];return"metas"in n?r[s]=n.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[s]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var pn;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(pn||(pn={}));var At;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(At||(At={}));var Le;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Le||(Le={}));class ht{constructor(e,r={config:{}},s){var n,a;if(this.topic=e,this.params=r,this.socket=s,this.bindings={},this.state=ae.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new $r(this,Ie.join,this.params,this.timeout),this.rejoinTimer=new ja(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ae.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ae.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=ae.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ae.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=ae.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ie.reply,{},(i,l)=>{this._trigger(this._replyEventName(l),i)}),this.presence=new Rt(this),this.broadcastEndpointURL=Ca(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var s,n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==ae.closed){const{config:{broadcast:i,presence:l,private:c}}=this.params,d=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(p=>p.filter))!==null&&n!==void 0?n:[],h=!!this.bindings[At.PRESENCE]&&this.bindings[At.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,u={},f={broadcast:i,presence:Object.assign(Object.assign({},l),{enabled:h}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this._onError(p=>e?.(Le.CHANNEL_ERROR,p)),this._onClose(()=>e?.(Le.CLOSED)),this.updateJoinPayload(Object.assign({config:f},u)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var g;if(this.socket._isManualToken()||this.socket.setAuth(),p===void 0){e?.(Le.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,b=(g=m?.length)!==null&&g!==void 0?g:0,x=[];for(let w=0;w<b;w++){const v=m[w],{filter:{event:_,schema:N,table:y,filter:k}}=v,C=p&&p[w];if(C&&C.event===_&&ht.isFilterValueEqual(C.schema,N)&&ht.isFilterValueEqual(C.table,y)&&ht.isFilterValueEqual(C.filter,k))x.push(Object.assign(Object.assign({},v),{id:C.id}));else{this.unsubscribe(),this.state=ae.errored,e?.(Le.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,e&&e(Le.SUBSCRIBED);return}}).receive("error",p=>{this.state=ae.errored,e?.(Le.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e?.(Le.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,s){return this.state===ae.joined&&e===At.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,r,s)}async httpSend(e,r,s={}){var n;if(r==null)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const i={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const d=await l.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(e,r={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:i}=e,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=d.body)===null||n===void 0?void 0:n.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,l,c;const d=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),d.receive("ok",()=>a("ok")),d.receive("error",()=>a("error")),d.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ae.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ie.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new $r(this,Ie.leave,{},e),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ae.closed,this.bindings={}}async _fetchWithTimeout(e,r,s){const n=new AbortController,a=setTimeout(()=>n.abort(),s),i=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(a),i}_push(e,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new $r(this,e,r,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>fl){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,s){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,s){var n,a;const i=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:h}=Ie;if(s&&[l,c,d,h].indexOf(i)>=0&&s!==this._joinRef())return;let f=this._onMessage(i,r,s);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(p=>{var g,m,b;return((g=p.filter)===null||g===void 0?void 0:g.event)==="*"||((b=(m=p.filter)===null||m===void 0?void 0:m.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===i}).map(p=>p.callback(f,s)):(a=this.bindings[i])===null||a===void 0||a.filter(p=>{var g,m,b,x,w,v;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const _=p.id,N=(g=p.filter)===null||g===void 0?void 0:g.event;return _&&((m=r.ids)===null||m===void 0?void 0:m.includes(_))&&(N==="*"||N?.toLocaleLowerCase()===((b=r.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const _=(w=(x=p?.filter)===null||x===void 0?void 0:x.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return _==="*"||_===((v=r?.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof f=="object"&&"ids"in f){const g=f.data,{schema:m,table:b,commit_timestamp:x,type:w,errors:v}=g;f=Object.assign(Object.assign({},{schema:m,table:b,commit_timestamp:x,eventType:w,new:{},old:{},errors:v}),this._getPayloadRecords(g))}p.callback(f,s)})}_isClosed(){return this.state===ae.closed}_isJoined(){return this.state===ae.joined}_isJoining(){return this.state===ae.joining}_isLeaving(){return this.state===ae.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,s){const n=e.toLocaleLowerCase(),a={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(e,r){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var a;return!(((a=n.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&ht.isEqual(n.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const s in e)if(e[s]!==r[s])return!1;return!0}static isFilterValueEqual(e,r){return(e??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ie.close,{},e)}_onError(e){this._on(Ie.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ae.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=hn(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=hn(e.columns,e.old_record)),r}}const Lr=()=>{},Qt={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},wl=[1e3,2e3,5e3,1e4],_l=1e4,kl=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Sl{constructor(e,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=as,this.transport=null,this.heartbeatIntervalMs=Qt.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Lr,this.ref=0,this.reconnectTimer=null,this.vsn=un,this.logger=Lr,this.conn=null,this.sendBuffer=[],this.serializer=new pl,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...a)=>n(...a):(...a)=>fetch(...a),!(!((s=r?.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${is.websocket}`,this.httpEndpoint=Ca(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ll.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,s){this.logger(e,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Ue.connecting:return Ye.Connecting;case Ue.open:return Ye.Open;case Ue.closing:return Ye.Closing;default:return Ye.Closed}}isConnected(){return this.connectionState()===Ye.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(a=>a.topic===s);if(n)return n;{const a=new ht(`realtime:${e}`,r,this);return this.channels.push(a),a}}push(e){const{topic:r,event:s,payload:n,ref:a}=e,i=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${s} (${a})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(hl,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Qt.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:n,payload:a,ref:i}=r,l=i?`(${i})`:"",c=a.status||"";this.log("receive",`${c} ${s} ${n} ${l}`.trim(),a),this.channels.filter(d=>d._isMember(s)).forEach(d=>d._trigger(n,a,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===Ue.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Ue.open||this.conn.readyState===Ue.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ie.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${s}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const s=new Blob([kl],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r,s=!1;if(e)r=e,s=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(n){this.log("error","Error fetching access token from callback",n),r=this.accessTokenValue}else r=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:dl};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Ie.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(r)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new ja(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Qt.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,s,n,a,i,l,c,d,h,u,f,p;switch(this.transport=(r=e?.transport)!==null&&r!==void 0?r:null,this.timeout=(s=e?.timeout)!==null&&s!==void 0?s:as,this.heartbeatIntervalMs=(n=e?.heartbeatIntervalMs)!==null&&n!==void 0?n:Qt.HEARTBEAT_INTERVAL,this.worker=(a=e?.worker)!==null&&a!==void 0?a:!1,this.accessToken=(i=e?.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(l=e?.heartbeatCallback)!==null&&l!==void 0?l:Lr,this.vsn=(c=e?.vsn)!==null&&c!==void 0?c:un,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e?.reconnectAfterMs)!==null&&d!==void 0?d:(g=>wl[g-1]||_l),this.vsn){case Na:this.encode=(h=e?.encode)!==null&&h!==void 0?h:((g,m)=>m(JSON.stringify(g))),this.decode=(u=e?.decode)!==null&&u!==void 0?u:((g,m)=>m(JSON.parse(g)));break;case ul:this.encode=(f=e?.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(p=e?.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}var Tt=class extends Error{constructor(t,e){super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Nl(t,e,r){const s=new URL(e,t);if(r)for(const[n,a]of Object.entries(r))a!==void 0&&s.searchParams.set(n,a);return s.toString()}async function jl(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function El(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:r,path:s,query:n,body:a,headers:i}){const l=Nl(t.baseUrl,s,n),c=await jl(t.auth),d=await e(l,{method:r,headers:{...a?{"Content-Type":"application/json"}:{},...c,...i},body:a?JSON.stringify(a):void 0}),h=await d.text(),u=(d.headers.get("content-type")||"").includes("application/json"),f=u&&h?JSON.parse(h):h;if(!d.ok){const p=u?f:void 0,g=p?.error;throw new Tt(g?.message??`Request failed with status ${d.status}`,{status:d.status,icebergType:g?.type,icebergCode:g?.code,details:p})}return{status:d.status,headers:d.headers,data:f}}}}function Zt(t){return t.join("")}var Cl=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:Zt(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(t,e){const r={namespace:t.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Zt(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Zt(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Zt(t.namespace)}`}),!0}catch(e){if(e instanceof Tt&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(r){if(r instanceof Tt&&r.status===409)return;throw r}}};function st(t){return t.join("")}var Rl=class{constructor(t,e="",r){this.client=t,this.prefix=e,this.accessDelegation=r}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${st(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${st(t.namespace)}/tables`,body:e,headers:r})).data.metadata}async updateTable(t,e){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${st(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${st(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${st(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${st(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(r){if(r instanceof Tt&&r.status===404)return!1;throw r}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(r){if(r instanceof Tt&&r.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw r}}},Al=class{constructor(t){let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const r=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=El({baseUrl:r,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=t.accessDelegation?.join(","),this.namespaceOps=new Cl(this.client,e),this.tableOps=new Rl(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},kr=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function ee(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var Il=class extends kr{constructor(t,e,r){super(t),this.name="StorageApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},ls=class extends kr{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};const js=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Ol=()=>Response,cs=t=>{if(Array.isArray(t))return t.map(r=>cs(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[n]=cs(s)}),e},Tl=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Pl=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function Pt(t){"@babel/helpers - typeof";return Pt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pt(t)}function Dl(t,e){if(Pt(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(Pt(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $l(t){var e=Dl(t,"string");return Pt(e)=="symbol"?e:e+""}function Ll(t,e,r){return(e=$l(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gn(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function B(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?gn(Object(r),!0).forEach(function(s){Ll(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gn(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}const Br=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},Bl=async(t,e,r)=>{t instanceof await Ol()&&!r?.noResolveJson?t.json().then(s=>{const n=t.status||500,a=s?.statusCode||n+"";e(new Il(Br(s),n,a))}).catch(s=>{e(new ls(Br(s),s))}):e(new ls(Br(t),t))},Ul=(t,e,r,s)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"||!s?n:(Tl(s)?(n.headers=B({"Content-Type":"application/json"},e?.headers),n.body=JSON.stringify(s)):n.body=s,e?.duplex&&(n.duplex=e.duplex),B(B({},n),r))};async function zt(t,e,r,s,n,a){return new Promise((i,l)=>{t(r,Ul(e,s,n,a)).then(c=>{if(!c.ok)throw c;return s?.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>Bl(c,l,s))})}async function Dt(t,e,r,s){return zt(t,"GET",e,r,s)}async function Ae(t,e,r,s,n){return zt(t,"POST",e,s,n,r)}async function ds(t,e,r,s,n){return zt(t,"PUT",e,s,n,r)}async function Ml(t,e,r,s){return zt(t,"HEAD",e,B(B({},r),{},{noResolveJson:!0}),s)}async function Es(t,e,r,s,n){return zt(t,"DELETE",e,s,n,r)}var Fl=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ee(e))return{data:null,error:e};throw e}}};let Ra;Ra=Symbol.toStringTag;var Wl=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[Ra]="BlobDownloadBuilder",this.promise=null}asStream(){return new Fl(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(ee(e))return{data:null,error:e};throw e}}};const Gl={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},mn={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var ql=class{constructor(t,e={},r,s){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=r,this.fetch=js(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(t,e,r,s){var n=this;try{let a;const i=B(B({},mn),s);let l=B(B({},n.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),c&&a.append("metadata",n.encodeMetadata(c)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.has("cacheControl")||a.append("cacheControl",i.cacheControl),c&&!a.has("metadata")&&a.append("metadata",n.encodeMetadata(c))):(a=r,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,c&&(l["x-metadata"]=n.toBase64(n.encodeMetadata(c))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!i.duplex&&(i.duplex="half")),s?.headers&&(l=B(B({},l),s.headers));const d=n._removeEmptyFolders(e),h=n._getFinalPath(d),u=await(t=="PUT"?ds:Ae)(n.fetch,`${n.url}/object/${h}`,a,B({headers:l},i?.duplex?{duplex:i.duplex}:{}));return{data:{path:d,id:u.Id,fullPath:u.Key},error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(ee(a))return{data:null,error:a};throw a}}async upload(t,e,r){return this.uploadOrUpdate("POST",t,e,r)}async uploadToSignedUrl(t,e,r,s){var n=this;const a=n._removeEmptyFolders(t),i=n._getFinalPath(a),l=new URL(n.url+`/object/upload/sign/${i}`);l.searchParams.set("token",e);try{let c;const d=B({upsert:mn.upsert},s),h=B(B({},n.headers),{"x-upsert":String(d.upsert)});return typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",d.cacheControl)):(c=r,h["cache-control"]=`max-age=${d.cacheControl}`,h["content-type"]=d.contentType),{data:{path:a,fullPath:(await ds(n.fetch,l.toString(),c,{headers:h})).Key},error:null}}catch(c){if(n.shouldThrowOnError)throw c;if(ee(c))return{data:null,error:c};throw c}}async createSignedUploadUrl(t,e){var r=this;try{let s=r._getFinalPath(t);const n=B({},r.headers);e?.upsert&&(n["x-upsert"]="true");const a=await Ae(r.fetch,`${r.url}/object/upload/sign/${s}`,{},{headers:n}),i=new URL(r.url+a.url),l=i.searchParams.get("token");if(!l)throw new kr("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:l},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(ee(s))return{data:null,error:s};throw s}}async update(t,e,r){return this.uploadOrUpdate("PUT",t,e,r)}async move(t,e,r){var s=this;try{return{data:await Ae(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r?.destinationBucket},{headers:s.headers}),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(ee(n))return{data:null,error:n};throw n}}async copy(t,e,r){var s=this;try{return{data:{path:(await Ae(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r?.destinationBucket},{headers:s.headers})).Key},error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(ee(n))return{data:null,error:n};throw n}}async createSignedUrl(t,e,r){var s=this;try{let n=s._getFinalPath(t),a=await Ae(s.fetch,`${s.url}/object/sign/${n}`,B({expiresIn:e},r?.transform?{transform:r.transform}:{}),{headers:s.headers});const i=r?.download?`&download=${r.download===!0?"":r.download}`:"";return a={signedUrl:encodeURI(`${s.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(ee(n))return{data:null,error:n};throw n}}async createSignedUrls(t,e,r){var s=this;try{const n=await Ae(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:e,paths:t},{headers:s.headers}),a=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:n.map(i=>B(B({},i),{},{signedUrl:i.signedURL?encodeURI(`${s.url}${i.signedURL}${a}`):null})),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(ee(n))return{data:null,error:n};throw n}}download(t,e){const r=typeof e?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(e?.transform||{}),n=s?`?${s}`:"",a=this._getFinalPath(t),i=()=>Dt(this.fetch,`${this.url}/${r}/${a}${n}`,{headers:this.headers,noResolveJson:!0});return new Wl(i,this.shouldThrowOnError)}async info(t){var e=this;const r=e._getFinalPath(t);try{return{data:cs(await Dt(e.fetch,`${e.url}/object/info/${r}`,{headers:e.headers})),error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(ee(s))return{data:null,error:s};throw s}}async exists(t){var e=this;const r=e._getFinalPath(t);try{return await Ml(e.fetch,`${e.url}/object/${r}`,{headers:e.headers}),{data:!0,error:null}}catch(s){if(e.shouldThrowOnError)throw s;if(ee(s)&&s instanceof ls){const n=s.originalError;if([400,404].includes(n?.status))return{data:!1,error:s}}throw s}}getPublicUrl(t,e){const r=this._getFinalPath(t),s=[],n=e?.download?`download=${e.download===!0?"":e.download}`:"";n!==""&&s.push(n);const a=typeof e?.transform<"u"?"render/image":"object",i=this.transformOptsToQueryString(e?.transform||{});i!==""&&s.push(i);let l=s.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${l}`)}}}async remove(t){var e=this;try{return{data:await Es(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}}async list(t,e,r){var s=this;try{const n=B(B(B({},Gl),e),{},{prefix:t||""});return{data:await Ae(s.fetch,`${s.url}/object/list/${s.bucketId}`,n,{headers:s.headers},r),error:null}}catch(n){if(s.shouldThrowOnError)throw n;if(ee(n))return{data:null,error:n};throw n}}async listV2(t,e){var r=this;try{const s=B({},t);return{data:await Ae(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,s,{headers:r.headers},e),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(ee(s))return{data:null,error:s};throw s}}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const Aa="2.89.0",Ia={"X-Client-Info":`storage-js/${Aa}`};var Vl=class{constructor(t,e={},r,s){this.shouldThrowOnError=!1;const n=new URL(t);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase.")),this.url=n.href.replace(/\/$/,""),this.headers=B(B({},Ia),e),this.fetch=js(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(t){var e=this;try{const r=e.listBucketOptionsToQueryString(t);return{data:await Dt(e.fetch,`${e.url}/bucket${r}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await Dt(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}}async createBucket(t,e={public:!1}){var r=this;try{return{data:await Ae(r.fetch,`${r.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(ee(s))return{data:null,error:s};throw s}}async updateBucket(t,e){var r=this;try{return{data:await ds(r.fetch,`${r.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(ee(s))return{data:null,error:s};throw s}}async emptyBucket(t){var e=this;try{return{data:await Ae(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await Es(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},zl=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=B(B({},Ia),e),this.fetch=js(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await Ae(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}}async listBuckets(t){var e=this;try{const r=new URLSearchParams;t?.limit!==void 0&&r.set("limit",t.limit.toString()),t?.offset!==void 0&&r.set("offset",t.offset.toString()),t?.sortColumn&&r.set("sortColumn",t.sortColumn),t?.sortOrder&&r.set("sortOrder",t.sortOrder),t?.search&&r.set("search",t.search);const s=r.toString(),n=s?`${e.url}/bucket?${s}`:`${e.url}/bucket`;return{data:await Dt(e.fetch,n,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await Es(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(ee(r))return{data:null,error:r};throw r}}from(t){var e=this;if(!Pl(t))throw new kr("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new Al({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(r,{get(n,a){const i=n[a];return typeof i!="function"?i:async(...l)=>{try{return{data:await i.apply(n,l),error:null}}catch(c){if(s)throw c;return{data:null,error:c}}}}})}};const Cs={"X-Client-Info":`storage-js/${Aa}`,"Content-Type":"application/json"};var Oa=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function xe(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}var Ur=class extends Oa{constructor(t,e,r){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Hl=class extends Oa{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};const Rs=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Kl=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},bn=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Jl=async(t,e,r)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!r?.noResolveJson){const s=t.status||500,n=t;if(typeof n.json=="function")n.json().then(a=>{const i=a?.statusCode||a?.code||s+"";e(new Ur(bn(a),s,i))}).catch(()=>{const a=s+"";e(new Ur(n.statusText||`HTTP ${s} error`,s,a))});else{const a=s+"";e(new Ur(n.statusText||`HTTP ${s} error`,s,a))}}else e(new Hl(bn(t),t))},Yl=(t,e,r,s)=>{const n={method:t,headers:e?.headers||{}};return s?(Kl(s)?(n.headers=B({"Content-Type":"application/json"},e?.headers),n.body=JSON.stringify(s)):n.body=s,B(B({},n),r)):n};async function Xl(t,e,r,s,n,a){return new Promise((i,l)=>{t(r,Yl(e,s,n,a)).then(c=>{if(!c.ok)throw c;if(s?.noResolveJson)return c;const d=c.headers.get("content-type");return!d||!d.includes("application/json")?{}:c.json()}).then(c=>i(c)).catch(c=>Jl(c,l,s))})}async function ve(t,e,r,s,n){return Xl(t,"POST",e,s,n,r)}var Ql=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=B(B({},Cs),e),this.fetch=Rs(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(t){var e=this;try{return{data:await ve(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(xe(r))return{data:null,error:r};throw r}}async getIndex(t,e){var r=this;try{return{data:await ve(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(xe(s))return{data:null,error:s};throw s}}async listIndexes(t){var e=this;try{return{data:await ve(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(xe(r))return{data:null,error:r};throw r}}async deleteIndex(t,e){var r=this;try{return{data:await ve(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers})||{},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(xe(s))return{data:null,error:s};throw s}}},Zl=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=B(B({},Cs),e),this.fetch=Rs(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(t){var e=this;try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await ve(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(xe(r))return{data:null,error:r};throw r}}async getVectors(t){var e=this;try{return{data:await ve(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(xe(r))return{data:null,error:r};throw r}}async listVectors(t){var e=this;try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:await ve(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(xe(r))return{data:null,error:r};throw r}}async queryVectors(t){var e=this;try{return{data:await ve(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(xe(r))return{data:null,error:r};throw r}}async deleteVectors(t){var e=this;try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await ve(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(xe(r))return{data:null,error:r};throw r}}},ec=class{constructor(t,e={},r){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=B(B({},Cs),e),this.fetch=Rs(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(t){var e=this;try{return{data:await ve(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(xe(r))return{data:null,error:r};throw r}}async getBucket(t){var e=this;try{return{data:await ve(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(xe(r))return{data:null,error:r};throw r}}async listBuckets(t={}){var e=this;try{return{data:await ve(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(xe(r))return{data:null,error:r};throw r}}async deleteBucket(t){var e=this;try{return{data:await ve(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{},error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(xe(r))return{data:null,error:r};throw r}}},tc=class extends ec{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new rc(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,r=this;return e().call(r,t)}async getBucket(t){var e=()=>super.getBucket,r=this;return e().call(r,t)}async listBuckets(t={}){var e=()=>super.listBuckets,r=this;return e().call(r,t)}async deleteBucket(t){var e=()=>super.deleteBucket,r=this;return e().call(r,t)}},rc=class extends Ql{constructor(t,e,r,s){super(t,e,s),this.vectorBucketName=r}async createIndex(t){var e=()=>super.createIndex,r=this;return e().call(r,B(B({},t),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,r=this;return e().call(r,B(B({},t),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,r=this;return e().call(r,r.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,r=this;return e().call(r,r.vectorBucketName,t)}index(t){return new sc(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},sc=class extends Zl{constructor(t,e,r,s,n){super(t,e,n),this.vectorBucketName=r,this.indexName=s}async putVectors(t){var e=()=>super.putVectors,r=this;return e().call(r,B(B({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(t){var e=()=>super.getVectors,r=this;return e().call(r,B(B({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,r=this;return e().call(r,B(B({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,r=this;return e().call(r,B(B({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,r=this;return e().call(r,B(B({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},nc=class extends Vl{constructor(t,e={},r,s){super(t,e,r,s)}from(t){return new ql(this.url,this.headers,t,this.fetch)}get vectors(){return new tc(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new zl(this.url+"/iceberg",this.headers,this.fetch)}};const Ta="2.89.0",dt=30*1e3,us=3,Mr=us*dt,ac="http://localhost:9999",ic="supabase.auth.token",oc={"X-Client-Info":`gotrue-js/${Ta}`},hs="X-Supabase-Api-Version",Pa={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},lc=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,cc=600*1e3;class $t extends Error{constructor(e,r,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function P(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class dc extends $t{constructor(e,r,s){super(e,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function uc(t){return P(t)&&t.name==="AuthApiError"}class Xe extends $t{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Be extends $t{constructor(e,r,s,n){super(e,s,n),this.name=r,this.status=s}}class be extends Be{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function hc(t){return P(t)&&t.name==="AuthSessionMissingError"}class nt extends Be{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class er extends Be{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class tr extends Be{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function fc(t){return P(t)&&t.name==="AuthImplicitGrantRedirectError"}class xn extends Be{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class pc extends Be{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class fs extends Be{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Fr(t){return P(t)&&t.name==="AuthRetryableFetchError"}class vn extends Be{constructor(e,r,s){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class ps extends Be{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const cr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),yn=` 	
\r=`.split(""),gc=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<yn.length;e+=1)t[yn[e].charCodeAt(0)]=-2;for(let e=0;e<cr.length;e+=1)t[cr[e].charCodeAt(0)]=e;return t})();function wn(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(cr[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(cr[s]),e.queuedBits-=6}}function Da(t,e,r){const s=gc[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function _n(t){const e=[],r=i=>{e.push(String.fromCodePoint(i))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},a=i=>{xc(i,s,r)};for(let i=0;i<t.length;i+=1)Da(t.charCodeAt(i),n,a);return e.join("")}function mc(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function bc(t,e){for(let r=0;r<t.length;r+=1){let s=t.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}mc(s,e)}}function xc(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let s=1;s<6;s+=1)if((t>>7-s&1)===0){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function ft(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)Da(t.charCodeAt(n),r,s);return new Uint8Array(e)}function vc(t){const e=[];return bc(t,r=>e.push(r)),new Uint8Array(e)}function Qe(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};return t.forEach(n=>wn(n,r,s)),wn(null,r,s),e.join("")}function yc(t){return Math.round(Date.now()/1e3)+t}function wc(){return Symbol("auth-callback")}const de=()=>typeof window<"u"&&typeof document<"u",Ve={tested:!1,writable:!1},$a=()=>{if(!de())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ve.tested)return Ve.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ve.tested=!0,Ve.writable=!0}catch{Ve.tested=!0,Ve.writable=!1}return Ve.writable};function _c(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,a)=>{e[a]=n})}catch{}return r.searchParams.forEach((s,n)=>{e[n]=s}),e}const La=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),kc=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",ut=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},ze=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ce=async(t,e)=>{await t.removeItem(e)};class Sr{constructor(){this.promise=new Sr.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}Sr.promiseConstructor=Promise;function Wr(t){const e=t.split(".");if(e.length!==3)throw new ps("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!lc.test(e[s]))throw new ps("JWT not in base64url format");return{header:JSON.parse(_n(e[0])),payload:JSON.parse(_n(e[1])),signature:ft(e[2]),raw:{header:e[0],payload:e[1]}}}async function Sc(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Nc(t,e){return new Promise((s,n)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await t(a);if(!e(a,null,i)){s(i);return}}catch(i){if(!e(a,i)){n(i);return}}})()})}function jc(t){return("0"+t.toString(16)).substr(-2)}function Ec(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let a=0;a<56;a++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,jc).join("")}async function Cc(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(a=>String.fromCharCode(a)).join("")}async function Rc(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await Cc(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function at(t,e,r=!1){const s=Ec();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await ut(t,`${e}-code-verifier`,n);const a=await Rc(s);return[a,s===a?"plain":"s256"]}const Ac=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Ic(t){const e=t.headers.get(hs);if(!e||!e.match(Ac))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Oc(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Tc(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Pc=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function it(t){if(!Pc.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Gr(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Dc(t,e){return new Proxy(t,{get:(r,s,n)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const a=s.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,n)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,s,n)}})}function kn(t){return JSON.parse(JSON.stringify(t))}const Ke=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),$c=[502,503,504];async function Sn(t){var e;if(!kc(t))throw new fs(Ke(t),0);if($c.includes(t.status))throw new fs(Ke(t),t.status);let r;try{r=await t.json()}catch(a){throw new Xe(Ke(a),a)}let s;const n=Ic(t);if(n&&n.getTime()>=Pa["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new vn(Ke(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new be}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new vn(Ke(r),t.status,r.weak_password.reasons);throw new dc(Ke(r),t.status||500,s)}const Lc=(t,e,r,s)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function L(t,e,r,s){var n;const a=Object.assign({},s?.headers);a[hs]||(a[hs]=Pa["2024-01-01"].name),s?.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const i=(n=s?.query)!==null&&n!==void 0?n:{};s?.redirectTo&&(i.redirect_to=s.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await Bc(t,e,r+l,{headers:a,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(c):{data:Object.assign({},c),error:null}}async function Bc(t,e,r,s,n,a){const i=Lc(e,s,n,a);let l;try{l=await t(r,Object.assign({},i))}catch(c){throw console.error(c),new fs(Ke(c),0)}if(l.ok||await Sn(l),s?.noResolveJson)return l;try{return await l.json()}catch(c){await Sn(c)}}function Re(t){var e;let r=null;Fc(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=yc(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:s},error:null}}function Nn(t){const e=Re(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Me(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Uc(t){return{data:t,error:null}}function Mc(t){const{action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:a}=t,i=_r(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:a},c=Object.assign({},i);return{data:{properties:l,user:c},error:null}}function jn(t){return t}function Fc(t){return t.access_token&&t.refresh_token&&t.expires_in}const qr=["global","local","others"];class Wc{constructor({url:e="",headers:r={},fetch:s}){this.url=e,this.headers=r,this.fetch=La(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=qr[0]){if(qr.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${qr.join(", ")}`);try{return await L(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(P(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,r={}){try{return await L(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Me})}catch(s){if(P(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:r}=e,s=_r(e,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s?.newEmail,delete n.newEmail),await L(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Mc,redirectTo:r?.redirectTo})}catch(r){if(P(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await L(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Me})}catch(r){if(P(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,s,n,a,i,l,c;try{const d={nextPage:null,lastPage:0,total:0},h=await L(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:jn});if(h.error)throw h.error;const u=await h.json(),f=(i=h.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(g.split(";")[1].split("=")[1]);d[`${b}Page`]=m}),d.total=parseInt(f)),{data:Object.assign(Object.assign({},u),d),error:null}}catch(d){if(P(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){it(e);try{return await L(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Me})}catch(r){if(P(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){it(e);try{return await L(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Me})}catch(s){if(P(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,r=!1){it(e);try{return await L(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Me})}catch(s){if(P(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){it(e.userId);try{const{data:r,error:s}=await L(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(P(r))return{data:null,error:r};throw r}}async _deleteFactor(e){it(e.userId),it(e.id);try{return{data:await L(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(P(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,s,n,a,i,l,c;try{const d={nextPage:null,lastPage:0,total:0},h=await L(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:jn});if(h.error)throw h.error;const u=await h.json(),f=(i=h.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(g.split(";")[1].split("=")[1]);d[`${b}Page`]=m}),d.total=parseInt(f)),{data:Object.assign(Object.assign({},u),d),error:null}}catch(d){if(P(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await L(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(P(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await L(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(P(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await L(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(P(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await L(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(P(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await L(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(P(r))return{data:null,error:r};throw r}}}function En(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const ot={debug:!!(globalThis&&$a()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ba extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Gc extends Ba{}async function qc(t,e,r){ot.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),ot.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){ot.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{ot.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw ot.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new Gc(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(ot.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function Vc(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Ua(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function zc(t){return parseInt(t,16)}function Hc(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function Kc(t){var e;const{chainId:r,domain:s,expirationTime:n,issuedAt:a=new Date,nonce:i,notBefore:l,requestId:c,resources:d,scheme:h,uri:u,version:f}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!u)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const p=Ua(t.address),g=h?`${h}://${s}`:s,m=t.statement?`${t.statement}
`:"",b=`${g} wants you to sign in with your Ethereum account:
${p}

${m}`;let x=`URI: ${u}
Version: ${f}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${a.toISOString()}`;if(n&&(x+=`
Expiration Time: ${n.toISOString()}`),l&&(x+=`
Not Before: ${l.toISOString()}`),c&&(x+=`
Request ID: ${c}`),d){let w=`
Resources:`;for(const v of d){if(!v||typeof v!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${v}`);w+=`
- ${v}`}x+=w}return`${b}
${x}`}class ne extends Error{constructor({message:e,code:r,cause:s,name:n}){var a;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(a=n??(s instanceof Error?s.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=r}}class dr extends ne{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function Jc({error:t,options:e}){var r,s,n;const{publicKey:a}=e;if(!a)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new ne({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new ne({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new ne({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new ne({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new ne({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new ne({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return a.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new ne({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new ne({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const i=window.location.hostname;if(Ma(i)){if(a.rp.id!==i)return new ne({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new ne({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new ne({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new ne({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new ne({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function Yc({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new ne({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new ne({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(Ma(s)){if(r.rpId!==s)return new ne({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new ne({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new ne({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new ne({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class Xc{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const Qc=new Xc;function Zc(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:s}=t,n=_r(t,["challenge","user","excludeCredentials"]),a=ft(e).buffer,i=Object.assign(Object.assign({},r),{id:ft(r.id).buffer}),l=Object.assign(Object.assign({},n),{challenge:a,user:i});if(s&&s.length>0){l.excludeCredentials=new Array(s.length);for(let c=0;c<s.length;c++){const d=s[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:ft(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function ed(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,s=_r(t,["challenge","allowCredentials"]),n=ft(e).buffer,a=Object.assign(Object.assign({},s),{challenge:n});if(r&&r.length>0){a.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const l=r[i];a.allowCredentials[i]=Object.assign(Object.assign({},l),{id:ft(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return a}function td(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:Qe(new Uint8Array(t.response.attestationObject)),clientDataJSON:Qe(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function rd(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,s=t.getClientExtensionResults(),n=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:Qe(new Uint8Array(n.authenticatorData)),clientDataJSON:Qe(new Uint8Array(n.clientDataJSON)),signature:Qe(new Uint8Array(n.signature)),userHandle:n.userHandle?Qe(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Ma(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Cn(){var t,e;return!!(de()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function sd(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new dr("Browser returned unexpected credential type",e)}:{data:null,error:new dr("Empty credential response",e)}}catch(e){return{data:null,error:Jc({error:e,options:t})}}}async function nd(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new dr("Browser returned unexpected credential type",e)}:{data:null,error:new dr("Empty credential response",e)}}catch(e){return{data:null,error:Yc({error:e,options:t})}}}const ad={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},id={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function ur(...t){const e=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),s={};for(const n of t)if(n)for(const a in n){const i=n[a];if(i!==void 0)if(Array.isArray(i))s[a]=i;else if(r(i))s[a]=i;else if(e(i)){const l=s[a];e(l)?s[a]=ur(l,i):s[a]=ur(i)}else s[a]=i}return s}function od(t,e){return ur(ad,t,e||{})}function ld(t,e){return ur(id,t,e||{})}class cd{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:s,signal:n},a){try{const{data:i,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!i)return{data:null,error:l};const c=n??Qc.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:d}=i.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${s}`),d.displayName||(d.displayName=d.name)}switch(i.webauthn.type){case"create":{const d=od(i.webauthn.credential_options.publicKey,a?.create),{data:h,error:u}=await sd({publicKey:d,signal:c});return h?{data:{factorId:e,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:h}},error:null}:{data:null,error:u}}case"request":{const d=ld(i.webauthn.credential_options.publicKey,a?.request),{data:h,error:u}=await nd(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:d,signal:c}));return h?{data:{factorId:e,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:h}},error:null}:{data:null,error:u}}}}catch(i){return P(i)?{data:null,error:i}:{data:null,error:new Xe("Unexpected error in challenge",i)}}}async _verify({challengeId:e,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},a){if(!r)return{data:null,error:new $t("rpId is required for WebAuthn authentication")};try{if(!Cn())return{data:null,error:new Xe("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:s},signal:n},{request:a});if(!i)return{data:null,error:l};const{webauthn:c}=i;return this._verify({factorId:e,challengeId:i.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:s,credential_response:c.credential_response}})}catch(i){return P(i)?{data:null,error:i}:{data:null,error:new Xe("Unexpected error in authenticate",i)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}={}},a){if(!r)return{data:null,error:new $t("rpId is required for WebAuthn registration")};try{if(!Cn())return{data:null,error:new Xe("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this._enroll({friendlyName:e});if(!i)return await this.client.mfa.listFactors().then(h=>{var u;return(u=h.data)===null||u===void 0?void 0:u.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(h=>h?this.client.mfa.unenroll({factorId:h?.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:n},{create:a});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:s,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(i){return P(i)?{data:null,error:i}:{data:null,error:new Xe("Unexpected error in register",i)}}}}Vc();const dd={url:ac,storageKey:ic,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:oc,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Rn(t,e,r){return await r()}const lt={};class Lt{get jwks(){var e,r;return(r=(e=lt[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){lt[this.storageKey]=Object.assign(Object.assign({},lt[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=lt[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){lt[this.storageKey]=Object.assign(Object.assign({},lt[this.storageKey]),{cachedAt:e})}constructor(e){var r,s,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},dd),e);if(this.storageKey=a.storageKey,this.instanceID=(r=Lt.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Lt.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&de()){const i=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(i),this.logDebugMessages&&console.trace(i)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new Wc({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=La(a.fetch),this.lock=a.lock||Rn,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:this.persistSession&&de()&&(!((s=globalThis?.navigator)===null||s===void 0)&&s.locks)?this.lock=qc:this.lock=Rn,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new cd(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:$a()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=En(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=En(this.memoryStorage)),de()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Ta}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},s="none";if(de()&&(r=_c(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),de()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:a}=await this._getSessionFromURL(r,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),fc(a)){const c=(e=a.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return P(r)?this._returnResult({error:r}):this._returnResult({error:new Xe("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,s,n;try{const a=await L(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:Re}),{data:i,error:l}=a;if(l||!i)return this._returnResult({data:{user:null,session:null},error:l});const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(a){if(P(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(e){var r,s,n;try{let a;if("email"in e){const{email:h,password:u,options:f}=e;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await at(this.storage,this.storageKey)),a=await L(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f?.emailRedirectTo,body:{email:h,password:u,data:(r=f?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:p,code_challenge_method:g},xform:Re})}else if("phone"in e){const{phone:h,password:u,options:f}=e;a=await L(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:u,data:(s=f?.data)!==null&&s!==void 0?s:{},channel:(n=f?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:Re})}else throw new er("You must provide either an email or phone number and a password");const{data:i,error:l}=a;if(l||!i)return await ce(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(a){if(await ce(this.storage,`${this.storageKey}-code-verifier`),P(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(e){try{let r;if("email"in e){const{email:a,password:i,options:l}=e;r=await L(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Nn})}else if("phone"in e){const{phone:a,password:i,options:l}=e;r=await L(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Nn})}else throw new er("You must provide either an email or phone number and a password");const{data:s,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!s||!s.session||!s.user){const a=new nt;return this._returnResult({data:{user:null,session:null},error:a})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(P(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,s,n,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,s,n,a,i,l,c,d,h,u,f;let p,g;if("message"in e)p=e.message,g=e.signature;else{const{chain:m,wallet:b,statement:x,options:w}=e;let v;if(de())if(typeof b=="object")v=b;else{const T=window;if("ethereum"in T&&typeof T.ethereum=="object"&&"request"in T.ethereum&&typeof T.ethereum.request=="function")v=T.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!w?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=b}const _=new URL((r=w?.url)!==null&&r!==void 0?r:window.location.href),N=await v.request({method:"eth_requestAccounts"}).then(T=>T).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!N||N.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const y=Ua(N[0]);let k=(s=w?.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!k){const T=await v.request({method:"eth_chainId"});k=zc(T)}const C={domain:_.host,address:y,statement:x,uri:_.href,version:"1",chainId:k,nonce:(n=w?.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(i=(a=w?.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(l=w?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=w?.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=w?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(h=w?.signInWithEthereum)===null||h===void 0?void 0:h.resources};p=Kc(C),g=await v.request({method:"personal_sign",params:[Hc(p),y]})}try{const{data:m,error:b}=await L(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:g},!((u=e.options)===null||u===void 0)&&u.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Re});if(b)throw b;if(!m||!m.session||!m.user){const x=new nt;return this._returnResult({data:{user:null,session:null},error:x})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:b})}catch(m){if(P(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(e){var r,s,n,a,i,l,c,d,h,u,f,p;let g,m;if("message"in e)g=e.message,m=e.signature;else{const{chain:b,wallet:x,statement:w,options:v}=e;let _;if(de())if(typeof x=="object")_=x;else{const y=window;if("solana"in y&&typeof y.solana=="object"&&("signIn"in y.solana&&typeof y.solana.signIn=="function"||"signMessage"in y.solana&&typeof y.solana.signMessage=="function"))_=y.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!v?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=x}const N=new URL((r=v?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in _&&_.signIn){const y=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v?.signInWithSolana),{version:"1",domain:N.host,uri:N.href}),w?{statement:w}:null));let k;if(Array.isArray(y)&&y[0]&&typeof y[0]=="object")k=y[0];else if(y&&typeof y=="object"&&"signedMessage"in y&&"signature"in y)k=y;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)g=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),m=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${N.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${N.href}`,`Issued At: ${(n=(s=v?.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((a=v?.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((i=v?.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((l=v?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((c=v?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((d=v?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((u=(h=v?.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||u===void 0)&&u.length?["Resources",...v.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const y=await _.signMessage(new TextEncoder().encode(g),"utf8");if(!y||!(y instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=y}}try{const{data:b,error:x}=await L(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:Qe(m)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Re});if(x)throw x;if(!b||!b.session||!b.user){const w=new nt;return this._returnResult({data:{user:null,session:null},error:w})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:x})}catch(b){if(P(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async _exchangeCodeForSession(e){const r=await ze(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{if(!s&&this.flowType==="pkce")throw new pc;const{data:a,error:i}=await L(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Re});if(await ce(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!a||!a.session||!a.user){const l=new nt;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:n??null}),error:i})}catch(a){if(await ce(this.storage,`${this.storageKey}-code-verifier`),P(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(e){try{const{options:r,provider:s,token:n,access_token:a,nonce:i}=e,l=await L(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Re}),{data:c,error:d}=l;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const h=new nt;return this._returnResult({data:{user:null,session:null},error:h})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(r){if(P(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,s,n,a,i;try{if("email"in e){const{email:l,options:c}=e;let d=null,h=null;this.flowType==="pkce"&&([d,h]=await at(this.storage,this.storageKey));const{error:u}=await L(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c?.data)!==null&&r!==void 0?r:{},create_user:(s=c?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:d,code_challenge_method:h},redirectTo:c?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:u})}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:h}=await L(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c?.data)!==null&&n!==void 0?n:{},create_user:(a=c?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(i=c?.channel)!==null&&i!==void 0?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:h})}throw new er("You must provide either an email or phone number.")}catch(l){if(await ce(this.storage,`${this.storageKey}-code-verifier`),P(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var r,s;try{let n,a;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,a=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:i,error:l}=await L(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:Re});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,d=i.user;return c?.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(n){if(P(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var r,s,n,a,i;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await at(this.storage,this.storageKey));const d=await L(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:Uc});return!((a=d.data)===null||a===void 0)&&a.url&&de()&&!(!((i=e.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(l){if(await ce(this.storage,`${this.storageKey}-code-verifier`),P(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new be;const{error:n}=await L(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if(P(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:a}=e,{error:i}=await L(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}else if("phone"in e){const{phone:s,type:n,options:a}=e,{data:i,error:l}=await L(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:i?.message_id},error:l})}throw new er("You must provide either an email or phone number and a type")}catch(r){if(P(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await ze(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<Mr:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const i=await ze(this.userStorage,this.storageKey+"-user");i?.user?e.user=i.user:e.user=Gr()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};e.user=Dc(e.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(e){try{return e?await L(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Me}):await this._useSession(async r=>{var s,n,a;const{data:i,error:l}=r;if(l)throw l;return!(!((s=i.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new be}:await L(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0,xform:Me})})}catch(r){if(P(r))return hc(r)&&(await this._removeSession(),await ce(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async s=>{const{data:n,error:a}=s;if(a)throw a;if(!n.session)throw new be;const i=n.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await at(this.storage,this.storageKey));const{data:d,error:h}=await L(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:i.access_token,xform:Me});if(h)throw h;return i.user=d.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(s){if(await ce(this.storage,`${this.storageKey}-code-verifier`),P(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new be;const r=Date.now()/1e3;let s=r,n=!0,a=null;const{payload:i}=Wr(e.access_token);if(i.exp&&(s=i.exp,n=s<=r),n){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;a={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(r){if(P(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var s;if(!e){const{data:i,error:l}=r;if(l)throw l;e=(s=i.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new be;const{data:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(P(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!de())throw new tr("No browser detected.");if(e.error||e.error_description||e.error_code)throw new tr(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new xn("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new tr("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new xn("No code detected.");const{data:w,error:v}=await this._exchangeCodeForSession(e.code);if(v)throw v;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:a,refresh_token:i,expires_in:l,expires_at:c,token_type:d}=e;if(!a||!l||!i||!d)throw new tr("No session defined in URL");const h=Math.round(Date.now()/1e3),u=parseInt(l);let f=h+u;c&&(f=parseInt(c));const p=f-h;p*1e3<=dt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${u}s`);const g=f-u;h-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,f,h):h-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,f,h);const{data:m,error:b}=await this._getUser(a);if(b)throw b;const x={provider_token:s,provider_refresh_token:n,access_token:a,expires_in:u,expires_at:f,refresh_token:i,token_type:d,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:e.type},error:null})}catch(s){if(P(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await ze(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({error:a});const i=(s=n.session)===null||s===void 0?void 0:s.access_token;if(i){const{error:l}=await this.admin.signOut(i,e);if(l&&!(uc(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await ce(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=wc(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async r=>{var s,n;try{const{data:{session:a},error:i}=r;if(i)throw i;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await at(this.storage,this.storageKey,!0));try{return await L(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(await ce(this.storage,`${this.storageKey}-code-verifier`),P(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var e;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(P(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:s,error:n}=await this._useSession(async a=>{var i,l,c,d,h;const{data:u,error:f}=a;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await L(this.fetch,"GET",p,{headers:this.headers,jwt:(h=(d=u.session)===null||d===void 0?void 0:d.access_token)!==null&&h!==void 0?h:void 0})});if(n)throw n;return de()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s?.url),this._returnResult({data:{provider:e.provider,url:s?.url},error:null})}catch(s){if(P(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var s;try{const{error:n,data:{session:a}}=r;if(n)throw n;const{options:i,provider:l,token:c,access_token:d,nonce:h}=e,u=await L(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=a?.access_token)!==null&&s!==void 0?s:void 0,body:{provider:l,id_token:c,access_token:d,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:i?.captchaToken}},xform:Re}),{data:f,error:p}=u;return p?this._returnResult({data:{user:null,session:null},error:p}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new nt}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:p}))}catch(n){if(await ce(this.storage,`${this.storageKey}-code-verifier`),P(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var s,n;const{data:a,error:i}=r;if(i)throw i;return await L(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(P(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await Nc(async n=>(n>0&&await Sc(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await L(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Re})),(n,a)=>{const i=200*Math.pow(2,n);return a&&Fr(a)&&Date.now()+i-s<dt})}catch(s){if(this._debug(r,"error",s),P(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),de()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await ze(this.storage,this.storageKey);if(n&&this.userStorage){let i=await ze(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:n.user},await ut(this.userStorage,this.storageKey+"-user",i)),n.user=(e=i?.user)!==null&&e!==void 0?e:Gr()}else if(n&&!n.user&&!n.user){const i=await ze(this.storage,this.storageKey+"-user");i&&i?.user?(n.user=i.user,await ce(this.storage,this.storageKey+"-user"),await ut(this.storage,this.storageKey,n)):n.user=Gr()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const a=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Mr;if(this._debug(s,`session has${a?"":" not"} expired with margin of ${Mr}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),Fr(i)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(n.access_token);!l&&i?.user?(n.user=i.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(s,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var r,s;if(!e)throw new be;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Sr;const{data:a,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!a.session)throw new be;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={data:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(n,"error",a),P(a)){const i={data:null,error:a};return Fr(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,r)}catch(c){a.push(c)}});if(await Promise.all(i),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await ce(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},e),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await ut(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const a=kn(n);await ut(this.storage,this.storageKey,a)}else{const n=kn(r);await ut(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await ce(this.storage,this.storageKey),await ce(this.storage,this.storageKey+"-code-verifier"),await ce(this.storage,this.storageKey+"-user"),this.userStorage&&await ce(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&de()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),dt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/dt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${dt}ms, refresh threshold is ${us} ticks`),n<=us&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Ba)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!de()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,i]=await at(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(l.toString())}if(s?.queryParams){const a=new URLSearchParams(s.queryParams);n.push(a.toString())}return s?.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;return a?this._returnResult({data:null,error:a}):await L(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(P(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var s,n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:d}=await L(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=a?.session)===null||s===void 0?void 0:s.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&c.type==="totp"&&(!((n=c?.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(P(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({data:null,error:a});const i=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?td(e.webauthn.credential_response):rd(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await L(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:i,headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(P(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({data:null,error:a});const i=await L(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});if(i.error)return i;const{data:l}=i;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Zc(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:ed(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(P(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const n={all:[],phone:[],totp:[],webauthn:[]};for(const a of(e=r?.factors)!==null&&e!==void 0?e:[])n.all.push(a),a.status==="verified"&&n[a.factor_type].push(a);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:s},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Wr(s.access_token);let i=null;a.aal&&(i=a.aal);let l=i;((r=(e=s.user.factors)===null||e===void 0?void 0:e.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const d=a.amr||[];return{data:{currentLevel:i,nextLevel:l,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?await L(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new be})})}catch(r){if(P(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:n},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!n)return this._returnResult({data:null,error:new be});const i=await L(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&de()&&!r?.skipBrowserRedirect&&window.location.assign(i.data.redirect_url),i})}catch(s){if(P(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:n},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!n)return this._returnResult({data:null,error:new be});const i=await L(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&de()&&!r?.skipBrowserRedirect&&window.location.assign(i.data.redirect_url),i})}catch(s){if(P(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;return s?this._returnResult({data:null,error:s}):r?await L(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:n=>({data:n,error:null})}):this._returnResult({data:null,error:new be})})}catch(e){if(P(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?(await L(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new be})})}catch(r){if(P(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let s=r.keys.find(l=>l.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(l=>l.kid===e),s&&this.jwks_cached_at+cc>n)return s;const{data:a,error:i}=await L(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=n,s=a.keys.find(l=>l.kid===e),!s)?null:s}async getClaims(e,r={}){try{let s=e;if(!s){const{data:p,error:g}=await this.getSession();if(g||!p.session)return this._returnResult({data:null,error:g});s=p.session.access_token}const{header:n,payload:a,signature:i,raw:{header:l,payload:c}}=Wr(s);r?.allowExpired||Oc(a.exp);const d=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!d){const{error:p}=await this.getUser(s);if(p)throw p;return{data:{claims:a,header:n,signature:i},error:null}}const h=Tc(n.alg),u=await crypto.subtle.importKey("jwk",d,h,!0,["verify"]);if(!await crypto.subtle.verify(h,u,i,vc(`${l}.${c}`)))throw new ps("Invalid JWT signature");return{data:{claims:a,header:n,signature:i},error:null}}catch(s){if(P(s))return this._returnResult({data:null,error:s});throw s}}}Lt.nextInstanceID={};const ud=Lt,hd="2.89.0";let Ct="";typeof Deno<"u"?Ct="deno":typeof document<"u"?Ct="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ct="react-native":Ct="node";const fd={"X-Client-Info":`supabase-js-${Ct}/${hd}`},pd={headers:fd},gd={schema:"public"},md={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},bd={};function Bt(t){"@babel/helpers - typeof";return Bt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bt(t)}function xd(t,e){if(Bt(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,e);if(Bt(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vd(t){var e=xd(t,"string");return Bt(e)=="symbol"?e:e+""}function yd(t,e,r){return(e=vd(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function An(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,s)}return r}function re(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?An(Object(r),!0).forEach(function(s){yd(t,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):An(Object(r)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(r,s))})}return t}const wd=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),_d=()=>Headers,kd=(t,e,r)=>{const s=wd(r),n=_d();return async(a,i)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:t;let d=new n(i?.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),s(a,re(re({},i),{},{headers:d}))}};function Sd(t){return t.endsWith("/")?t:t+"/"}function Nd(t,e){var r,s;const{db:n,auth:a,realtime:i,global:l}=t,{db:c,auth:d,realtime:h,global:u}=e,f={db:re(re({},c),n),auth:re(re({},d),a),realtime:re(re({},h),i),storage:{},global:re(re(re({},u),l),{},{headers:re(re({},(r=u?.headers)!==null&&r!==void 0?r:{}),(s=l?.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function jd(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Sd(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Ed=class extends ud{constructor(t){super(t)}},Cd=class{constructor(t,e,r){var s,n;this.supabaseUrl=t,this.supabaseKey=e;const a=jd(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const i=`sb-${a.hostname.split(".")[0]}-auth-token`,l={db:gd,realtime:bd,auth:re(re({},md),{},{storageKey:i}),global:pd},c=Nd(r??{},l);if(this.storageKey=(s=c.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(n=c.global.headers)!==null&&n!==void 0?n:{},c.accessToken)this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(h,u)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(u)} is not possible`)}});else{var d;this.auth=this._initSupabaseAuthClient((d=c.auth)!==null&&d!==void 0?d:{},this.headers,c.global.fetch)}this.fetch=kd(e,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(re({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&this.accessToken().then(h=>this.realtime.setAuth(h)).catch(h=>console.warn("Failed to set initial Realtime auth token:",h)),this.rest=new ol(new URL("rest/v1",a).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new nc(this.storageUrl.href,this.headers,this.fetch,r?.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new rl(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,r;if(t.accessToken)return await t.accessToken();const{data:s}=await t.auth.getSession();return(e=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:s,userStorage:n,storageKey:a,flowType:i,lock:l,debug:c,throwOnError:d},h,u){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Ed({url:this.authUrl.href,headers:re(re({},f),h),storageKey:a,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:s,userStorage:n,flowType:i,lock:l,debug:c,throwOnError:d,fetch:u,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new Sl(this.realtimeUrl.href,re(re({},t),{},{params:re(re({},{apikey:this.supabaseKey}),t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e?.access_token)})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const Rd=(t,e,r)=>new Cd(t,e,r);function Ad(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}Ad()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Id="https://eghqfcosbbdmbgdscyqk.supabase.co",Od="sb_publishable_Q1XtCIuD63JA6aEYTRQW9w_rhQyXKTS",Se=Rd(Id,Od),Td=()=>{const[t,e]=S.useState(!1),[r,s]=S.useState(""),[n,a]=S.useState(""),[i,l]=S.useState(!0),c=async d=>{d.preventDefault(),e(!0);try{if(i){const{error:h}=await Se.auth.signInWithPassword({email:r,password:n});if(h)throw h}else{const{error:h}=await Se.auth.signUp({email:r,password:n});if(h)throw h;ue.success(" ()"),l(!0)}}catch(h){ue.error(h.message)}finally{e(!1)}};return o.jsxs("div",{className:"min-h-screen bg-[#09090b] bg-[radial-gradient(ellipse_80%_80%_at_50%_-20%,rgba(120,119,198,0.15),rgba(255,255,255,0))] flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[o.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md text-center",children:[o.jsxs("div",{className:"mx-auto w-16 h-16 bg-indigo-500/10 rounded-2xl flex items-center justify-center border border-indigo-500/20 mb-6 relative overflow-hidden group",children:[o.jsx("div",{className:"absolute inset-0 bg-indigo-500/20 blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),o.jsx(ka,{className:"w-8 h-8 text-indigo-400 relative z-10"})]}),o.jsx("h2",{className:"text-3xl font-bold tracking-tight text-white mb-2",children:i?" Propfirm ":""}),o.jsx("p",{className:"text-slate-400 text-sm",children:i?"":""})]}),o.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:o.jsxs("div",{className:"bg-white/[0.03] backdrop-blur-xl py-8 px-4 shadow-2xl rounded-2xl border border-white/[0.08] sm:px-10 relative overflow-hidden",children:[o.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-indigo-500/10 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none"}),o.jsxs("form",{className:"space-y-6 relative z-10",onSubmit:c,children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email",className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:"Email"}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Go,{className:"h-5 w-5 text-slate-500"})}),o.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:r,onChange:d=>s(d.target.value),className:"block w-full pl-10 bg-black/20 border border-white/[0.1] rounded-xl py-3 text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-transparent transition-all sm:text-sm",placeholder:"name@example.com"})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"password",className:"block text-xs font-medium text-slate-400 uppercase tracking-wider mb-2",children:""}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Uo,{className:"h-5 w-5 text-slate-500"})}),o.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:n,onChange:d=>a(d.target.value),className:"block w-full pl-10 bg-black/20 border border-white/[0.1] rounded-xl py-3 text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-transparent transition-all sm:text-sm",placeholder:""})]})]}),o.jsx("button",{type:"submit",disabled:t,className:"w-full flex justify-center py-3.5 px-4 border border-transparent rounded-xl shadow-lg shadow-indigo-600/20 text-sm font-bold text-white bg-indigo-600 hover:bg-indigo-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 focus:ring-offset-[#09090b] transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:t?o.jsx(wa,{className:"w-5 h-5 animate-spin"}):i?"":""})]}),o.jsxs("div",{className:"mt-6",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-0 flex items-center",children:o.jsx("div",{className:"w-full border-t border-white/[0.1]"})}),o.jsx("div",{className:"relative flex justify-center text-sm",children:o.jsx("span",{className:"px-2 bg-[#0d0d10] text-slate-500 uppercase text-xs tracking-wider",children:""})})]}),o.jsx("div",{className:"mt-6 flex justify-center",children:o.jsx("button",{type:"button",onClick:()=>{l(!i)},className:"text-sm font-medium text-indigo-400 hover:text-indigo-300 transition-colors flex items-center gap-1",children:i?o.jsxs(o.Fragment,{children:[" ",o.jsx("span",{className:"underline decoration-indigo-500/30 underline-offset-4",children:""})]}):o.jsxs(o.Fragment,{children:[" ",o.jsx("span",{className:"underline decoration-indigo-500/30 underline-offset-4",children:""})]})})})]})]})})]})},Pd=({isOpen:t,onClose:e,session:r})=>{const[s,n]=S.useState(""),[a,i]=S.useState(!1),[l,c]=S.useState(null),[d,h]=S.useState(null);if(!t)return null;const u=async p=>{p.preventDefault(),i(!0),c(null),h(null);try{const{error:g}=await Se.auth.updateUser({password:s});if(g)throw g;c(""),n("")}catch(g){h(g.message)}finally{i(!1)}},f=async()=>{try{const{error:p}=await Se.auth.signOut();if(p)throw p;e()}catch(p){console.error("Logout error:",p),h("")}};return o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[o.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),o.jsxs("div",{className:"relative w-full max-w-md bg-white dark:bg-[#0e0e11] border border-slate-200 dark:border-white/[0.08] rounded-2xl shadow-2xl overflow-hidden animate-in fade-in zoom-in-95 duration-200",children:[o.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-100 dark:border-white/[0.06] bg-slate-50/50 dark:bg-white/[0.02]",children:[o.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[o.jsx(_a,{className:"w-5 h-5 text-indigo-500"}),""]}),o.jsx("button",{onClick:e,className:"text-slate-400 hover:text-slate-900 dark:hover:text-white transition-colors",children:o.jsx(lr,{className:"w-5 h-5"})})]}),o.jsxs("div",{className:"p-6 space-y-8",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase",children:""}),o.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-100 dark:bg-white/[0.03] rounded-xl border border-slate-200 dark:border-white/[0.05]",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-indigo-500/10 flex items-center justify-center text-indigo-500",children:r?.user?.email?.charAt(0).toUpperCase()}),o.jsxs("div",{className:"flex-1 overflow-hidden",children:[o.jsx("div",{className:"text-sm font-medium text-slate-900 dark:text-white truncate",children:r?.user?.email}),o.jsx("div",{className:"text-xs text-slate-500 dark:text-slate-400",children:""})]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("label",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase flex items-center gap-2",children:[o.jsx(Po,{className:"w-3.5 h-3.5"})," "]}),o.jsxs("form",{onSubmit:u,className:"space-y-3",children:[o.jsx("input",{type:"password",value:s,onChange:p=>n(p.target.value),placeholder:"",className:"w-full bg-slate-50 dark:bg-black/20 border border-slate-200 dark:border-white/[0.1] rounded-xl px-4 py-2.5 text-sm text-slate-900 dark:text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-transparent transition-all",minLength:6,required:!0}),(l||d)&&o.jsxs("div",{className:`text-xs flex items-center gap-1.5 ${d?"text-rose-500":"text-emerald-500"}`,children:[d?o.jsx(_o,{className:"w-3.5 h-3.5"}):o.jsx(ho,{className:"w-3.5 h-3.5"}),l||d]}),o.jsx("button",{type:"submit",disabled:a||!s,className:"w-full py-2.5 rounded-xl bg-indigo-600 hover:bg-indigo-500 text-white text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:a?o.jsx(wa,{className:"w-4 h-4 animate-spin"}):""})]})]}),o.jsx("div",{className:"pt-4 border-t border-slate-100 dark:border-white/[0.06]",children:o.jsxs("button",{onClick:f,className:"w-full py-3 rounded-xl border border-slate-200 dark:border-white/[0.1] hover:bg-rose-50 dark:hover:bg-rose-500/10 text-slate-600 dark:text-slate-300 hover:text-rose-600 dark:hover:text-rose-400 hover:border-rose-200 dark:hover:border-rose-500/20 transition-all text-sm font-medium flex items-center justify-center gap-2",children:[o.jsx(Fo,{className:"w-4 h-4"}),""]})})]})]})]})};function pe(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var Dd=typeof Symbol=="function"&&Symbol.observable||"@@observable",In=Dd,On=()=>Math.random().toString(36).substring(7).split("").join("."),$d={INIT:`@@redux/INIT${On()}`,REPLACE:`@@redux/REPLACE${On()}`},Tn=$d;function Ld(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function Fa(t,e,r){if(typeof t!="function")throw new Error(pe(2));if(typeof e=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(pe(0));if(typeof e=="function"&&typeof r>"u"&&(r=e,e=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(pe(1));return r(Fa)(t,e)}let s=t,n=e,a=new Map,i=a,l=0,c=!1;function d(){i===a&&(i=new Map,a.forEach((b,x)=>{i.set(x,b)}))}function h(){if(c)throw new Error(pe(3));return n}function u(b){if(typeof b!="function")throw new Error(pe(4));if(c)throw new Error(pe(5));let x=!0;d();const w=l++;return i.set(w,b),function(){if(x){if(c)throw new Error(pe(6));x=!1,d(),i.delete(w),a=null}}}function f(b){if(!Ld(b))throw new Error(pe(7));if(typeof b.type>"u")throw new Error(pe(8));if(typeof b.type!="string")throw new Error(pe(17));if(c)throw new Error(pe(9));try{c=!0,n=s(n,b)}finally{c=!1}return(a=i).forEach(w=>{w()}),b}function p(b){if(typeof b!="function")throw new Error(pe(10));s=b,f({type:Tn.REPLACE})}function g(){const b=u;return{subscribe(x){if(typeof x!="object"||x===null)throw new Error(pe(11));function w(){const _=x;_.next&&_.next(h())}return w(),{unsubscribe:b(w)}},[In](){return this}}}return f({type:Tn.INIT}),{dispatch:f,subscribe:u,getState:h,replaceReducer:p,[In]:g}}function Pn(t,e){return function(...r){return e(t.apply(this,r))}}function Dn(t,e){if(typeof t=="function")return Pn(t,e);if(typeof t!="object"||t===null)throw new Error(pe(16));const r={};for(const s in t){const n=t[s];typeof n=="function"&&(r[s]=Pn(n,e))}return r}function Wa(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,r)=>(...s)=>e(r(...s)))}function Bd(...t){return e=>(r,s)=>{const n=e(r,s);let a=()=>{throw new Error(pe(15))};const i={getState:n.getState,dispatch:(c,...d)=>a(c,...d)},l=t.map(c=>c(i));return a=Wa(...l)(n.dispatch),{...n,dispatch:a}}}var Vr={exports:{}},zr={};var $n;function Ud(){if($n)return zr;$n=1;var t=io();function e(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var r=typeof Object.is=="function"?Object.is:e,s=t.useSyncExternalStore,n=t.useRef,a=t.useEffect,i=t.useMemo,l=t.useDebugValue;return zr.useSyncExternalStoreWithSelector=function(c,d,h,u,f){var p=n(null);if(p.current===null){var g={hasValue:!1,value:null};p.current=g}else g=p.current;p=i(function(){function b(N){if(!x){if(x=!0,w=N,N=u(N),f!==void 0&&g.hasValue){var y=g.value;if(f(y,N))return v=y}return v=N}if(y=v,r(w,N))return y;var k=u(N);return f!==void 0&&f(y,k)?(w=N,y):(w=N,v=k)}var x=!1,w,v,_=h===void 0?null:h;return[function(){return b(d())},_===null?void 0:function(){return b(_())}]},[d,h,u,f]);var m=s(c,p[0],p[1]);return a(function(){g.hasValue=!0,g.value=m},[m]),l(m),m},zr}var Ln;function Md(){return Ln||(Ln=1,Vr.exports=Ud()),Vr.exports}Md();var Fd=S.version.startsWith("19"),Wd=Symbol.for(Fd?"react.transitional.element":"react.element"),Gd=Symbol.for("react.portal"),qd=Symbol.for("react.fragment"),Vd=Symbol.for("react.strict_mode"),zd=Symbol.for("react.profiler"),Hd=Symbol.for("react.consumer"),Kd=Symbol.for("react.context"),Ga=Symbol.for("react.forward_ref"),Jd=Symbol.for("react.suspense"),Yd=Symbol.for("react.suspense_list"),As=Symbol.for("react.memo"),Xd=Symbol.for("react.lazy"),Qd=Ga,Zd=As;function eu(t){if(typeof t=="object"&&t!==null){const{$$typeof:e}=t;switch(e){case Wd:switch(t=t.type,t){case qd:case zd:case Vd:case Jd:case Yd:return t;default:switch(t=t&&t.$$typeof,t){case Kd:case Ga:case Xd:case As:return t;case Hd:return t;default:return e}}case Gd:return e}}}function tu(t){return eu(t)===As}function ru(t,e,r,s,{areStatesEqual:n,areOwnPropsEqual:a,areStatePropsEqual:i}){let l=!1,c,d,h,u,f;function p(w,v){return c=w,d=v,h=t(c,d),u=e(s,d),f=r(h,u,d),l=!0,f}function g(){return h=t(c,d),e.dependsOnOwnProps&&(u=e(s,d)),f=r(h,u,d),f}function m(){return t.dependsOnOwnProps&&(h=t(c,d)),e.dependsOnOwnProps&&(u=e(s,d)),f=r(h,u,d),f}function b(){const w=t(c,d),v=!i(w,h);return h=w,v&&(f=r(h,u,d)),f}function x(w,v){const _=!a(v,d),N=!n(w,c,v,d);return c=w,d=v,_&&N?g():_?m():N?b():f}return function(v,_){return l?x(v,_):p(v,_)}}function su(t,{initMapStateToProps:e,initMapDispatchToProps:r,initMergeProps:s,...n}){const a=e(t,n),i=r(t,n),l=s(t,n);return ru(a,i,l,t,n)}function nu(t,e){const r={};for(const s in t){const n=t[s];typeof n=="function"&&(r[s]=(...a)=>e(n(...a)))}return r}function gs(t){return function(r){const s=t(r);function n(){return s}return n.dependsOnOwnProps=!1,n}}function Bn(t){return t.dependsOnOwnProps?!!t.dependsOnOwnProps:t.length!==1}function qa(t,e){return function(s,{displayName:n}){const a=function(l,c){return a.dependsOnOwnProps?a.mapToProps(l,c):a.mapToProps(l,void 0)};return a.dependsOnOwnProps=!0,a.mapToProps=function(l,c){a.mapToProps=t,a.dependsOnOwnProps=Bn(t);let d=a(l,c);return typeof d=="function"&&(a.mapToProps=d,a.dependsOnOwnProps=Bn(d),d=a(l,c)),d},a}}function Is(t,e){return(r,s)=>{throw new Error(`Invalid value of type ${typeof t} for ${e} argument when connecting component ${s.wrappedComponentName}.`)}}function au(t){return t&&typeof t=="object"?gs(e=>nu(t,e)):t?typeof t=="function"?qa(t):Is(t,"mapDispatchToProps"):gs(e=>({dispatch:e}))}function iu(t){return t?typeof t=="function"?qa(t):Is(t,"mapStateToProps"):gs(()=>({}))}function ou(t,e,r){return{...r,...t,...e}}function lu(t){return function(r,{displayName:s,areMergedPropsEqual:n}){let a=!1,i;return function(c,d,h){const u=t(c,d,h);return a?n(u,i)||(i=u):(a=!0,i=u),i}}}function cu(t){return t?typeof t=="function"?lu(t):Is(t,"mergeProps"):()=>ou}function du(t){t()}function uu(){let t=null,e=null;return{clear(){t=null,e=null},notify(){du(()=>{let r=t;for(;r;)r.callback(),r=r.next})},get(){const r=[];let s=t;for(;s;)r.push(s),s=s.next;return r},subscribe(r){let s=!0;const n=e={callback:r,next:null,prev:e};return n.prev?n.prev.next=n:t=n,function(){!s||t===null||(s=!1,n.next?n.next.prev=n.prev:e=n.prev,n.prev?n.prev.next=n.next:t=n.next)}}}}var Un={notify(){},get:()=>[]};function Va(t,e){let r,s=Un,n=0,a=!1;function i(m){h();const b=s.subscribe(m);let x=!1;return()=>{x||(x=!0,b(),u())}}function l(){s.notify()}function c(){g.onStateChange&&g.onStateChange()}function d(){return a}function h(){n++,r||(r=e?e.addNestedSub(c):t.subscribe(c),s=uu())}function u(){n--,r&&n===0&&(r(),r=void 0,s.clear(),s=Un)}function f(){a||(a=!0,h())}function p(){a&&(a=!1,u())}const g={addNestedSub:i,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:d,trySubscribe:f,tryUnsubscribe:p,getListeners:()=>s};return g}var hu=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",fu=hu(),pu=()=>typeof navigator<"u"&&navigator.product==="ReactNative",gu=pu(),mu=()=>fu||gu?S.useLayoutEffect:S.useEffect,hr=mu();function Mn(t,e){return t===e?t!==0||e!==0||1/t===1/e:t!==t&&e!==e}function Hr(t,e){if(Mn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;const r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(let n=0;n<r.length;n++)if(!Object.prototype.hasOwnProperty.call(e,r[n])||!Mn(t[r[n]],e[r[n]]))return!1;return!0}var bu={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},xu={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},vu={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},za={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},yu={[Qd]:vu,[Zd]:za};function Fn(t){return tu(t)?za:yu[t.$$typeof]||bu}var wu=Object.defineProperty,_u=Object.getOwnPropertyNames,Wn=Object.getOwnPropertySymbols,ku=Object.getOwnPropertyDescriptor,Su=Object.getPrototypeOf,Gn=Object.prototype;function ms(t,e){if(typeof e!="string"){if(Gn){const a=Su(e);a&&a!==Gn&&ms(t,a)}let r=_u(e);Wn&&(r=r.concat(Wn(e)));const s=Fn(t),n=Fn(e);for(let a=0;a<r.length;++a){const i=r[a];if(!xu[i]&&!(n&&n[i])&&!(s&&s[i])){const l=ku(e,i);try{wu(t,i,l)}catch{}}}}return t}var Nu=Symbol.for("react-redux-context"),ju=typeof globalThis<"u"?globalThis:{};function Eu(){if(!S.createContext)return{};const t=ju[Nu]??=new Map;let e=t.get(S.createContext);return e||(e=S.createContext(null),t.set(S.createContext,e)),e}var Ha=Eu(),Cu=[null,null];function Ru(t,e,r){hr(()=>t(...e),r)}function Au(t,e,r,s,n,a){t.current=s,r.current=!1,n.current&&(n.current=null,a())}function Iu(t,e,r,s,n,a,i,l,c,d,h){if(!t)return()=>{};let u=!1,f=null;const p=()=>{if(u||!l.current)return;const m=e.getState();let b,x;try{b=s(m,n.current)}catch(w){x=w,f=w}x||(f=null),b===a.current?i.current||d():(a.current=b,c.current=b,i.current=!0,h())};return r.onStateChange=p,r.trySubscribe(),p(),()=>{if(u=!0,r.tryUnsubscribe(),r.onStateChange=null,f)throw f}}function Ou(t,e){return t===e}function Tu(t,e,r,{pure:s,areStatesEqual:n=Ou,areOwnPropsEqual:a=Hr,areStatePropsEqual:i=Hr,areMergedPropsEqual:l=Hr,forwardRef:c=!1,context:d=Ha}={}){const h=d,u=iu(t),f=au(e),p=cu(r),g=!!t;return b=>{const x=b.displayName||b.name||"Component",w=`Connect(${x})`,v={shouldHandleStateChanges:g,displayName:w,wrappedComponentName:x,WrappedComponent:b,initMapStateToProps:u,initMapDispatchToProps:f,initMergeProps:p,areStatesEqual:n,areStatePropsEqual:i,areOwnPropsEqual:a,areMergedPropsEqual:l};function _(k){const[C,T,j]=S.useMemo(()=>{const{reactReduxForwardedRef:ge,...qe}=k;return[k.context,ge,qe]},[k]),O=S.useMemo(()=>{let ge=h;return C?.Consumer,ge},[C,h]),A=S.useContext(O),I=!!k.store&&!!k.store.getState&&!!k.store.dispatch,X=!!A&&!!A.store,M=I?k.store:A.store,U=X?A.getServerState:M.getState,Ee=S.useMemo(()=>su(M.dispatch,v),[M]),[F,Te]=S.useMemo(()=>{if(!g)return Cu;const ge=Va(M,I?void 0:A.subscription),qe=ge.notifyNestedSubs.bind(ge);return[ge,qe]},[M,I,A]),me=S.useMemo(()=>I?A:{...A,subscription:F},[I,A,F]),wt=S.useRef(void 0),De=S.useRef(j),se=S.useRef(void 0),Jt=S.useRef(!1),Ce=S.useRef(!1),tt=S.useRef(void 0);hr(()=>(Ce.current=!0,()=>{Ce.current=!1}),[]);const Yt=S.useMemo(()=>()=>se.current&&j===De.current?se.current:Ee(M.getState(),j),[M,j]),Dr=S.useMemo(()=>qe=>F?Iu(g,M,F,Ee,De,wt,Jt,Ce,se,Te,qe):()=>{},[F]);Ru(Au,[De,wt,Jt,j,se,Te]);let rt;try{rt=S.useSyncExternalStore(Dr,Yt,U?()=>Ee(U(),j):Yt)}catch(ge){throw tt.current&&(ge.message+=`
The error may be correlated with this previous error:
${tt.current.stack}

`),ge}hr(()=>{tt.current=void 0,se.current=void 0,wt.current=rt});const Pe=S.useMemo(()=>S.createElement(b,{...rt,ref:T}),[T,b,rt]);return S.useMemo(()=>g?S.createElement(O.Provider,{value:me},Pe):Pe,[O,Pe,me])}const y=S.memo(_);if(y.WrappedComponent=b,y.displayName=_.displayName=w,c){const C=S.forwardRef(function(j,O){return S.createElement(y,{...j,reactReduxForwardedRef:O})});return C.displayName=w,C.WrappedComponent=b,ms(C,b)}return ms(y,b)}}var Ka=Tu;function Pu(t){const{children:e,context:r,serverState:s,store:n}=t,a=S.useMemo(()=>{const c=Va(n);return{store:n,subscription:c,getServerState:s?()=>s:void 0}},[n,s]),i=S.useMemo(()=>n.getState(),[n]);hr(()=>{const{subscription:c}=a;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),i!==n.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[a,i]);const l=r||Ha;return S.createElement(l.Provider,{value:a},e)}var Du=Pu,$u="Invariant failed";function Lu(t,e){throw new Error($u)}var Oe=function(e){var r=e.top,s=e.right,n=e.bottom,a=e.left,i=s-a,l=n-r,c={top:r,right:s,bottom:n,left:a,width:i,height:l,x:a,y:r,center:{x:(s+a)/2,y:(n+r)/2}};return c},Os=function(e,r){return{top:e.top-r.top,left:e.left-r.left,bottom:e.bottom+r.bottom,right:e.right+r.right}},qn=function(e,r){return{top:e.top+r.top,left:e.left+r.left,bottom:e.bottom-r.bottom,right:e.right-r.right}},Bu=function(e,r){return{top:e.top+r.y,left:e.left+r.x,bottom:e.bottom+r.y,right:e.right+r.x}},Kr={top:0,right:0,bottom:0,left:0},Ts=function(e){var r=e.borderBox,s=e.margin,n=s===void 0?Kr:s,a=e.border,i=a===void 0?Kr:a,l=e.padding,c=l===void 0?Kr:l,d=Oe(Os(r,n)),h=Oe(qn(r,i)),u=Oe(qn(h,c));return{marginBox:d,borderBox:Oe(r),paddingBox:h,contentBox:u,margin:n,border:i,padding:c}},ke=function(e){var r=e.slice(0,-2),s=e.slice(-2);if(s!=="px")return 0;var n=Number(r);return isNaN(n)&&Lu(),n},Uu=function(){return{x:window.pageXOffset,y:window.pageYOffset}},fr=function(e,r){var s=e.borderBox,n=e.border,a=e.margin,i=e.padding,l=Bu(s,r);return Ts({borderBox:l,border:n,margin:a,padding:i})},pr=function(e,r){return r===void 0&&(r=Uu()),fr(e,r)},Ja=function(e,r){var s={top:ke(r.marginTop),right:ke(r.marginRight),bottom:ke(r.marginBottom),left:ke(r.marginLeft)},n={top:ke(r.paddingTop),right:ke(r.paddingRight),bottom:ke(r.paddingBottom),left:ke(r.paddingLeft)},a={top:ke(r.borderTopWidth),right:ke(r.borderRightWidth),bottom:ke(r.borderBottomWidth),left:ke(r.borderLeftWidth)};return Ts({borderBox:e,margin:s,padding:n,border:a})},Ya=function(e){var r=e.getBoundingClientRect(),s=window.getComputedStyle(e);return Ja(r,s)},Ut=function(e){var r=[],s=null,n=function(){for(var i=arguments.length,l=new Array(i),c=0;c<i;c++)l[c]=arguments[c];r=l,!s&&(s=requestAnimationFrame(function(){s=null,e.apply(void 0,r)}))};return n.cancel=function(){s&&(cancelAnimationFrame(s),s=null)},n};function gr(){return gr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},gr.apply(null,arguments)}function Xa(t,e){}Xa.bind(null,"warn");Xa.bind(null,"error");function Fe(){}function Mu(t,e){return{...t,...e}}function Ne(t,e,r){const s=e.map(n=>{const a=Mu(r,n.options);return t.addEventListener(n.eventName,n.fn,a),function(){t.removeEventListener(n.eventName,n.fn,a)}});return function(){s.forEach(a=>{a()})}}const Fu="Invariant failed";class mr extends Error{}mr.prototype.toString=function(){return this.message};function R(t,e){throw new mr(Fu)}class Wu extends te.Component{constructor(...e){super(...e),this.callbacks=null,this.unbind=Fe,this.onWindowError=r=>{const s=this.getCallbacks();s.isDragging()&&s.tryAbort(),r.error instanceof mr&&r.preventDefault()},this.getCallbacks=()=>{if(!this.callbacks)throw new Error("Unable to find AppCallbacks in <ErrorBoundary/>");return this.callbacks},this.setCallbacks=r=>{this.callbacks=r}}componentDidMount(){this.unbind=Ne(window,[{eventName:"error",fn:this.onWindowError}])}componentDidCatch(e){if(e instanceof mr){this.setState({});return}throw e}componentWillUnmount(){this.unbind()}render(){return this.props.children(this.setCallbacks)}}const Gu=`
  Press space bar to start a drag.
  When dragging you can use the arrow keys to move the item around and escape to cancel.
  Some screen readers may require you to be in focus mode or to use your pass through key
`,br=t=>t+1,qu=t=>`
  You have lifted an item in position ${br(t.source.index)}
`,Qa=(t,e)=>{const r=t.droppableId===e.droppableId,s=br(t.index),n=br(e.index);return r?`
      You have moved the item from position ${s}
      to position ${n}
    `:`
    You have moved the item from position ${s}
    in list ${t.droppableId}
    to list ${e.droppableId}
    in position ${n}
  `},Za=(t,e,r)=>e.droppableId===r.droppableId?`
      The item ${t}
      has been combined with ${r.draggableId}`:`
      The item ${t}
      in list ${e.droppableId}
      has been combined with ${r.draggableId}
      in list ${r.droppableId}
    `,Vu=t=>{const e=t.destination;if(e)return Qa(t.source,e);const r=t.combine;return r?Za(t.draggableId,t.source,r):"You are over an area that cannot be dropped on"},Vn=t=>`
  The item has returned to its starting position
  of ${br(t.index)}
`,zu=t=>{if(t.reason==="CANCEL")return`
      Movement cancelled.
      ${Vn(t.source)}
    `;const e=t.destination,r=t.combine;return e?`
      You have dropped the item.
      ${Qa(t.source,e)}
    `:r?`
      You have dropped the item.
      ${Za(t.draggableId,t.source,r)}
    `:`
    The item has been dropped while not over a drop area.
    ${Vn(t.source)}
  `},or={dragHandleUsageInstructions:Gu,onDragStart:qu,onDragUpdate:Vu,onDragEnd:zu};function Hu(t,e){return!!(t===e||Number.isNaN(t)&&Number.isNaN(e))}function ei(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Hu(t[r],e[r]))return!1;return!0}function q(t,e){const r=S.useState(()=>({inputs:e,result:t()}))[0],s=S.useRef(!0),n=S.useRef(r),i=s.current||!!(e&&n.current.inputs&&ei(e,n.current.inputs))?n.current:{inputs:e,result:t()};return S.useEffect(()=>{s.current=!1,n.current=i},[i]),i.result}function D(t,e){return q(()=>t,e)}const le={x:0,y:0},he=(t,e)=>({x:t.x+e.x,y:t.y+e.y}),ye=(t,e)=>({x:t.x-e.x,y:t.y-e.y}),We=(t,e)=>t.x===e.x&&t.y===e.y,xt=t=>({x:t.x!==0?-t.x:0,y:t.y!==0?-t.y:0}),et=(t,e,r=0)=>t==="x"?{x:e,y:r}:{x:r,y:e},Mt=(t,e)=>Math.sqrt((e.x-t.x)**2+(e.y-t.y)**2),zn=(t,e)=>Math.min(...e.map(r=>Mt(t,r))),ti=t=>e=>({x:t(e.x),y:t(e.y)});var Ku=(t,e)=>{const r=Oe({top:Math.max(e.top,t.top),right:Math.min(e.right,t.right),bottom:Math.min(e.bottom,t.bottom),left:Math.max(e.left,t.left)});return r.width<=0||r.height<=0?null:r};const Ht=(t,e)=>({top:t.top+e.y,left:t.left+e.x,bottom:t.bottom+e.y,right:t.right+e.x}),Hn=t=>[{x:t.left,y:t.top},{x:t.right,y:t.top},{x:t.left,y:t.bottom},{x:t.right,y:t.bottom}],Ju={top:0,right:0,bottom:0,left:0},Yu=(t,e)=>e?Ht(t,e.scroll.diff.displacement):t,Xu=(t,e,r)=>r&&r.increasedBy?{...t,[e.end]:t[e.end]+r.increasedBy[e.line]}:t,Qu=(t,e)=>e&&e.shouldClipSubject?Ku(e.pageMarginBox,t):Oe(t);var gt=({page:t,withPlaceholder:e,axis:r,frame:s})=>{const n=Yu(t.marginBox,s),a=Xu(n,r,e),i=Qu(a,s);return{page:t,withPlaceholder:e,active:i}},Ps=(t,e)=>{t.frame||R();const r=t.frame,s=ye(e,r.scroll.initial),n=xt(s),a={...r,scroll:{initial:r.scroll.initial,current:e,diff:{value:s,displacement:n},max:r.scroll.max}},i=gt({page:t.subject.page,withPlaceholder:t.subject.withPlaceholder,axis:t.axis,frame:a});return{...t,frame:a,subject:i}};function oe(t,e=ei){let r=null;function s(...n){if(r&&r.lastThis===this&&e(n,r.lastArgs))return r.lastResult;const a=t.apply(this,n);return r={lastResult:a,lastArgs:n,lastThis:this},a}return s.clear=function(){r=null},s}const ri=oe(t=>t.reduce((e,r)=>(e[r.descriptor.id]=r,e),{})),si=oe(t=>t.reduce((e,r)=>(e[r.descriptor.id]=r,e),{})),Nr=oe(t=>Object.values(t)),Zu=oe(t=>Object.values(t));var vt=oe((t,e)=>Zu(e).filter(s=>t===s.descriptor.droppableId).sort((s,n)=>s.descriptor.index-n.descriptor.index));function Ds(t){return t.at&&t.at.type==="REORDER"?t.at.destination:null}function jr(t){return t.at&&t.at.type==="COMBINE"?t.at.combine:null}var Er=oe((t,e)=>e.filter(r=>r.descriptor.id!==t.descriptor.id)),eh=({isMovingForward:t,draggable:e,destination:r,insideDestination:s,previousImpact:n})=>{if(!r.isCombineEnabled||!Ds(n))return null;function i(p){const g={type:"COMBINE",combine:{draggableId:p,droppableId:r.descriptor.id}};return{...n,at:g}}const l=n.displaced.all,c=l.length?l[0]:null;if(t)return c?i(c):null;const d=Er(e,s);if(!c){if(!d.length)return null;const p=d[d.length-1];return i(p.descriptor.id)}const h=d.findIndex(p=>p.descriptor.id===c);h===-1&&R();const u=h-1;if(u<0)return null;const f=d[u];return i(f.descriptor.id)},yt=(t,e)=>t.descriptor.droppableId===e.descriptor.id;const ni={point:le,value:0},Ft={invisible:{},visible:{},all:[]},th={displaced:Ft,displacedBy:ni,at:null};var je=(t,e)=>r=>t<=r&&r<=e,ai=t=>{const e=je(t.top,t.bottom),r=je(t.left,t.right);return s=>{if(e(s.top)&&e(s.bottom)&&r(s.left)&&r(s.right))return!0;const a=e(s.top)||e(s.bottom),i=r(s.left)||r(s.right);if(a&&i)return!0;const c=s.top<t.top&&s.bottom>t.bottom,d=s.left<t.left&&s.right>t.right;return c&&d?!0:c&&i||d&&a}},rh=t=>{const e=je(t.top,t.bottom),r=je(t.left,t.right);return s=>e(s.top)&&e(s.bottom)&&r(s.left)&&r(s.right)};const $s={direction:"vertical",line:"y",crossAxisLine:"x",start:"top",end:"bottom",size:"height",crossAxisStart:"left",crossAxisEnd:"right",crossAxisSize:"width"},ii={direction:"horizontal",line:"x",crossAxisLine:"y",start:"left",end:"right",size:"width",crossAxisStart:"top",crossAxisEnd:"bottom",crossAxisSize:"height"};var sh=t=>e=>{const r=je(e.top,e.bottom),s=je(e.left,e.right);return n=>t===$s?r(n.top)&&r(n.bottom):s(n.left)&&s(n.right)};const nh=(t,e)=>{const r=e.frame?e.frame.scroll.diff.displacement:le;return Ht(t,r)},ah=(t,e,r)=>e.subject.active?r(e.subject.active)(t):!1,ih=(t,e,r)=>r(e)(t),Ls=({target:t,destination:e,viewport:r,withDroppableDisplacement:s,isVisibleThroughFrameFn:n})=>{const a=s?nh(t,e):t;return ah(a,e,n)&&ih(a,r,n)},oh=t=>Ls({...t,isVisibleThroughFrameFn:ai}),oi=t=>Ls({...t,isVisibleThroughFrameFn:rh}),lh=t=>Ls({...t,isVisibleThroughFrameFn:sh(t.destination.axis)}),ch=(t,e,r)=>{if(typeof r=="boolean")return r;if(!e)return!0;const{invisible:s,visible:n}=e;if(s[t])return!1;const a=n[t];return a?a.shouldAnimate:!0};function dh(t,e){const r=t.page.marginBox,s={top:e.point.y,right:0,bottom:0,left:e.point.x};return Oe(Os(r,s))}function Wt({afterDragging:t,destination:e,displacedBy:r,viewport:s,forceShouldAnimate:n,last:a}){return t.reduce(function(l,c){const d=dh(c,r),h=c.descriptor.id;if(l.all.push(h),!oh({target:d,destination:e,viewport:s,withDroppableDisplacement:!0}))return l.invisible[c.descriptor.id]=!0,l;const f=ch(h,a,n),p={draggableId:h,shouldAnimate:f};return l.visible[h]=p,l},{all:[],visible:{},invisible:{}})}function uh(t,e){if(!t.length)return 0;const r=t[t.length-1].descriptor.index;return e.inHomeList?r:r+1}function Kn({insideDestination:t,inHomeList:e,displacedBy:r,destination:s}){const n=uh(t,{inHomeList:e});return{displaced:Ft,displacedBy:r,at:{type:"REORDER",destination:{droppableId:s.descriptor.id,index:n}}}}function xr({draggable:t,insideDestination:e,destination:r,viewport:s,displacedBy:n,last:a,index:i,forceShouldAnimate:l}){const c=yt(t,r);if(i==null)return Kn({insideDestination:e,inHomeList:c,displacedBy:n,destination:r});const d=e.find(g=>g.descriptor.index===i);if(!d)return Kn({insideDestination:e,inHomeList:c,displacedBy:n,destination:r});const h=Er(t,e),u=e.indexOf(d),f=h.slice(u);return{displaced:Wt({afterDragging:f,destination:r,displacedBy:n,last:a,viewport:s.frame,forceShouldAnimate:l}),displacedBy:n,at:{type:"REORDER",destination:{droppableId:r.descriptor.id,index:i}}}}function Ge(t,e){return!!e.effected[t]}var hh=({isMovingForward:t,destination:e,draggables:r,combine:s,afterCritical:n})=>{if(!e.isCombineEnabled)return null;const a=s.draggableId,l=r[a].descriptor.index;return Ge(a,n)?t?l:l-1:t?l+1:l},fh=({isMovingForward:t,isInHomeList:e,insideDestination:r,location:s})=>{if(!r.length)return null;const n=s.index,a=t?n+1:n-1,i=r[0].descriptor.index,l=r[r.length-1].descriptor.index,c=e?l:l+1;return a<i||a>c?null:a},ph=({isMovingForward:t,isInHomeList:e,draggable:r,draggables:s,destination:n,insideDestination:a,previousImpact:i,viewport:l,afterCritical:c})=>{const d=i.at;if(d||R(),d.type==="REORDER"){const u=fh({isMovingForward:t,isInHomeList:e,location:d.destination,insideDestination:a});return u==null?null:xr({draggable:r,insideDestination:a,destination:n,viewport:l,last:i.displaced,displacedBy:i.displacedBy,index:u})}const h=hh({isMovingForward:t,destination:n,displaced:i.displaced,draggables:s,combine:d.combine,afterCritical:c});return h==null?null:xr({draggable:r,insideDestination:a,destination:n,viewport:l,last:i.displaced,displacedBy:i.displacedBy,index:h})},gh=({displaced:t,afterCritical:e,combineWith:r,displacedBy:s})=>{const n=!!(t.visible[r]||t.invisible[r]);return Ge(r,e)?n?le:xt(s.point):n?s.point:le},mh=({afterCritical:t,impact:e,draggables:r})=>{const s=jr(e);s||R();const n=s.draggableId,a=r[n].page.borderBox.center,i=gh({displaced:e.displaced,afterCritical:t,combineWith:n,displacedBy:e.displacedBy});return he(a,i)};const li=(t,e)=>e.margin[t.start]+e.borderBox[t.size]/2,bh=(t,e)=>e.margin[t.end]+e.borderBox[t.size]/2,Bs=(t,e,r)=>e[t.crossAxisStart]+r.margin[t.crossAxisStart]+r.borderBox[t.crossAxisSize]/2,Jn=({axis:t,moveRelativeTo:e,isMoving:r})=>et(t.line,e.marginBox[t.end]+li(t,r),Bs(t,e.marginBox,r)),Yn=({axis:t,moveRelativeTo:e,isMoving:r})=>et(t.line,e.marginBox[t.start]-bh(t,r),Bs(t,e.marginBox,r)),xh=({axis:t,moveInto:e,isMoving:r})=>et(t.line,e.contentBox[t.start]+li(t,r),Bs(t,e.contentBox,r));var vh=({impact:t,draggable:e,draggables:r,droppable:s,afterCritical:n})=>{const a=vt(s.descriptor.id,r),i=e.page,l=s.axis;if(!a.length)return xh({axis:l,moveInto:s.page,isMoving:i});const{displaced:c,displacedBy:d}=t,h=c.all[0];if(h){const f=r[h];if(Ge(h,n))return Yn({axis:l,moveRelativeTo:f.page,isMoving:i});const p=fr(f.page,d.point);return Yn({axis:l,moveRelativeTo:p,isMoving:i})}const u=a[a.length-1];if(u.descriptor.id===e.descriptor.id)return i.borderBox.center;if(Ge(u.descriptor.id,n)){const f=fr(u.page,xt(n.displacedBy.point));return Jn({axis:l,moveRelativeTo:f,isMoving:i})}return Jn({axis:l,moveRelativeTo:u.page,isMoving:i})},bs=(t,e)=>{const r=t.frame;return r?he(e,r.scroll.diff.displacement):e};const yh=({impact:t,draggable:e,droppable:r,draggables:s,afterCritical:n})=>{const a=e.page.borderBox.center,i=t.at;return!r||!i?a:i.type==="REORDER"?vh({impact:t,draggable:e,draggables:s,droppable:r,afterCritical:n}):mh({impact:t,draggables:s,afterCritical:n})};var Cr=t=>{const e=yh(t),r=t.droppable;return r?bs(r,e):e},ci=(t,e)=>{const r=ye(e,t.scroll.initial),s=xt(r);return{frame:Oe({top:e.y,bottom:e.y+t.frame.height,left:e.x,right:e.x+t.frame.width}),scroll:{initial:t.scroll.initial,max:t.scroll.max,current:e,diff:{value:r,displacement:s}}}};function Xn(t,e){return t.map(r=>e[r])}function wh(t,e){for(let r=0;r<e.length;r++){const s=e[r].visible[t];if(s)return s}return null}var _h=({impact:t,viewport:e,destination:r,draggables:s,maxScrollChange:n})=>{const a=ci(e,he(e.scroll.current,n)),i=r.frame?Ps(r,he(r.frame.scroll.current,n)):r,l=t.displaced,c=Wt({afterDragging:Xn(l.all,s),destination:r,displacedBy:t.displacedBy,viewport:a.frame,last:l,forceShouldAnimate:!1}),d=Wt({afterDragging:Xn(l.all,s),destination:i,displacedBy:t.displacedBy,viewport:e.frame,last:l,forceShouldAnimate:!1}),h={},u={},f=[l,c,d];return l.all.forEach(g=>{const m=wh(g,f);if(m){u[g]=m;return}h[g]=!0}),{...t,displaced:{all:l.all,invisible:h,visible:u}}},kh=(t,e)=>he(t.scroll.diff.displacement,e),Us=({pageBorderBoxCenter:t,draggable:e,viewport:r})=>{const s=kh(r,t),n=ye(s,e.page.borderBox.center);return he(e.client.borderBox.center,n)},di=({draggable:t,destination:e,newPageBorderBoxCenter:r,viewport:s,withDroppableDisplacement:n,onlyOnMainAxis:a=!1})=>{const i=ye(r,t.page.borderBox.center),c={target:Ht(t.page.borderBox,i),destination:e,withDroppableDisplacement:n,viewport:s};return a?lh(c):oi(c)},Sh=({isMovingForward:t,draggable:e,destination:r,draggables:s,previousImpact:n,viewport:a,previousPageBorderBoxCenter:i,previousClientSelection:l,afterCritical:c})=>{if(!r.isEnabled)return null;const d=vt(r.descriptor.id,s),h=yt(e,r),u=eh({isMovingForward:t,draggable:e,destination:r,insideDestination:d,previousImpact:n})||ph({isMovingForward:t,isInHomeList:h,draggable:e,draggables:s,destination:r,insideDestination:d,previousImpact:n,viewport:a,afterCritical:c});if(!u)return null;const f=Cr({impact:u,draggable:e,droppable:r,draggables:s,afterCritical:c});if(di({draggable:e,destination:r,newPageBorderBoxCenter:f,viewport:a.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0}))return{clientSelection:Us({pageBorderBoxCenter:f,draggable:e,viewport:a}),impact:u,scrollJumpRequest:null};const g=ye(f,i),m=_h({impact:u,viewport:a,destination:r,draggables:s,maxScrollChange:g});return{clientSelection:l,impact:m,scrollJumpRequest:g}};const fe=t=>{const e=t.subject.active;return e||R(),e};var Nh=({isMovingForward:t,pageBorderBoxCenter:e,source:r,droppables:s,viewport:n})=>{const a=r.subject.active;if(!a)return null;const i=r.axis,l=je(a[i.start],a[i.end]),c=Nr(s).filter(h=>h!==r).filter(h=>h.isEnabled).filter(h=>!!h.subject.active).filter(h=>ai(n.frame)(fe(h))).filter(h=>{const u=fe(h);return t?a[i.crossAxisEnd]<u[i.crossAxisEnd]:u[i.crossAxisStart]<a[i.crossAxisStart]}).filter(h=>{const u=fe(h),f=je(u[i.start],u[i.end]);return l(u[i.start])||l(u[i.end])||f(a[i.start])||f(a[i.end])}).sort((h,u)=>{const f=fe(h)[i.crossAxisStart],p=fe(u)[i.crossAxisStart];return t?f-p:p-f}).filter((h,u,f)=>fe(h)[i.crossAxisStart]===fe(f[0])[i.crossAxisStart]);if(!c.length)return null;if(c.length===1)return c[0];const d=c.filter(h=>je(fe(h)[i.start],fe(h)[i.end])(e[i.line]));return d.length===1?d[0]:d.length>1?d.sort((h,u)=>fe(h)[i.start]-fe(u)[i.start])[0]:c.sort((h,u)=>{const f=zn(e,Hn(fe(h))),p=zn(e,Hn(fe(u)));return f!==p?f-p:fe(h)[i.start]-fe(u)[i.start]})[0]};const Qn=(t,e)=>{const r=t.page.borderBox.center;return Ge(t.descriptor.id,e)?ye(r,e.displacedBy.point):r},jh=(t,e)=>{const r=t.page.borderBox;return Ge(t.descriptor.id,e)?Ht(r,xt(e.displacedBy.point)):r};var Eh=({pageBorderBoxCenter:t,viewport:e,destination:r,insideDestination:s,afterCritical:n})=>s.filter(i=>oi({target:jh(i,n),destination:r,viewport:e.frame,withDroppableDisplacement:!0})).sort((i,l)=>{const c=Mt(t,bs(r,Qn(i,n))),d=Mt(t,bs(r,Qn(l,n)));return c<d?-1:d<c?1:i.descriptor.index-l.descriptor.index})[0]||null,Kt=oe(function(e,r){const s=r[e.line];return{value:s,point:et(e.line,s)}});const Ch=(t,e,r)=>{const s=t.axis;if(t.descriptor.mode==="virtual")return et(s.line,e[s.line]);const n=t.subject.page.contentBox[s.size],c=vt(t.descriptor.id,r).reduce((d,h)=>d+h.client.marginBox[s.size],0)+e[s.line]-n;return c<=0?null:et(s.line,c)},ui=(t,e)=>({...t,scroll:{...t.scroll,max:e}}),hi=(t,e,r)=>{const s=t.frame;yt(e,t)&&R(),t.subject.withPlaceholder&&R();const n=Kt(t.axis,e.displaceBy).point,a=Ch(t,n,r),i={placeholderSize:n,increasedBy:a,oldFrameMaxScroll:t.frame?t.frame.scroll.max:null};if(!s){const h=gt({page:t.subject.page,withPlaceholder:i,axis:t.axis,frame:t.frame});return{...t,subject:h}}const l=a?he(s.scroll.max,a):s.scroll.max,c=ui(s,l),d=gt({page:t.subject.page,withPlaceholder:i,axis:t.axis,frame:c});return{...t,subject:d,frame:c}},Rh=t=>{const e=t.subject.withPlaceholder;e||R();const r=t.frame;if(!r){const i=gt({page:t.subject.page,axis:t.axis,frame:null,withPlaceholder:null});return{...t,subject:i}}const s=e.oldFrameMaxScroll;s||R();const n=ui(r,s),a=gt({page:t.subject.page,axis:t.axis,frame:n,withPlaceholder:null});return{...t,subject:a,frame:n}};var Ah=({previousPageBorderBoxCenter:t,moveRelativeTo:e,insideDestination:r,draggable:s,draggables:n,destination:a,viewport:i,afterCritical:l})=>{if(!e){if(r.length)return null;const u={displaced:Ft,displacedBy:ni,at:{type:"REORDER",destination:{droppableId:a.descriptor.id,index:0}}},f=Cr({impact:u,draggable:s,droppable:a,draggables:n,afterCritical:l}),p=yt(s,a)?a:hi(a,s,n);return di({draggable:s,destination:p,newPageBorderBoxCenter:f,viewport:i.frame,withDroppableDisplacement:!1,onlyOnMainAxis:!0})?u:null}const c=t[a.axis.line]<=e.page.borderBox.center[a.axis.line],d=(()=>{const u=e.descriptor.index;return e.descriptor.id===s.descriptor.id||c?u:u+1})(),h=Kt(a.axis,s.displaceBy);return xr({draggable:s,insideDestination:r,destination:a,viewport:i,displacedBy:h,last:Ft,index:d})},Ih=({isMovingForward:t,previousPageBorderBoxCenter:e,draggable:r,isOver:s,draggables:n,droppables:a,viewport:i,afterCritical:l})=>{const c=Nh({isMovingForward:t,pageBorderBoxCenter:e,source:s,droppables:a,viewport:i});if(!c)return null;const d=vt(c.descriptor.id,n),h=Eh({pageBorderBoxCenter:e,viewport:i,destination:c,insideDestination:d,afterCritical:l}),u=Ah({previousPageBorderBoxCenter:e,destination:c,draggable:r,draggables:n,moveRelativeTo:h,insideDestination:d,viewport:i,afterCritical:l});if(!u)return null;const f=Cr({impact:u,draggable:r,droppable:c,draggables:n,afterCritical:l});return{clientSelection:Us({pageBorderBoxCenter:f,draggable:r,viewport:i}),impact:u,scrollJumpRequest:null}},we=t=>{const e=t.at;return e?e.type==="REORDER"?e.destination.droppableId:e.combine.droppableId:null};const Oh=(t,e)=>{const r=we(t);return r?e[r]:null};var Th=({state:t,type:e})=>{const r=Oh(t.impact,t.dimensions.droppables),s=!!r,n=t.dimensions.droppables[t.critical.droppable.id],a=r||n,i=a.axis.direction,l=i==="vertical"&&(e==="MOVE_UP"||e==="MOVE_DOWN")||i==="horizontal"&&(e==="MOVE_LEFT"||e==="MOVE_RIGHT");if(l&&!s)return null;const c=e==="MOVE_DOWN"||e==="MOVE_RIGHT",d=t.dimensions.draggables[t.critical.draggable.id],h=t.current.page.borderBoxCenter,{draggables:u,droppables:f}=t.dimensions;return l?Sh({isMovingForward:c,previousPageBorderBoxCenter:h,draggable:d,destination:a,draggables:u,viewport:t.viewport,previousClientSelection:t.current.client.selection,previousImpact:t.impact,afterCritical:t.afterCritical}):Ih({isMovingForward:c,previousPageBorderBoxCenter:h,draggable:d,isOver:a,draggables:u,droppables:f,viewport:t.viewport,afterCritical:t.afterCritical})};function Je(t){return t.phase==="DRAGGING"||t.phase==="COLLECTING"}function fi(t){const e=je(t.top,t.bottom),r=je(t.left,t.right);return function(n){return e(n.y)&&r(n.x)}}function Ph(t,e){return t.left<e.right&&t.right>e.left&&t.top<e.bottom&&t.bottom>e.top}function Dh({pageBorderBox:t,draggable:e,candidates:r}){const s=e.page.borderBox.center,n=r.map(a=>{const i=a.axis,l=et(a.axis.line,t.center[i.line],a.page.borderBox.center[i.crossAxisLine]);return{id:a.descriptor.id,distance:Mt(s,l)}}).sort((a,i)=>i.distance-a.distance);return n[0]?n[0].id:null}function $h({pageBorderBox:t,draggable:e,droppables:r}){const s=Nr(r).filter(n=>{if(!n.isEnabled)return!1;const a=n.subject.active;if(!a||!Ph(t,a))return!1;if(fi(a)(t.center))return!0;const i=n.axis,l=a.center[i.crossAxisLine],c=t[i.crossAxisStart],d=t[i.crossAxisEnd],h=je(a[i.crossAxisStart],a[i.crossAxisEnd]),u=h(c),f=h(d);return!u&&!f?!0:u?c<l:d>l});return s.length?s.length===1?s[0].descriptor.id:Dh({pageBorderBox:t,draggable:e,candidates:s}):null}const pi=(t,e)=>Oe(Ht(t,e));var Lh=(t,e)=>{const r=t.frame;return r?pi(e,r.scroll.diff.value):e};function gi({displaced:t,id:e}){return!!(t.visible[e]||t.invisible[e])}function Bh({draggable:t,closest:e,inHomeList:r}){return e?r&&e.descriptor.index>t.descriptor.index?e.descriptor.index-1:e.descriptor.index:null}var Uh=({pageBorderBoxWithDroppableScroll:t,draggable:e,destination:r,insideDestination:s,last:n,viewport:a,afterCritical:i})=>{const l=r.axis,c=Kt(r.axis,e.displaceBy),d=c.value,h=t[l.start],u=t[l.end],p=Er(e,s).find(m=>{const b=m.descriptor.id,x=m.page.borderBox.center[l.line],w=Ge(b,i),v=gi({displaced:n,id:b});return w?v?u<=x:h<x-d:v?u<=x+d:h<x})||null,g=Bh({draggable:e,closest:p,inHomeList:yt(e,r)});return xr({draggable:e,insideDestination:s,destination:r,viewport:a,last:n,displacedBy:c,index:g})};const Mh=4;var Fh=({draggable:t,pageBorderBoxWithDroppableScroll:e,previousImpact:r,destination:s,insideDestination:n,afterCritical:a})=>{if(!s.isCombineEnabled)return null;const i=s.axis,l=Kt(s.axis,t.displaceBy),c=l.value,d=e[i.start],h=e[i.end],f=Er(t,n).find(g=>{const m=g.descriptor.id,b=g.page.borderBox,w=b[i.size]/Mh,v=Ge(m,a),_=gi({displaced:r.displaced,id:m});return v?_?h>b[i.start]+w&&h<b[i.end]-w:d>b[i.start]-c+w&&d<b[i.end]-c-w:_?h>b[i.start]+c+w&&h<b[i.end]+c-w:d>b[i.start]+w&&d<b[i.end]-w});return f?{displacedBy:l,displaced:r.displaced,at:{type:"COMBINE",combine:{draggableId:f.descriptor.id,droppableId:s.descriptor.id}}}:null},mi=({pageOffset:t,draggable:e,draggables:r,droppables:s,previousImpact:n,viewport:a,afterCritical:i})=>{const l=pi(e.page.borderBox,t),c=$h({pageBorderBox:l,draggable:e,droppables:s});if(!c)return th;const d=s[c],h=vt(d.descriptor.id,r),u=Lh(d,l);return Fh({pageBorderBoxWithDroppableScroll:u,draggable:e,previousImpact:n,destination:d,insideDestination:h,afterCritical:i})||Uh({pageBorderBoxWithDroppableScroll:u,draggable:e,destination:d,insideDestination:h,last:n.displaced,viewport:a,afterCritical:i})},Ms=(t,e)=>({...t,[e.descriptor.id]:e});const Wh=({previousImpact:t,impact:e,droppables:r})=>{const s=we(t),n=we(e);if(!s||s===n)return r;const a=r[s];if(!a.subject.withPlaceholder)return r;const i=Rh(a);return Ms(r,i)};var Gh=({draggable:t,draggables:e,droppables:r,previousImpact:s,impact:n})=>{const a=Wh({previousImpact:s,impact:n,droppables:r}),i=we(n);if(!i)return a;const l=r[i];if(yt(t,l)||l.subject.withPlaceholder)return a;const c=hi(l,t,e);return Ms(a,c)},It=({state:t,clientSelection:e,dimensions:r,viewport:s,impact:n,scrollJumpRequest:a})=>{const i=s||t.viewport,l=r||t.dimensions,c=e||t.current.client.selection,d=ye(c,t.initial.client.selection),h={offset:d,selection:c,borderBoxCenter:he(t.initial.client.borderBoxCenter,d)},u={selection:he(h.selection,i.scroll.current),borderBoxCenter:he(h.borderBoxCenter,i.scroll.current),offset:he(h.offset,i.scroll.diff.value)},f={client:h,page:u};if(t.phase==="COLLECTING")return{...t,dimensions:l,viewport:i,current:f};const p=l.draggables[t.critical.draggable.id],g=n||mi({pageOffset:u.offset,draggable:p,draggables:l.draggables,droppables:l.droppables,previousImpact:t.impact,viewport:i,afterCritical:t.afterCritical}),m=Gh({draggable:p,impact:g,previousImpact:t.impact,draggables:l.draggables,droppables:l.droppables});return{...t,current:f,dimensions:{draggables:l.draggables,droppables:m},impact:g,viewport:i,scrollJumpRequest:a||null,forceShouldAnimate:a?!1:null}};function qh(t,e){return t.map(r=>e[r])}var bi=({impact:t,viewport:e,draggables:r,destination:s,forceShouldAnimate:n})=>{const a=t.displaced,i=qh(a.all,r),l=Wt({afterDragging:i,destination:s,displacedBy:t.displacedBy,viewport:e.frame,forceShouldAnimate:n,last:a});return{...t,displaced:l}},xi=({impact:t,draggable:e,droppable:r,draggables:s,viewport:n,afterCritical:a})=>{const i=Cr({impact:t,draggable:e,draggables:s,droppable:r,afterCritical:a});return Us({pageBorderBoxCenter:i,draggable:e,viewport:n})},vi=({state:t,dimensions:e,viewport:r})=>{t.movementMode!=="SNAP"&&R();const s=t.impact,n=r||t.viewport,a=e||t.dimensions,{draggables:i,droppables:l}=a,c=i[t.critical.draggable.id],d=we(s);d||R();const h=l[d],u=bi({impact:s,viewport:n,destination:h,draggables:i}),f=xi({impact:u,draggable:c,droppable:h,draggables:i,viewport:n,afterCritical:t.afterCritical});return It({impact:u,clientSelection:f,state:t,dimensions:a,viewport:n})},Vh=t=>({index:t.index,droppableId:t.droppableId}),yi=({draggable:t,home:e,draggables:r,viewport:s})=>{const n=Kt(e.axis,t.displaceBy),a=vt(e.descriptor.id,r),i=a.indexOf(t);i===-1&&R();const l=a.slice(i+1),c=l.reduce((f,p)=>(f[p.descriptor.id]=!0,f),{}),d={inVirtualList:e.descriptor.mode==="virtual",displacedBy:n,effected:c};return{impact:{displaced:Wt({afterDragging:l,destination:e,displacedBy:n,last:null,viewport:s.frame,forceShouldAnimate:!1}),displacedBy:n,at:{type:"REORDER",destination:Vh(t.descriptor)}},afterCritical:d}},zh=(t,e)=>({draggables:t.draggables,droppables:Ms(t.droppables,e)}),Hh=({draggable:t,offset:e,initialWindowScroll:r})=>{const s=fr(t.client,e),n=pr(s,r);return{...t,placeholder:{...t.placeholder,client:s},client:s,page:n}},Kh=t=>{const e=t.frame;return e||R(),e},Jh=({additions:t,updatedDroppables:e,viewport:r})=>{const s=r.scroll.diff.value;return t.map(n=>{const a=n.descriptor.droppableId,i=e[a],c=Kh(i).scroll.diff.value,d=he(s,c);return Hh({draggable:n,offset:d,initialWindowScroll:r.scroll.initial})})},Yh=({state:t,published:e})=>{const r=e.modified.map(x=>{const w=t.dimensions.droppables[x.droppableId];return Ps(w,x.scroll)}),s={...t.dimensions.droppables,...ri(r)},n=si(Jh({additions:e.additions,updatedDroppables:s,viewport:t.viewport})),a={...t.dimensions.draggables,...n};e.removals.forEach(x=>{delete a[x]});const i={droppables:s,draggables:a},l=we(t.impact),c=l?i.droppables[l]:null,d=i.draggables[t.critical.draggable.id],h=i.droppables[t.critical.droppable.id],{impact:u,afterCritical:f}=yi({draggable:d,home:h,draggables:a,viewport:t.viewport}),p=c&&c.isCombineEnabled?t.impact:u,g=mi({pageOffset:t.current.page.offset,draggable:i.draggables[t.critical.draggable.id],draggables:i.draggables,droppables:i.droppables,previousImpact:p,viewport:t.viewport,afterCritical:f}),m={...t,phase:"DRAGGING",impact:g,onLiftImpact:u,dimensions:i,afterCritical:f,forceShouldAnimate:!1};return t.phase==="COLLECTING"?m:{...m,phase:"DROP_PENDING",reason:t.reason,isWaiting:!1}};const xs=t=>t.movementMode==="SNAP",Jr=(t,e,r)=>{const s=zh(t.dimensions,e);return!xs(t)||r?It({state:t,dimensions:s}):vi({state:t,dimensions:s})};function Yr(t){return t.isDragging&&t.movementMode==="SNAP"?{...t,scrollJumpRequest:null}:t}const Zn={phase:"IDLE",completed:null,shouldFlush:!1};var Xh=(t=Zn,e)=>{if(e.type==="FLUSH")return{...Zn,shouldFlush:!0};if(e.type==="INITIAL_PUBLISH"){t.phase!=="IDLE"&&R();const{critical:r,clientSelection:s,viewport:n,dimensions:a,movementMode:i}=e.payload,l=a.draggables[r.draggable.id],c=a.droppables[r.droppable.id],d={selection:s,borderBoxCenter:l.client.borderBox.center,offset:le},h={client:d,page:{selection:he(d.selection,n.scroll.initial),borderBoxCenter:he(d.selection,n.scroll.initial),offset:he(d.selection,n.scroll.diff.value)}},u=Nr(a.droppables).every(m=>!m.isFixedOnPage),{impact:f,afterCritical:p}=yi({draggable:l,home:c,draggables:a.draggables,viewport:n});return{phase:"DRAGGING",isDragging:!0,critical:r,movementMode:i,dimensions:a,initial:h,current:h,isWindowScrollAllowed:u,impact:f,afterCritical:p,onLiftImpact:f,viewport:n,scrollJumpRequest:null,forceShouldAnimate:null}}if(e.type==="COLLECTION_STARTING")return t.phase==="COLLECTING"||t.phase==="DROP_PENDING"?t:(t.phase!=="DRAGGING"&&R(),{...t,phase:"COLLECTING"});if(e.type==="PUBLISH_WHILE_DRAGGING")return t.phase==="COLLECTING"||t.phase==="DROP_PENDING"||R(),Yh({state:t,published:e.payload});if(e.type==="MOVE"){if(t.phase==="DROP_PENDING")return t;Je(t)||R();const{client:r}=e.payload;return We(r,t.current.client.selection)?t:It({state:t,clientSelection:r,impact:xs(t)?t.impact:null})}if(e.type==="UPDATE_DROPPABLE_SCROLL"){if(t.phase==="DROP_PENDING"||t.phase==="COLLECTING")return Yr(t);Je(t)||R();const{id:r,newScroll:s}=e.payload,n=t.dimensions.droppables[r];if(!n)return t;const a=Ps(n,s);return Jr(t,a,!1)}if(e.type==="UPDATE_DROPPABLE_IS_ENABLED"){if(t.phase==="DROP_PENDING")return t;Je(t)||R();const{id:r,isEnabled:s}=e.payload,n=t.dimensions.droppables[r];n||R(),n.isEnabled===s&&R();const a={...n,isEnabled:s};return Jr(t,a,!0)}if(e.type==="UPDATE_DROPPABLE_IS_COMBINE_ENABLED"){if(t.phase==="DROP_PENDING")return t;Je(t)||R();const{id:r,isCombineEnabled:s}=e.payload,n=t.dimensions.droppables[r];n||R(),n.isCombineEnabled===s&&R();const a={...n,isCombineEnabled:s};return Jr(t,a,!0)}if(e.type==="MOVE_BY_WINDOW_SCROLL"){if(t.phase==="DROP_PENDING"||t.phase==="DROP_ANIMATING")return t;Je(t)||R(),t.isWindowScrollAllowed||R();const r=e.payload.newScroll;if(We(t.viewport.scroll.current,r))return Yr(t);const s=ci(t.viewport,r);return xs(t)?vi({state:t,viewport:s}):It({state:t,viewport:s})}if(e.type==="UPDATE_VIEWPORT_MAX_SCROLL"){if(!Je(t))return t;const r=e.payload.maxScroll;if(We(r,t.viewport.scroll.max))return t;const s={...t.viewport,scroll:{...t.viewport.scroll,max:r}};return{...t,viewport:s}}if(e.type==="MOVE_UP"||e.type==="MOVE_DOWN"||e.type==="MOVE_LEFT"||e.type==="MOVE_RIGHT"){if(t.phase==="COLLECTING"||t.phase==="DROP_PENDING")return t;t.phase!=="DRAGGING"&&R();const r=Th({state:t,type:e.type});return r?It({state:t,impact:r.impact,clientSelection:r.clientSelection,scrollJumpRequest:r.scrollJumpRequest}):t}if(e.type==="DROP_PENDING"){const r=e.payload.reason;return t.phase!=="COLLECTING"&&R(),{...t,phase:"DROP_PENDING",isWaiting:!0,reason:r}}if(e.type==="DROP_ANIMATE"){const{completed:r,dropDuration:s,newHomeClientOffset:n}=e.payload;return t.phase==="DRAGGING"||t.phase==="DROP_PENDING"||R(),{phase:"DROP_ANIMATING",completed:r,dropDuration:s,newHomeClientOffset:n,dimensions:t.dimensions}}if(e.type==="DROP_COMPLETE"){const{completed:r}=e.payload;return{phase:"IDLE",completed:r,shouldFlush:!1}}return t};function H(t,e){return t instanceof Object&&"type"in t&&t.type===e}const Qh=t=>({type:"BEFORE_INITIAL_CAPTURE",payload:t}),Zh=t=>({type:"LIFT",payload:t}),ef=t=>({type:"INITIAL_PUBLISH",payload:t}),tf=t=>({type:"PUBLISH_WHILE_DRAGGING",payload:t}),rf=()=>({type:"COLLECTION_STARTING",payload:null}),sf=t=>({type:"UPDATE_DROPPABLE_SCROLL",payload:t}),nf=t=>({type:"UPDATE_DROPPABLE_IS_ENABLED",payload:t}),af=t=>({type:"UPDATE_DROPPABLE_IS_COMBINE_ENABLED",payload:t}),wi=t=>({type:"MOVE",payload:t}),of=t=>({type:"MOVE_BY_WINDOW_SCROLL",payload:t}),lf=t=>({type:"UPDATE_VIEWPORT_MAX_SCROLL",payload:t}),cf=()=>({type:"MOVE_UP",payload:null}),df=()=>({type:"MOVE_DOWN",payload:null}),uf=()=>({type:"MOVE_RIGHT",payload:null}),hf=()=>({type:"MOVE_LEFT",payload:null}),Fs=()=>({type:"FLUSH",payload:null}),ff=t=>({type:"DROP_ANIMATE",payload:t}),Ws=t=>({type:"DROP_COMPLETE",payload:t}),_i=t=>({type:"DROP",payload:t}),pf=t=>({type:"DROP_PENDING",payload:t}),ki=()=>({type:"DROP_ANIMATION_FINISHED",payload:null});var gf=t=>({getState:e,dispatch:r})=>s=>n=>{if(!H(n,"LIFT")){s(n);return}const{id:a,clientSelection:i,movementMode:l}=n.payload,c=e();c.phase==="DROP_ANIMATING"&&r(Ws({completed:c.completed})),e().phase!=="IDLE"&&R(),r(Fs()),r(Qh({draggableId:a,movementMode:l}));const h={draggableId:a,scrollOptions:{shouldPublishImmediately:l==="SNAP"}},{critical:u,dimensions:f,viewport:p}=t.startPublishing(h);r(ef({critical:u,dimensions:f,clientSelection:i,movementMode:l,viewport:p}))},mf=t=>()=>e=>r=>{H(r,"INITIAL_PUBLISH")&&t.dragging(),H(r,"DROP_ANIMATE")&&t.dropping(r.payload.completed.result.reason),(H(r,"FLUSH")||H(r,"DROP_COMPLETE"))&&t.resting(),e(r)};const Gs={outOfTheWay:"cubic-bezier(0.2, 0, 0, 1)",drop:"cubic-bezier(.2,1,.1,1)"},Gt={opacity:{drop:0,combining:.7},scale:{drop:.75}},Si={outOfTheWay:.2,minDropTime:.33,maxDropTime:.55},He=`${Si.outOfTheWay}s ${Gs.outOfTheWay}`,Ot={fluid:`opacity ${He}`,snap:`transform ${He}, opacity ${He}`,drop:t=>{const e=`${t}s ${Gs.drop}`;return`transform ${e}, opacity ${e}`},outOfTheWay:`transform ${He}`,placeholder:`height ${He}, width ${He}, margin ${He}`},ea=t=>We(t,le)?void 0:`translate(${t.x}px, ${t.y}px)`,vs={moveTo:ea,drop:(t,e)=>{const r=ea(t);if(r)return e?`${r} scale(${Gt.scale.drop})`:r}},{minDropTime:ys,maxDropTime:Ni}=Si,bf=Ni-ys,ta=1500,xf=.6;var vf=({current:t,destination:e,reason:r})=>{const s=Mt(t,e);if(s<=0)return ys;if(s>=ta)return Ni;const n=s/ta,a=ys+bf*n,i=r==="CANCEL"?a*xf:a;return Number(i.toFixed(2))},yf=({impact:t,draggable:e,dimensions:r,viewport:s,afterCritical:n})=>{const{draggables:a,droppables:i}=r,l=we(t),c=l?i[l]:null,d=i[e.descriptor.droppableId],h=xi({impact:t,draggable:e,draggables:a,afterCritical:n,droppable:c||d,viewport:s});return ye(h,e.client.borderBox.center)},wf=({draggables:t,reason:e,lastImpact:r,home:s,viewport:n,onLiftImpact:a})=>!r.at||e!=="DROP"?{impact:bi({draggables:t,impact:a,destination:s,viewport:n,forceShouldAnimate:!0}),didDropInsideDroppable:!1}:r.at.type==="REORDER"?{impact:r,didDropInsideDroppable:!0}:{impact:{...r,displaced:Ft},didDropInsideDroppable:!0};const _f=({getState:t,dispatch:e})=>r=>s=>{if(!H(s,"DROP")){r(s);return}const n=t(),a=s.payload.reason;if(n.phase==="COLLECTING"){e(pf({reason:a}));return}if(n.phase==="IDLE")return;n.phase==="DROP_PENDING"&&n.isWaiting&&R(),n.phase==="DRAGGING"||n.phase==="DROP_PENDING"||R();const l=n.critical,c=n.dimensions,d=c.draggables[n.critical.draggable.id],{impact:h,didDropInsideDroppable:u}=wf({reason:a,lastImpact:n.impact,afterCritical:n.afterCritical,onLiftImpact:n.onLiftImpact,home:n.dimensions.droppables[n.critical.droppable.id],viewport:n.viewport,draggables:n.dimensions.draggables}),f=u?Ds(h):null,p=u?jr(h):null,g={index:l.draggable.index,droppableId:l.droppable.id},m={draggableId:d.descriptor.id,type:d.descriptor.type,source:g,reason:a,mode:n.movementMode,destination:f,combine:p},b=yf({impact:h,draggable:d,dimensions:c,viewport:n.viewport,afterCritical:n.afterCritical}),x={critical:n.critical,afterCritical:n.afterCritical,result:m,impact:h};if(!(!We(n.current.client.offset,b)||!!m.combine)){e(Ws({completed:x}));return}const v=vf({current:n.current.client.offset,destination:b,reason:a});e(ff({newHomeClientOffset:b,dropDuration:v,completed:x}))};var ji=()=>({x:window.pageXOffset,y:window.pageYOffset});function kf(t){return{eventName:"scroll",options:{passive:!0,capture:!1},fn:e=>{e.target!==window&&e.target!==window.document||t()}}}function Sf({onWindowScroll:t}){function e(){t(ji())}const r=Ut(e),s=kf(r);let n=Fe;function a(){return n!==Fe}function i(){a()&&R(),n=Ne(window,[s])}function l(){a()||R(),r.cancel(),n(),n=Fe}return{start:i,stop:l,isActive:a}}const Nf=t=>H(t,"DROP_COMPLETE")||H(t,"DROP_ANIMATE")||H(t,"FLUSH"),jf=t=>{const e=Sf({onWindowScroll:r=>{t.dispatch(of({newScroll:r}))}});return r=>s=>{!e.isActive()&&H(s,"INITIAL_PUBLISH")&&e.start(),e.isActive()&&Nf(s)&&e.stop(),r(s)}};var Ef=t=>{let e=!1,r=!1;const s=setTimeout(()=>{r=!0}),n=a=>{e||r||(e=!0,t(a),clearTimeout(s))};return n.wasCalled=()=>e,n},Cf=()=>{const t=[],e=n=>{const a=t.findIndex(l=>l.timerId===n);a===-1&&R();const[i]=t.splice(a,1);i.callback()};return{add:n=>{const a=setTimeout(()=>e(a)),i={timerId:a,callback:n};t.push(i)},flush:()=>{if(!t.length)return;const n=[...t];t.length=0,n.forEach(a=>{clearTimeout(a.timerId),a.callback()})}}};const Rf=(t,e)=>t==null&&e==null?!0:t==null||e==null?!1:t.droppableId===e.droppableId&&t.index===e.index,Af=(t,e)=>t==null&&e==null?!0:t==null||e==null?!1:t.draggableId===e.draggableId&&t.droppableId===e.droppableId,If=(t,e)=>{if(t===e)return!0;const r=t.draggable.id===e.draggable.id&&t.draggable.droppableId===e.draggable.droppableId&&t.draggable.type===e.draggable.type&&t.draggable.index===e.draggable.index,s=t.droppable.id===e.droppable.id&&t.droppable.type===e.droppable.type;return r&&s},_t=(t,e)=>{e()},rr=(t,e)=>({draggableId:t.draggable.id,type:t.droppable.type,source:{droppableId:t.droppable.id,index:t.draggable.index},mode:e});function Xr(t,e,r,s){if(!t){r(s(e));return}const n=Ef(r);t(e,{announce:n}),n.wasCalled()||r(s(e))}var Of=(t,e)=>{const r=Cf();let s=null;const n=(u,f)=>{s&&R(),_t("onBeforeCapture",()=>{const p=t().onBeforeCapture;p&&p({draggableId:u,mode:f})})},a=(u,f)=>{s&&R(),_t("onBeforeDragStart",()=>{const p=t().onBeforeDragStart;p&&p(rr(u,f))})},i=(u,f)=>{s&&R();const p=rr(u,f);s={mode:f,lastCritical:u,lastLocation:p.source,lastCombine:null},r.add(()=>{_t("onDragStart",()=>Xr(t().onDragStart,p,e,or.onDragStart))})},l=(u,f)=>{const p=Ds(f),g=jr(f);s||R();const m=!If(u,s.lastCritical);m&&(s.lastCritical=u);const b=!Rf(s.lastLocation,p);b&&(s.lastLocation=p);const x=!Af(s.lastCombine,g);if(x&&(s.lastCombine=g),!m&&!b&&!x)return;const w={...rr(u,s.mode),combine:g,destination:p};r.add(()=>{_t("onDragUpdate",()=>Xr(t().onDragUpdate,w,e,or.onDragUpdate))})},c=()=>{s||R(),r.flush()},d=u=>{s||R(),s=null,_t("onDragEnd",()=>Xr(t().onDragEnd,u,e,or.onDragEnd))};return{beforeCapture:n,beforeStart:a,start:i,update:l,flush:c,drop:d,abort:()=>{if(!s)return;const u={...rr(s.lastCritical,s.mode),combine:null,destination:null,reason:"CANCEL"};d(u)}}},Tf=(t,e)=>{const r=Of(t,e);return s=>n=>a=>{if(H(a,"BEFORE_INITIAL_CAPTURE")){r.beforeCapture(a.payload.draggableId,a.payload.movementMode);return}if(H(a,"INITIAL_PUBLISH")){const l=a.payload.critical;r.beforeStart(l,a.payload.movementMode),n(a),r.start(l,a.payload.movementMode);return}if(H(a,"DROP_COMPLETE")){const l=a.payload.completed.result;r.flush(),n(a),r.drop(l);return}if(n(a),H(a,"FLUSH")){r.abort();return}const i=s.getState();i.phase==="DRAGGING"&&r.update(i.critical,i.impact)}};const Pf=t=>e=>r=>{if(!H(r,"DROP_ANIMATION_FINISHED")){e(r);return}const s=t.getState();s.phase!=="DROP_ANIMATING"&&R(),t.dispatch(Ws({completed:s.completed}))},Df=t=>{let e=null,r=null;function s(){r&&(cancelAnimationFrame(r),r=null),e&&(e(),e=null)}return n=>a=>{if((H(a,"FLUSH")||H(a,"DROP_COMPLETE")||H(a,"DROP_ANIMATION_FINISHED"))&&s(),n(a),!H(a,"DROP_ANIMATE"))return;const i={eventName:"scroll",options:{capture:!0,passive:!1,once:!0},fn:function(){t.getState().phase==="DROP_ANIMATING"&&t.dispatch(ki())}};r=requestAnimationFrame(()=>{r=null,e=Ne(window,[i])})}};var $f=t=>()=>e=>r=>{(H(r,"DROP_COMPLETE")||H(r,"FLUSH")||H(r,"DROP_ANIMATE"))&&t.stopPublishing(),e(r)},Lf=t=>{let e=!1;return()=>r=>s=>{if(H(s,"INITIAL_PUBLISH")){e=!0,t.tryRecordFocus(s.payload.critical.draggable.id),r(s),t.tryRestoreFocusRecorded();return}if(r(s),!!e){if(H(s,"FLUSH")){e=!1,t.tryRestoreFocusRecorded();return}if(H(s,"DROP_COMPLETE")){e=!1;const n=s.payload.completed.result;n.combine&&t.tryShiftRecord(n.draggableId,n.combine.draggableId),t.tryRestoreFocusRecorded()}}}};const Bf=t=>H(t,"DROP_COMPLETE")||H(t,"DROP_ANIMATE")||H(t,"FLUSH");var Uf=t=>e=>r=>s=>{if(Bf(s)){t.stop(),r(s);return}if(H(s,"INITIAL_PUBLISH")){r(s);const n=e.getState();n.phase!=="DRAGGING"&&R(),t.start(n);return}r(s),t.scroll(e.getState())};const Mf=t=>e=>r=>{if(e(r),!H(r,"PUBLISH_WHILE_DRAGGING"))return;const s=t.getState();s.phase==="DROP_PENDING"&&(s.isWaiting||t.dispatch(_i({reason:s.reason})))},Ff=Wa;var Wf=({dimensionMarshal:t,focusMarshal:e,styleMarshal:r,getResponders:s,announce:n,autoScroller:a})=>Fa(Xh,Ff(Bd(mf(r),$f(t),gf(t),_f,Pf,Df,Mf,Uf(a),jf,Lf(e),Tf(s,n))));const Qr=()=>({additions:{},removals:{},modified:{}});function Gf({registry:t,callbacks:e}){let r=Qr(),s=null;const n=()=>{s||(e.collectionStarting(),s=requestAnimationFrame(()=>{s=null;const{additions:c,removals:d,modified:h}=r,u=Object.keys(c).map(g=>t.draggable.getById(g).getDimension(le)).sort((g,m)=>g.descriptor.index-m.descriptor.index),f=Object.keys(h).map(g=>{const b=t.droppable.getById(g).callbacks.getScrollWhileDragging();return{droppableId:g,scroll:b}}),p={additions:u,removals:Object.keys(d),modified:f};r=Qr(),e.publish(p)}))};return{add:c=>{const d=c.descriptor.id;r.additions[d]=c,r.modified[c.descriptor.droppableId]=!0,r.removals[d]&&delete r.removals[d],n()},remove:c=>{const d=c.descriptor;r.removals[d.id]=!0,r.modified[d.droppableId]=!0,r.additions[d.id]&&delete r.additions[d.id],n()},stop:()=>{s&&(cancelAnimationFrame(s),s=null,r=Qr())}}}var Ei=({scrollHeight:t,scrollWidth:e,height:r,width:s})=>{const n=ye({x:e,y:t},{x:s,y:r});return{x:Math.max(0,n.x),y:Math.max(0,n.y)}},Ci=()=>{const t=document.documentElement;return t||R(),t},Ri=()=>{const t=Ci();return Ei({scrollHeight:t.scrollHeight,scrollWidth:t.scrollWidth,width:t.clientWidth,height:t.clientHeight})},qf=()=>{const t=ji(),e=Ri(),r=t.y,s=t.x,n=Ci(),a=n.clientWidth,i=n.clientHeight,l=s+a,c=r+i;return{frame:Oe({top:r,left:s,right:l,bottom:c}),scroll:{initial:t,current:t,max:e,diff:{value:le,displacement:le}}}},Vf=({critical:t,scrollOptions:e,registry:r})=>{const s=qf(),n=s.scroll.current,a=t.droppable,i=r.droppable.getAllByType(a.type).map(h=>h.callbacks.getDimensionAndWatchScroll(n,e)),l=r.draggable.getAllByType(t.draggable.type).map(h=>h.getDimension(n));return{dimensions:{draggables:si(l),droppables:ri(i)},critical:t,viewport:s}};function ra(t,e,r){return!(r.descriptor.id===e.id||r.descriptor.type!==e.type||t.droppable.getById(r.descriptor.droppableId).descriptor.mode!=="virtual")}var zf=(t,e)=>{let r=null;const s=Gf({callbacks:{publish:e.publishWhileDragging,collectionStarting:e.collectionStarting},registry:t}),n=(f,p)=>{t.droppable.exists(f)||R(),r&&e.updateDroppableIsEnabled({id:f,isEnabled:p})},a=(f,p)=>{r&&(t.droppable.exists(f)||R(),e.updateDroppableIsCombineEnabled({id:f,isCombineEnabled:p}))},i=(f,p)=>{r&&(t.droppable.exists(f)||R(),e.updateDroppableScroll({id:f,newScroll:p}))},l=(f,p)=>{r&&t.droppable.getById(f).callbacks.scroll(p)},c=()=>{if(!r)return;s.stop();const f=r.critical.droppable;t.droppable.getAllByType(f.type).forEach(p=>p.callbacks.dragStopped()),r.unsubscribe(),r=null},d=f=>{r||R();const p=r.critical.draggable;f.type==="ADDITION"&&ra(t,p,f.value)&&s.add(f.value),f.type==="REMOVAL"&&ra(t,p,f.value)&&s.remove(f.value)};return{updateDroppableIsEnabled:n,updateDroppableIsCombineEnabled:a,scrollDroppable:l,updateDroppableScroll:i,startPublishing:f=>{r&&R();const p=t.draggable.getById(f.draggableId),g=t.droppable.getById(p.descriptor.droppableId),m={draggable:p.descriptor,droppable:g.descriptor},b=t.subscribe(d);return r={critical:m,unsubscribe:b},Vf({critical:m,registry:t,scrollOptions:f.scrollOptions})},stopPublishing:c}},Ai=(t,e)=>t.phase==="IDLE"?!0:t.phase!=="DROP_ANIMATING"||t.completed.result.draggableId===e?!1:t.completed.result.reason==="DROP",Hf=t=>{window.scrollBy(t.x,t.y)};const Kf=oe(t=>Nr(t).filter(e=>!(!e.isEnabled||!e.frame))),Jf=(t,e)=>Kf(e).find(s=>(s.frame||R(),fi(s.frame.pageMarginBox)(t)))||null;var Yf=({center:t,destination:e,droppables:r})=>{if(e){const n=r[e];return n.frame?n:null}return Jf(t,r)};const qt={startFromPercentage:.25,maxScrollAtPercentage:.05,maxPixelScroll:28,ease:t=>t**2,durationDampening:{stopDampeningAt:1200,accelerateAt:360},disabled:!1};var Xf=(t,e,r=()=>qt)=>{const s=r(),n=t[e.size]*s.startFromPercentage,a=t[e.size]*s.maxScrollAtPercentage;return{startScrollingFrom:n,maxScrollValueAt:a}},Ii=({startOfRange:t,endOfRange:e,current:r})=>{const s=e-t;return s===0?0:(r-t)/s},qs=1,Qf=(t,e,r=()=>qt)=>{const s=r();if(t>e.startScrollingFrom)return 0;if(t<=e.maxScrollValueAt)return s.maxPixelScroll;if(t===e.startScrollingFrom)return qs;const a=1-Ii({startOfRange:e.maxScrollValueAt,endOfRange:e.startScrollingFrom,current:t}),i=s.maxPixelScroll*s.ease(a);return Math.ceil(i)},Zf=(t,e,r)=>{const s=r(),n=s.durationDampening.accelerateAt,a=s.durationDampening.stopDampeningAt,i=e,l=a,d=Date.now()-i;if(d>=a)return t;if(d<n)return qs;const h=Ii({startOfRange:n,endOfRange:l,current:d}),u=t*s.ease(h);return Math.ceil(u)},sa=({distanceToEdge:t,thresholds:e,dragStartTime:r,shouldUseTimeDampening:s,getAutoScrollerOptions:n})=>{const a=Qf(t,e,n);return a===0?0:s?Math.max(Zf(a,r,n),qs):a},na=({container:t,distanceToEdges:e,dragStartTime:r,axis:s,shouldUseTimeDampening:n,getAutoScrollerOptions:a})=>{const i=Xf(t,s,a);return e[s.end]<e[s.start]?sa({distanceToEdge:e[s.end],thresholds:i,dragStartTime:r,shouldUseTimeDampening:n,getAutoScrollerOptions:a}):-1*sa({distanceToEdge:e[s.start],thresholds:i,dragStartTime:r,shouldUseTimeDampening:n,getAutoScrollerOptions:a})},ep=({container:t,subject:e,proposedScroll:r})=>{const s=e.height>t.height,n=e.width>t.width;return!n&&!s?r:n&&s?null:{x:n?0:r.x,y:s?0:r.y}};const tp=ti(t=>t===0?0:t);var Oi=({dragStartTime:t,container:e,subject:r,center:s,shouldUseTimeDampening:n,getAutoScrollerOptions:a})=>{const i={top:s.y-e.top,right:e.right-s.x,bottom:e.bottom-s.y,left:s.x-e.left},l=na({container:e,distanceToEdges:i,dragStartTime:t,axis:$s,shouldUseTimeDampening:n,getAutoScrollerOptions:a}),c=na({container:e,distanceToEdges:i,dragStartTime:t,axis:ii,shouldUseTimeDampening:n,getAutoScrollerOptions:a}),d=tp({x:c,y:l});if(We(d,le))return null;const h=ep({container:e,subject:r,proposedScroll:d});return h?We(h,le)?null:h:null};const rp=ti(t=>t===0?0:t>0?1:-1),Vs=(()=>{const t=(e,r)=>e<0?e:e>r?e-r:0;return({current:e,max:r,change:s})=>{const n=he(e,s),a={x:t(n.x,r.x),y:t(n.y,r.y)};return We(a,le)?null:a}})(),Ti=({max:t,current:e,change:r})=>{const s={x:Math.max(e.x,t.x),y:Math.max(e.y,t.y)},n=rp(r),a=Vs({max:s,current:e,change:n});return!a||n.x!==0&&a.x===0||n.y!==0&&a.y===0},zs=(t,e)=>Ti({current:t.scroll.current,max:t.scroll.max,change:e}),sp=(t,e)=>{if(!zs(t,e))return null;const r=t.scroll.max,s=t.scroll.current;return Vs({current:s,max:r,change:e})},Hs=(t,e)=>{const r=t.frame;return r?Ti({current:r.scroll.current,max:r.scroll.max,change:e}):!1},np=(t,e)=>{const r=t.frame;return!r||!Hs(t,e)?null:Vs({current:r.scroll.current,max:r.scroll.max,change:e})};var ap=({viewport:t,subject:e,center:r,dragStartTime:s,shouldUseTimeDampening:n,getAutoScrollerOptions:a})=>{const i=Oi({dragStartTime:s,container:t.frame,subject:e,center:r,shouldUseTimeDampening:n,getAutoScrollerOptions:a});return i&&zs(t,i)?i:null},ip=({droppable:t,subject:e,center:r,dragStartTime:s,shouldUseTimeDampening:n,getAutoScrollerOptions:a})=>{const i=t.frame;if(!i)return null;const l=Oi({dragStartTime:s,container:i.pageMarginBox,subject:e,center:r,shouldUseTimeDampening:n,getAutoScrollerOptions:a});return l&&Hs(t,l)?l:null},aa=({state:t,dragStartTime:e,shouldUseTimeDampening:r,scrollWindow:s,scrollDroppable:n,getAutoScrollerOptions:a})=>{const i=t.current.page.borderBoxCenter,c=t.dimensions.draggables[t.critical.draggable.id].page.marginBox;if(t.isWindowScrollAllowed){const u=t.viewport,f=ap({dragStartTime:e,viewport:u,subject:c,center:i,shouldUseTimeDampening:r,getAutoScrollerOptions:a});if(f){s(f);return}}const d=Yf({center:i,destination:we(t.impact),droppables:t.dimensions.droppables});if(!d)return;const h=ip({dragStartTime:e,droppable:d,subject:c,center:i,shouldUseTimeDampening:r,getAutoScrollerOptions:a});h&&n(d.descriptor.id,h)},op=({scrollWindow:t,scrollDroppable:e,getAutoScrollerOptions:r=()=>qt})=>{const s=Ut(t),n=Ut(e);let a=null;const i=d=>{a||R();const{shouldUseTimeDampening:h,dragStartTime:u}=a;aa({state:d,scrollWindow:s,scrollDroppable:n,dragStartTime:u,shouldUseTimeDampening:h,getAutoScrollerOptions:r})};return{start:d=>{a&&R();const h=Date.now();let u=!1;const f=()=>{u=!0};aa({state:d,dragStartTime:0,shouldUseTimeDampening:!1,scrollWindow:f,scrollDroppable:f,getAutoScrollerOptions:r}),a={dragStartTime:h,shouldUseTimeDampening:u},u&&i(d)},stop:()=>{a&&(s.cancel(),n.cancel(),a=null)},scroll:i}},lp=({move:t,scrollDroppable:e,scrollWindow:r})=>{const s=(l,c)=>{const d=he(l.current.client.selection,c);t({client:d})},n=(l,c)=>{if(!Hs(l,c))return c;const d=np(l,c);if(!d)return e(l.descriptor.id,c),null;const h=ye(c,d);return e(l.descriptor.id,h),ye(c,h)},a=(l,c,d)=>{if(!l||!zs(c,d))return d;const h=sp(c,d);if(!h)return r(d),null;const u=ye(d,h);return r(u),ye(d,u)};return l=>{const c=l.scrollJumpRequest;if(!c)return;const d=we(l.impact);d||R();const h=n(l.dimensions.droppables[d],c);if(!h)return;const u=l.viewport,f=a(l.isWindowScrollAllowed,u,h);f&&s(l,f)}},cp=({scrollDroppable:t,scrollWindow:e,move:r,getAutoScrollerOptions:s})=>{const n=op({scrollWindow:e,scrollDroppable:t,getAutoScrollerOptions:s}),a=lp({move:r,scrollWindow:e,scrollDroppable:t});return{scroll:c=>{if(!(s().disabled||c.phase!=="DRAGGING")){if(c.movementMode==="FLUID"){n.scroll(c);return}c.scrollJumpRequest&&a(c)}},start:n.start,stop:n.stop}};const mt="data-rfd",bt=(()=>{const t=`${mt}-drag-handle`;return{base:t,draggableId:`${t}-draggable-id`,contextId:`${t}-context-id`}})(),ws=(()=>{const t=`${mt}-draggable`;return{base:t,contextId:`${t}-context-id`,id:`${t}-id`}})(),dp=(()=>{const t=`${mt}-droppable`;return{base:t,contextId:`${t}-context-id`,id:`${t}-id`}})(),ia={contextId:`${mt}-scroll-container-context-id`},up=t=>e=>`[${e}="${t}"]`,kt=(t,e)=>t.map(r=>{const s=r.styles[e];return s?`${r.selector} { ${s} }`:""}).join(" "),hp="pointer-events: none;";var fp=t=>{const e=up(t),r=(()=>{const l=`
      cursor: -webkit-grab;
      cursor: grab;
    `;return{selector:e(bt.contextId),styles:{always:`
          -webkit-touch-callout: none;
          -webkit-tap-highlight-color: rgba(0,0,0,0);
          touch-action: manipulation;
        `,resting:l,dragging:hp,dropAnimating:l}}})(),s=(()=>{const l=`
      transition: ${Ot.outOfTheWay};
    `;return{selector:e(ws.contextId),styles:{dragging:l,dropAnimating:l,userCancel:l}}})(),n={selector:e(dp.contextId),styles:{always:"overflow-anchor: none;"}},i=[s,r,n,{selector:"body",styles:{dragging:`
        cursor: grabbing;
        cursor: -webkit-grabbing;
        user-select: none;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        overflow-anchor: none;
      `}}];return{always:kt(i,"always"),resting:kt(i,"resting"),dragging:kt(i,"dragging"),dropAnimating:kt(i,"dropAnimating"),userCancel:kt(i,"userCancel")}};const _e=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?S.useLayoutEffect:S.useEffect,Zr=()=>{const t=document.querySelector("head");return t||R(),t},oa=t=>{const e=document.createElement("style");return t&&e.setAttribute("nonce",t),e.type="text/css",e};function pp(t,e){const r=q(()=>fp(t),[t]),s=S.useRef(null),n=S.useRef(null),a=D(oe(u=>{const f=n.current;f||R(),f.textContent=u}),[]),i=D(u=>{const f=s.current;f||R(),f.textContent=u},[]);_e(()=>{!s.current&&!n.current||R();const u=oa(e),f=oa(e);return s.current=u,n.current=f,u.setAttribute(`${mt}-always`,t),f.setAttribute(`${mt}-dynamic`,t),Zr().appendChild(u),Zr().appendChild(f),i(r.always),a(r.resting),()=>{const p=g=>{const m=g.current;m||R(),Zr().removeChild(m),g.current=null};p(s),p(n)}},[e,i,a,r.always,r.resting,t]);const l=D(()=>a(r.dragging),[a,r.dragging]),c=D(u=>{if(u==="DROP"){a(r.dropAnimating);return}a(r.userCancel)},[a,r.dropAnimating,r.userCancel]),d=D(()=>{n.current&&a(r.resting)},[a,r.resting]);return q(()=>({dragging:l,dropping:c,resting:d}),[l,c,d])}function Pi(t,e){return Array.from(t.querySelectorAll(e))}var Di=t=>t&&t.ownerDocument&&t.ownerDocument.defaultView?t.ownerDocument.defaultView:window;function Rr(t){return t instanceof Di(t).HTMLElement}function gp(t,e){const r=`[${bt.contextId}="${t}"]`,s=Pi(document,r);if(!s.length)return null;const n=s.find(a=>a.getAttribute(bt.draggableId)===e);return!n||!Rr(n)?null:n}function mp(t){const e=S.useRef({}),r=S.useRef(null),s=S.useRef(null),n=S.useRef(!1),a=D(function(f,p){const g={id:f,focus:p};return e.current[f]=g,function(){const b=e.current;b[f]!==g&&delete b[f]}},[]),i=D(function(f){const p=gp(t,f);p&&p!==document.activeElement&&p.focus()},[t]),l=D(function(f,p){r.current===f&&(r.current=p)},[]),c=D(function(){s.current||n.current&&(s.current=requestAnimationFrame(()=>{s.current=null;const f=r.current;f&&i(f)}))},[i]),d=D(function(f){r.current=null;const p=document.activeElement;p&&p.getAttribute(bt.draggableId)===f&&(r.current=f)},[]);return _e(()=>(n.current=!0,function(){n.current=!1;const f=s.current;f&&cancelAnimationFrame(f)}),[]),q(()=>({register:a,tryRecordFocus:d,tryRestoreFocusRecorded:c,tryShiftRecord:l}),[a,d,c,l])}function bp(){const t={draggables:{},droppables:{}},e=[];function r(u){return e.push(u),function(){const p=e.indexOf(u);p!==-1&&e.splice(p,1)}}function s(u){e.length&&e.forEach(f=>f(u))}function n(u){return t.draggables[u]||null}function a(u){const f=n(u);return f||R(),f}const i={register:u=>{t.draggables[u.descriptor.id]=u,s({type:"ADDITION",value:u})},update:(u,f)=>{const p=t.draggables[f.descriptor.id];p&&p.uniqueId===u.uniqueId&&(delete t.draggables[f.descriptor.id],t.draggables[u.descriptor.id]=u)},unregister:u=>{const f=u.descriptor.id,p=n(f);p&&u.uniqueId===p.uniqueId&&(delete t.draggables[f],t.droppables[u.descriptor.droppableId]&&s({type:"REMOVAL",value:u}))},getById:a,findById:n,exists:u=>!!n(u),getAllByType:u=>Object.values(t.draggables).filter(f=>f.descriptor.type===u)};function l(u){return t.droppables[u]||null}function c(u){const f=l(u);return f||R(),f}const d={register:u=>{t.droppables[u.descriptor.id]=u},unregister:u=>{const f=l(u.descriptor.id);f&&u.uniqueId===f.uniqueId&&delete t.droppables[u.descriptor.id]},getById:c,findById:l,exists:u=>!!l(u),getAllByType:u=>Object.values(t.droppables).filter(f=>f.descriptor.type===u)};function h(){t.draggables={},t.droppables={},e.length=0}return{draggable:i,droppable:d,subscribe:r,clean:h}}function xp(){const t=q(bp,[]);return S.useEffect(()=>function(){t.clean()},[t]),t}var Ks=te.createContext(null),vr=()=>{const t=document.body;return t||R(),t};const vp={position:"absolute",width:"1px",height:"1px",margin:"-1px",border:"0",padding:"0",overflow:"hidden",clip:"rect(0 0 0 0)","clip-path":"inset(100%)"},yp=t=>`rfd-announcement-${t}`;function wp(t){const e=q(()=>yp(t),[t]),r=S.useRef(null);return S.useEffect(function(){const a=document.createElement("div");return r.current=a,a.id=e,a.setAttribute("aria-live","assertive"),a.setAttribute("aria-atomic","true"),gr(a.style,vp),vr().appendChild(a),function(){setTimeout(function(){const c=vr();c.contains(a)&&c.removeChild(a),a===r.current&&(r.current=null)})}},[e]),D(n=>{const a=r.current;if(a){a.textContent=n;return}},[])}const _p={separator:"::"};function Js(t,e=_p){const r=te.useId();return q(()=>`${t}${e.separator}${r}`,[e.separator,t,r])}function kp({contextId:t,uniqueId:e}){return`rfd-hidden-text-${t}-${e}`}function Sp({contextId:t,text:e}){const r=Js("hidden-text",{separator:"-"}),s=q(()=>kp({contextId:t,uniqueId:r}),[r,t]);return S.useEffect(function(){const a=document.createElement("div");return a.id=s,a.textContent=e,a.style.display="none",vr().appendChild(a),function(){const l=vr();l.contains(a)&&l.removeChild(a)}},[s,e]),s}var Ar=te.createContext(null);function $i(t){const e=S.useRef(t);return S.useEffect(()=>{e.current=t}),e}function Np(){let t=null;function e(){return!!t}function r(i){return i===t}function s(i){t&&R();const l={abandon:i};return t=l,l}function n(){t||R(),t=null}function a(){t&&(t.abandon(),n())}return{isClaimed:e,isActive:r,claim:s,release:n,tryAbandon:a}}function Vt(t){return t.phase==="IDLE"||t.phase==="DROP_ANIMATING"?!1:t.isDragging}const jp=9,Ep=13,Ys=27,Li=32,Cp=33,Rp=34,Ap=35,Ip=36,Op=37,Tp=38,Pp=39,Dp=40,$p={[Ep]:!0,[jp]:!0};var Bi=t=>{$p[t.keyCode]&&t.preventDefault()};const Ir=(()=>{const t="visibilitychange";return typeof document>"u"?t:[t,`ms${t}`,`webkit${t}`,`moz${t}`,`o${t}`].find(s=>`on${s}`in document)||t})(),Ui=0,la=5;function Lp(t,e){return Math.abs(e.x-t.x)>=la||Math.abs(e.y-t.y)>=la}const ca={type:"IDLE"};function Bp({cancel:t,completed:e,getPhase:r,setPhase:s}){return[{eventName:"mousemove",fn:n=>{const{button:a,clientX:i,clientY:l}=n;if(a!==Ui)return;const c={x:i,y:l},d=r();if(d.type==="DRAGGING"){n.preventDefault(),d.actions.move(c);return}d.type!=="PENDING"&&R();const h=d.point;if(!Lp(h,c))return;n.preventDefault();const u=d.actions.fluidLift(c);s({type:"DRAGGING",actions:u})}},{eventName:"mouseup",fn:n=>{const a=r();if(a.type!=="DRAGGING"){t();return}n.preventDefault(),a.actions.drop({shouldBlockNextClick:!0}),e()}},{eventName:"mousedown",fn:n=>{r().type==="DRAGGING"&&n.preventDefault(),t()}},{eventName:"keydown",fn:n=>{if(r().type==="PENDING"){t();return}if(n.keyCode===Ys){n.preventDefault(),t();return}Bi(n)}},{eventName:"resize",fn:t},{eventName:"scroll",options:{passive:!0,capture:!1},fn:()=>{r().type==="PENDING"&&t()}},{eventName:"webkitmouseforcedown",fn:n=>{const a=r();if(a.type==="IDLE"&&R(),a.actions.shouldRespectForcePress()){t();return}n.preventDefault()}},{eventName:Ir,fn:t}]}function Up(t){const e=S.useRef(ca),r=S.useRef(Fe),s=q(()=>({eventName:"mousedown",fn:function(u){if(u.defaultPrevented||u.button!==Ui||u.ctrlKey||u.metaKey||u.shiftKey||u.altKey)return;const f=t.findClosestDraggableId(u);if(!f)return;const p=t.tryGetLock(f,i,{sourceEvent:u});if(!p)return;u.preventDefault();const g={x:u.clientX,y:u.clientY};r.current(),d(p,g)}}),[t]),n=q(()=>({eventName:"webkitmouseforcewillbegin",fn:h=>{if(h.defaultPrevented)return;const u=t.findClosestDraggableId(h);if(!u)return;const f=t.findOptionsForDraggable(u);f&&(f.shouldRespectForcePress||t.canGetLock(u)&&h.preventDefault())}}),[t]),a=D(function(){const u={passive:!1,capture:!0};r.current=Ne(window,[n,s],u)},[n,s]),i=D(()=>{e.current.type!=="IDLE"&&(e.current=ca,r.current(),a())},[a]),l=D(()=>{const h=e.current;i(),h.type==="DRAGGING"&&h.actions.cancel({shouldBlockNextClick:!0}),h.type==="PENDING"&&h.actions.abort()},[i]),c=D(function(){const u={capture:!0,passive:!1},f=Bp({cancel:l,completed:i,getPhase:()=>e.current,setPhase:p=>{e.current=p}});r.current=Ne(window,f,u)},[l,i]),d=D(function(u,f){e.current.type!=="IDLE"&&R(),e.current={type:"PENDING",point:f,actions:u},c()},[c]);_e(function(){return a(),function(){r.current()}},[a])}function Mp(){}const Fp={[Rp]:!0,[Cp]:!0,[Ip]:!0,[Ap]:!0};function Wp(t,e){function r(){e(),t.cancel()}function s(){e(),t.drop()}return[{eventName:"keydown",fn:n=>{if(n.keyCode===Ys){n.preventDefault(),r();return}if(n.keyCode===Li){n.preventDefault(),s();return}if(n.keyCode===Dp){n.preventDefault(),t.moveDown();return}if(n.keyCode===Tp){n.preventDefault(),t.moveUp();return}if(n.keyCode===Pp){n.preventDefault(),t.moveRight();return}if(n.keyCode===Op){n.preventDefault(),t.moveLeft();return}if(Fp[n.keyCode]){n.preventDefault();return}Bi(n)}},{eventName:"mousedown",fn:r},{eventName:"mouseup",fn:r},{eventName:"click",fn:r},{eventName:"touchstart",fn:r},{eventName:"resize",fn:r},{eventName:"wheel",fn:r,options:{passive:!0}},{eventName:Ir,fn:r}]}function Gp(t){const e=S.useRef(Mp),r=q(()=>({eventName:"keydown",fn:function(a){if(a.defaultPrevented||a.keyCode!==Li)return;const i=t.findClosestDraggableId(a);if(!i)return;const l=t.tryGetLock(i,h,{sourceEvent:a});if(!l)return;a.preventDefault();let c=!0;const d=l.snapLift();e.current();function h(){c||R(),c=!1,e.current(),s()}e.current=Ne(window,Wp(d,h),{capture:!0,passive:!1})}}),[t]),s=D(function(){const a={passive:!1,capture:!0};e.current=Ne(window,[r],a)},[r]);_e(function(){return s(),function(){e.current()}},[s])}const es={type:"IDLE"},qp=120,Vp=.15;function zp({cancel:t,getPhase:e}){return[{eventName:"orientationchange",fn:t},{eventName:"resize",fn:t},{eventName:"contextmenu",fn:r=>{r.preventDefault()}},{eventName:"keydown",fn:r=>{if(e().type!=="DRAGGING"){t();return}r.keyCode===Ys&&r.preventDefault(),t()}},{eventName:Ir,fn:t}]}function Hp({cancel:t,completed:e,getPhase:r}){return[{eventName:"touchmove",options:{capture:!1},fn:s=>{const n=r();if(n.type!=="DRAGGING"){t();return}n.hasMoved=!0;const{clientX:a,clientY:i}=s.touches[0],l={x:a,y:i};s.preventDefault(),n.actions.move(l)}},{eventName:"touchend",fn:s=>{const n=r();if(n.type!=="DRAGGING"){t();return}s.preventDefault(),n.actions.drop({shouldBlockNextClick:!0}),e()}},{eventName:"touchcancel",fn:s=>{if(r().type!=="DRAGGING"){t();return}s.preventDefault(),t()}},{eventName:"touchforcechange",fn:s=>{const n=r();n.type==="IDLE"&&R();const a=s.touches[0];if(!a||!(a.force>=Vp))return;const l=n.actions.shouldRespectForcePress();if(n.type==="PENDING"){l&&t();return}if(l){if(n.hasMoved){s.preventDefault();return}t();return}s.preventDefault()}},{eventName:Ir,fn:t}]}function Kp(t){const e=S.useRef(es),r=S.useRef(Fe),s=D(function(){return e.current},[]),n=D(function(p){e.current=p},[]),a=q(()=>({eventName:"touchstart",fn:function(p){if(p.defaultPrevented)return;const g=t.findClosestDraggableId(p);if(!g)return;const m=t.tryGetLock(g,l,{sourceEvent:p});if(!m)return;const b=p.touches[0],{clientX:x,clientY:w}=b,v={x,y:w};r.current(),u(m,v)}}),[t]),i=D(function(){const p={capture:!0,passive:!1};r.current=Ne(window,[a],p)},[a]),l=D(()=>{const f=e.current;f.type!=="IDLE"&&(f.type==="PENDING"&&clearTimeout(f.longPressTimerId),n(es),r.current(),i())},[i,n]),c=D(()=>{const f=e.current;l(),f.type==="DRAGGING"&&f.actions.cancel({shouldBlockNextClick:!0}),f.type==="PENDING"&&f.actions.abort()},[l]),d=D(function(){const p={capture:!0,passive:!1},g={cancel:c,completed:l,getPhase:s},m=Ne(window,Hp(g),p),b=Ne(window,zp(g),p);r.current=function(){m(),b()}},[c,s,l]),h=D(function(){const p=s();p.type!=="PENDING"&&R();const g=p.actions.fluidLift(p.point);n({type:"DRAGGING",actions:g,hasMoved:!1})},[s,n]),u=D(function(p,g){s().type!=="IDLE"&&R();const m=setTimeout(h,qp);n({type:"PENDING",point:g,actions:p,longPressTimerId:m}),d()},[d,s,n,h]);_e(function(){return i(),function(){r.current();const g=s();g.type==="PENDING"&&(clearTimeout(g.longPressTimerId),n(es))}},[s,i,n]),_e(function(){return Ne(window,[{eventName:"touchmove",fn:()=>{},options:{capture:!1,passive:!1}}])},[])}const Jp=["input","button","textarea","select","option","optgroup","video","audio"];function Mi(t,e){if(e==null)return!1;if(Jp.includes(e.tagName.toLowerCase()))return!0;const s=e.getAttribute("contenteditable");return s==="true"||s===""?!0:e===t?!1:Mi(t,e.parentElement)}function Yp(t,e){const r=e.target;return Rr(r)?Mi(t,r):!1}var Xp=t=>Oe(t.getBoundingClientRect()).center;function Qp(t){return t instanceof Di(t).Element}const Zp=(()=>{const t="matches";return typeof document>"u"?t:[t,"msMatchesSelector","webkitMatchesSelector"].find(s=>s in Element.prototype)||t})();function Fi(t,e){return t==null?null:t[Zp](e)?t:Fi(t.parentElement,e)}function e0(t,e){return t.closest?t.closest(e):Fi(t,e)}function t0(t){return`[${bt.contextId}="${t}"]`}function r0(t,e){const r=e.target;if(!Qp(r))return null;const s=t0(t),n=e0(r,s);return!n||!Rr(n)?null:n}function s0(t,e){const r=r0(t,e);return r?r.getAttribute(bt.draggableId):null}function n0(t,e){const r=`[${ws.contextId}="${t}"]`,n=Pi(document,r).find(a=>a.getAttribute(ws.id)===e);return!n||!Rr(n)?null:n}function a0(t){t.preventDefault()}function sr({expected:t,phase:e,isLockActive:r,shouldWarn:s}){return!(!r()||t!==e)}function Wi({lockAPI:t,store:e,registry:r,draggableId:s}){if(t.isClaimed())return!1;const n=r.draggable.findById(s);return!(!n||!n.options.isEnabled||!Ai(e.getState(),s))}function i0({lockAPI:t,contextId:e,store:r,registry:s,draggableId:n,forceSensorStop:a,sourceEvent:i}){if(!Wi({lockAPI:t,store:r,registry:s,draggableId:n}))return null;const c=s.draggable.getById(n),d=n0(e,c.descriptor.id);if(!d||i&&!c.options.canDragInteractiveElements&&Yp(d,i))return null;const h=t.claim(a||Fe);let u="PRE_DRAG";function f(){return c.options.shouldRespectForcePress}function p(){return t.isActive(h)}function g(N,y){sr({expected:N,phase:u,isLockActive:p,shouldWarn:!0})&&r.dispatch(y())}const m=g.bind(null,"DRAGGING");function b(N){function y(){t.release(),u="COMPLETED"}u!=="PRE_DRAG"&&(y(),R()),r.dispatch(Zh(N.liftActionArgs)),u="DRAGGING";function k(C,T={shouldBlockNextClick:!1}){if(N.cleanup(),T.shouldBlockNextClick){const j=Ne(window,[{eventName:"click",fn:a0,options:{once:!0,passive:!1,capture:!0}}]);setTimeout(j)}y(),r.dispatch(_i({reason:C}))}return{isActive:()=>sr({expected:"DRAGGING",phase:u,isLockActive:p,shouldWarn:!1}),shouldRespectForcePress:f,drop:C=>k("DROP",C),cancel:C=>k("CANCEL",C),...N.actions}}function x(N){const y=Ut(C=>{m(()=>wi({client:C}))});return{...b({liftActionArgs:{id:n,clientSelection:N,movementMode:"FLUID"},cleanup:()=>y.cancel(),actions:{move:y}}),move:y}}function w(){const N={moveUp:()=>m(cf),moveRight:()=>m(uf),moveDown:()=>m(df),moveLeft:()=>m(hf)};return b({liftActionArgs:{id:n,clientSelection:Xp(d),movementMode:"SNAP"},cleanup:Fe,actions:N})}function v(){sr({expected:"PRE_DRAG",phase:u,isLockActive:p,shouldWarn:!0})&&t.release()}return{isActive:()=>sr({expected:"PRE_DRAG",phase:u,isLockActive:p,shouldWarn:!1}),shouldRespectForcePress:f,fluidLift:x,snapLift:w,abort:v}}const o0=[Up,Gp,Kp];function l0({contextId:t,store:e,registry:r,customSensors:s,enableDefaultSensors:n}){const a=[...n?o0:[],...s||[]],i=S.useState(()=>Np())[0],l=D(function(b,x){Vt(b)&&!Vt(x)&&i.tryAbandon()},[i]);_e(function(){let b=e.getState();return e.subscribe(()=>{const w=e.getState();l(b,w),b=w})},[i,e,l]),_e(()=>i.tryAbandon,[i.tryAbandon]);const c=D(m=>Wi({lockAPI:i,registry:r,store:e,draggableId:m}),[i,r,e]),d=D((m,b,x)=>i0({lockAPI:i,registry:r,contextId:t,store:e,draggableId:m,forceSensorStop:b||null,sourceEvent:x&&x.sourceEvent?x.sourceEvent:null}),[t,i,r,e]),h=D(m=>s0(t,m),[t]),u=D(m=>{const b=r.draggable.findById(m);return b?b.options:null},[r.draggable]),f=D(function(){i.isClaimed()&&(i.tryAbandon(),e.getState().phase!=="IDLE"&&e.dispatch(Fs()))},[i,e]),p=D(()=>i.isClaimed(),[i]),g=q(()=>({canGetLock:c,tryGetLock:d,findClosestDraggableId:h,findOptionsForDraggable:u,tryReleaseLock:f,isLockClaimed:p}),[c,d,h,u,f,p]);for(let m=0;m<a.length;m++)a[m](g)}const c0=t=>({onBeforeCapture:e=>{const r=()=>{t.onBeforeCapture&&t.onBeforeCapture(e)};va.flushSync(r)},onBeforeDragStart:t.onBeforeDragStart,onDragStart:t.onDragStart,onDragEnd:t.onDragEnd,onDragUpdate:t.onDragUpdate}),d0=t=>({...qt,...t.autoScrollerOptions,durationDampening:{...qt.durationDampening,...t.autoScrollerOptions}});function St(t){return t.current||R(),t.current}function u0(t){const{contextId:e,setCallbacks:r,sensors:s,nonce:n,dragHandleUsageInstructions:a}=t,i=S.useRef(null),l=$i(t),c=D(()=>c0(l.current),[l]),d=D(()=>d0(l.current),[l]),h=wp(e),u=Sp({contextId:e,text:a}),f=pp(e,n),p=D(j=>{St(i).dispatch(j)},[]),g=q(()=>Dn({publishWhileDragging:tf,updateDroppableScroll:sf,updateDroppableIsEnabled:nf,updateDroppableIsCombineEnabled:af,collectionStarting:rf},p),[p]),m=xp(),b=q(()=>zf(m,g),[m,g]),x=q(()=>cp({scrollWindow:Hf,scrollDroppable:b.scrollDroppable,getAutoScrollerOptions:d,...Dn({move:wi},p)}),[b.scrollDroppable,p,d]),w=mp(e),v=q(()=>Wf({announce:h,autoScroller:x,dimensionMarshal:b,focusMarshal:w,getResponders:c,styleMarshal:f}),[h,x,b,w,c,f]);i.current=v;const _=D(()=>{const j=St(i);j.getState().phase!=="IDLE"&&j.dispatch(Fs())},[]),N=D(()=>{const j=St(i).getState();return j.phase==="DROP_ANIMATING"?!0:j.phase==="IDLE"?!1:j.isDragging},[]),y=q(()=>({isDragging:N,tryAbort:_}),[N,_]);r(y);const k=D(j=>Ai(St(i).getState(),j),[]),C=D(()=>Je(St(i).getState()),[]),T=q(()=>({marshal:b,focus:w,contextId:e,canLift:k,isMovementAllowed:C,dragHandleUsageInstructionsId:u,registry:m}),[e,b,u,w,k,C,m]);return l0({contextId:e,store:v,registry:m,customSensors:s||null,enableDefaultSensors:t.enableDefaultSensors!==!1}),S.useEffect(()=>_,[_]),te.createElement(Ar.Provider,{value:T},te.createElement(Du,{context:Ks,store:v},t.children))}function h0(){return te.useId()}function Or(t){const e=h0(),r=t.dragHandleUsageInstructions||or.dragHandleUsageInstructions;return te.createElement(Wu,null,s=>te.createElement(u0,{nonce:t.nonce,contextId:e,setCallbacks:s,dragHandleUsageInstructions:r,enableDefaultSensors:t.enableDefaultSensors,sensors:t.sensors,onBeforeCapture:t.onBeforeCapture,onBeforeDragStart:t.onBeforeDragStart,onDragStart:t.onDragStart,onDragUpdate:t.onDragUpdate,onDragEnd:t.onDragEnd,autoScrollerOptions:t.autoScrollerOptions},t.children))}const da={dragging:5e3,dropAnimating:4500},f0=(t,e)=>e?Ot.drop(e.duration):t?Ot.snap:Ot.fluid,p0=(t,e)=>{if(t)return e?Gt.opacity.drop:Gt.opacity.combining},g0=t=>t.forceShouldAnimate!=null?t.forceShouldAnimate:t.mode==="SNAP";function m0(t){const r=t.dimension.client,{offset:s,combineWith:n,dropping:a}=t,i=!!n,l=g0(t),c=!!a,d=c?vs.drop(s,i):vs.moveTo(s);return{position:"fixed",top:r.marginBox.top,left:r.marginBox.left,boxSizing:"border-box",width:r.borderBox.width,height:r.borderBox.height,transition:f0(l,a),transform:d,opacity:p0(i,c),zIndex:c?da.dropAnimating:da.dragging,pointerEvents:"none"}}function b0(t){return{transform:vs.moveTo(t.offset),transition:t.shouldAnimateDisplacement?void 0:"none"}}function x0(t){return t.type==="DRAGGING"?m0(t):b0(t)}function v0(t,e,r=le){const s=window.getComputedStyle(e),n=e.getBoundingClientRect(),a=Ja(n,s),i=pr(a,r),l={client:a,tagName:e.tagName.toLowerCase(),display:s.display},c={x:a.marginBox.width,y:a.marginBox.height};return{descriptor:t,placeholder:l,displaceBy:c,client:a,page:i}}function y0(t){const e=Js("draggable"),{descriptor:r,registry:s,getDraggableRef:n,canDragInteractiveElements:a,shouldRespectForcePress:i,isEnabled:l}=t,c=q(()=>({canDragInteractiveElements:a,shouldRespectForcePress:i,isEnabled:l}),[a,l,i]),d=D(p=>{const g=n();return g||R(),v0(r,g,p)},[r,n]),h=q(()=>({uniqueId:e,descriptor:r,options:c,getDimension:d}),[r,d,c,e]),u=S.useRef(h),f=S.useRef(!0);_e(()=>(s.draggable.register(u.current),()=>s.draggable.unregister(u.current)),[s.draggable]),_e(()=>{if(f.current){f.current=!1;return}const p=u.current;u.current=h,s.draggable.update(h,p)},[h,s.draggable])}var Xs=te.createContext(null);function yr(t){const e=S.useContext(t);return e||R(),e}function w0(t){t.preventDefault()}const _0=t=>{const e=S.useRef(null),r=D((y=null)=>{e.current=y},[]),s=D(()=>e.current,[]),{contextId:n,dragHandleUsageInstructionsId:a,registry:i}=yr(Ar),{type:l,droppableId:c}=yr(Xs),d=q(()=>({id:t.draggableId,index:t.index,type:l,droppableId:c}),[t.draggableId,t.index,l,c]),{children:h,draggableId:u,isEnabled:f,shouldRespectForcePress:p,canDragInteractiveElements:g,isClone:m,mapped:b,dropAnimationFinished:x}=t;if(!m){const y=q(()=>({descriptor:d,registry:i,getDraggableRef:s,canDragInteractiveElements:g,shouldRespectForcePress:p,isEnabled:f}),[d,i,s,g,p,f]);y0(y)}const w=q(()=>f?{tabIndex:0,role:"button","aria-describedby":a,"data-rfd-drag-handle-draggable-id":u,"data-rfd-drag-handle-context-id":n,draggable:!1,onDragStart:w0}:null,[n,a,u,f]),v=D(y=>{b.type==="DRAGGING"&&b.dropping&&y.propertyName==="transform"&&va.flushSync(x)},[x,b]),_=q(()=>{const y=x0(b),k=b.type==="DRAGGING"&&b.dropping?v:void 0;return{innerRef:r,draggableProps:{"data-rfd-draggable-context-id":n,"data-rfd-draggable-id":u,style:y,onTransitionEnd:k},dragHandleProps:w}},[n,w,u,b,v,r]),N=q(()=>({draggableId:d.id,type:d.type,source:{index:d.index,droppableId:d.droppableId}}),[d.droppableId,d.id,d.index,d.type]);return te.createElement(te.Fragment,null,h(_,b.snapshot,N))};var Gi=(t,e)=>t===e,qi=t=>{const{combine:e,destination:r}=t;return r?r.droppableId:e?e.droppableId:null};const k0=t=>t.combine?t.combine.draggableId:null,S0=t=>t.at&&t.at.type==="COMBINE"?t.at.combine.draggableId:null;function N0(){const t=oe((n,a)=>({x:n,y:a})),e=oe((n,a,i=null,l=null,c=null)=>({isDragging:!0,isClone:a,isDropAnimating:!!c,dropAnimation:c,mode:n,draggingOver:i,combineWith:l,combineTargetFor:null})),r=oe((n,a,i,l,c=null,d=null,h=null)=>({mapped:{type:"DRAGGING",dropping:null,draggingOver:c,combineWith:d,mode:a,offset:n,dimension:i,forceShouldAnimate:h,snapshot:e(a,l,c,d,null)}}));return(n,a)=>{if(Vt(n)){if(n.critical.draggable.id!==a.draggableId)return null;const i=n.current.client.offset,l=n.dimensions.draggables[a.draggableId],c=we(n.impact),d=S0(n.impact),h=n.forceShouldAnimate;return r(t(i.x,i.y),n.movementMode,l,a.isClone,c,d,h)}if(n.phase==="DROP_ANIMATING"){const i=n.completed;if(i.result.draggableId!==a.draggableId)return null;const l=a.isClone,c=n.dimensions.draggables[a.draggableId],d=i.result,h=d.mode,u=qi(d),f=k0(d),g={duration:n.dropDuration,curve:Gs.drop,moveTo:n.newHomeClientOffset,opacity:f?Gt.opacity.drop:null,scale:f?Gt.scale.drop:null};return{mapped:{type:"DRAGGING",offset:n.newHomeClientOffset,dimension:c,dropping:g,draggingOver:u,combineWith:f,mode:h,forceShouldAnimate:null,snapshot:e(h,l,u,f,g)}}}return null}}function Vi(t=null){return{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,mode:null,draggingOver:null,combineTargetFor:t,combineWith:null}}const j0={mapped:{type:"SECONDARY",offset:le,combineTargetFor:null,shouldAnimateDisplacement:!0,snapshot:Vi(null)}};function E0(){const t=oe((i,l)=>({x:i,y:l})),e=oe(Vi),r=oe((i,l=null,c)=>({mapped:{type:"SECONDARY",offset:i,combineTargetFor:l,shouldAnimateDisplacement:c,snapshot:e(l)}})),s=i=>i?r(le,i,!0):null,n=(i,l,c,d)=>{const h=c.displaced.visible[i],u=!!(d.inVirtualList&&d.effected[i]),f=jr(c),p=f&&f.draggableId===i?l:null;if(!h){if(!u)return s(p);if(c.displaced.invisible[i])return null;const b=xt(d.displacedBy.point),x=t(b.x,b.y);return r(x,p,!0)}if(u)return s(p);const g=c.displacedBy.point,m=t(g.x,g.y);return r(m,p,h.shouldAnimate)};return(i,l)=>{if(Vt(i))return i.critical.draggable.id===l.draggableId?null:n(l.draggableId,i.critical.draggable.id,i.impact,i.afterCritical);if(i.phase==="DROP_ANIMATING"){const c=i.completed;return c.result.draggableId===l.draggableId?null:n(l.draggableId,c.result.draggableId,c.impact,c.afterCritical)}return null}}const C0=()=>{const t=N0(),e=E0();return(s,n)=>t(s,n)||e(s,n)||j0},R0={dropAnimationFinished:ki},A0=Ka(C0,R0,null,{context:Ks,areStatePropsEqual:Gi})(_0);function zi(t){return yr(Xs).isUsingCloneFor===t.draggableId&&!t.isClone?null:te.createElement(A0,t)}function Tr(t){const e=typeof t.isDragDisabled=="boolean"?!t.isDragDisabled:!0,r=!!t.disableInteractiveElementBlocking,s=!!t.shouldRespectForcePress;return te.createElement(zi,gr({},t,{isClone:!1,isEnabled:e,canDragInteractiveElements:r,shouldRespectForcePress:s}))}const Hi=t=>e=>t===e,I0=Hi("scroll"),O0=Hi("auto"),ua=(t,e)=>e(t.overflowX)||e(t.overflowY),T0=t=>{const e=window.getComputedStyle(t),r={overflowX:e.overflowX,overflowY:e.overflowY};return ua(r,I0)||ua(r,O0)},P0=()=>!1,Ki=t=>t==null?null:t===document.body?P0()?t:null:t===document.documentElement?null:T0(t)?t:Ki(t.parentElement);var _s=t=>({x:t.scrollLeft,y:t.scrollTop});const Ji=t=>t?window.getComputedStyle(t).position==="fixed"?!0:Ji(t.parentElement):!1;var D0=t=>{const e=Ki(t),r=Ji(t);return{closestScrollable:e,isFixedOnPage:r}},$0=({descriptor:t,isEnabled:e,isCombineEnabled:r,isFixedOnPage:s,direction:n,client:a,page:i,closest:l})=>{const c=(()=>{if(!l)return null;const{scrollSize:f,client:p}=l,g=Ei({scrollHeight:f.scrollHeight,scrollWidth:f.scrollWidth,height:p.paddingBox.height,width:p.paddingBox.width});return{pageMarginBox:l.page.marginBox,frameClient:p,scrollSize:f,shouldClipSubject:l.shouldClipSubject,scroll:{initial:l.scroll,current:l.scroll,max:g,diff:{value:le,displacement:le}}}})(),d=n==="vertical"?$s:ii,h=gt({page:i,withPlaceholder:null,axis:d,frame:c});return{descriptor:t,isCombineEnabled:r,isFixedOnPage:s,axis:d,isEnabled:e,client:a,page:i,frame:c,subject:h}};const L0=(t,e)=>{const r=Ya(t);if(!e||t!==e)return r;const s=r.paddingBox.top-e.scrollTop,n=r.paddingBox.left-e.scrollLeft,a=s+e.scrollHeight,i=n+e.scrollWidth,c=Os({top:s,right:i,bottom:a,left:n},r.border);return Ts({borderBox:c,margin:r.margin,border:r.border,padding:r.padding})};var B0=({ref:t,descriptor:e,env:r,windowScroll:s,direction:n,isDropDisabled:a,isCombineEnabled:i,shouldClipSubject:l})=>{const c=r.closestScrollable,d=L0(t,c),h=pr(d,s),u=(()=>{if(!c)return null;const p=Ya(c),g={scrollHeight:c.scrollHeight,scrollWidth:c.scrollWidth};return{client:p,page:pr(p,s),scroll:_s(c),scrollSize:g,shouldClipSubject:l}})();return $0({descriptor:e,isEnabled:!a,isCombineEnabled:i,isFixedOnPage:r.isFixedOnPage,direction:n,client:d,page:h,closest:u})};const U0={passive:!1},M0={passive:!0};var ha=t=>t.shouldPublishImmediately?U0:M0;const nr=t=>t&&t.env.closestScrollable||null;function F0(t){const e=S.useRef(null),r=yr(Ar),s=Js("droppable"),{registry:n,marshal:a}=r,i=$i(t),l=q(()=>({id:t.droppableId,type:t.type,mode:t.mode}),[t.droppableId,t.mode,t.type]),c=S.useRef(l),d=q(()=>oe((_,N)=>{e.current||R();const y={x:_,y:N};a.updateDroppableScroll(l.id,y)}),[l.id,a]),h=D(()=>{const _=e.current;return!_||!_.env.closestScrollable?le:_s(_.env.closestScrollable)},[]),u=D(()=>{const _=h();d(_.x,_.y)},[h,d]),f=q(()=>Ut(u),[u]),p=D(()=>{const _=e.current,N=nr(_);if(_&&N||R(),_.scrollOptions.shouldPublishImmediately){u();return}f()},[f,u]),g=D((_,N)=>{e.current&&R();const y=i.current,k=y.getDroppableRef();k||R();const C=D0(k),T={ref:k,descriptor:l,env:C,scrollOptions:N};e.current=T;const j=B0({ref:k,descriptor:l,env:C,windowScroll:_,direction:y.direction,isDropDisabled:y.isDropDisabled,isCombineEnabled:y.isCombineEnabled,shouldClipSubject:!y.ignoreContainerClipping}),O=C.closestScrollable;return O&&(O.setAttribute(ia.contextId,r.contextId),O.addEventListener("scroll",p,ha(T.scrollOptions))),j},[r.contextId,l,p,i]),m=D(()=>{const _=e.current,N=nr(_);return _&&N||R(),_s(N)},[]),b=D(()=>{const _=e.current;_||R();const N=nr(_);e.current=null,N&&(f.cancel(),N.removeAttribute(ia.contextId),N.removeEventListener("scroll",p,ha(_.scrollOptions)))},[p,f]),x=D(_=>{const N=e.current;N||R();const y=nr(N);y||R(),y.scrollTop+=_.y,y.scrollLeft+=_.x},[]),w=q(()=>({getDimensionAndWatchScroll:g,getScrollWhileDragging:m,dragStopped:b,scroll:x}),[b,g,m,x]),v=q(()=>({uniqueId:s,descriptor:l,callbacks:w}),[w,l,s]);_e(()=>(c.current=v.descriptor,n.droppable.register(v),()=>{e.current&&b(),n.droppable.unregister(v)}),[w,l,b,v,a,n.droppable]),_e(()=>{e.current&&a.updateDroppableIsEnabled(c.current.id,!t.isDropDisabled)},[t.isDropDisabled,a]),_e(()=>{e.current&&a.updateDroppableIsCombineEnabled(c.current.id,t.isCombineEnabled)},[t.isCombineEnabled,a])}function ts(){}const fa={width:0,height:0,margin:Ju},W0=({isAnimatingOpenOnMount:t,placeholder:e,animate:r})=>t||r==="close"?fa:{height:e.client.borderBox.height,width:e.client.borderBox.width,margin:e.client.margin},G0=({isAnimatingOpenOnMount:t,placeholder:e,animate:r})=>{const s=W0({isAnimatingOpenOnMount:t,placeholder:e,animate:r});return{display:e.display,boxSizing:"border-box",width:s.width,height:s.height,marginTop:s.margin.top,marginRight:s.margin.right,marginBottom:s.margin.bottom,marginLeft:s.margin.left,flexShrink:"0",flexGrow:"0",pointerEvents:"none",transition:r!=="none"?Ot.placeholder:null}},q0=t=>{const e=S.useRef(null),r=D(()=>{e.current&&(clearTimeout(e.current),e.current=null)},[]),{animate:s,onTransitionEnd:n,onClose:a,contextId:i}=t,[l,c]=S.useState(t.animate==="open");S.useEffect(()=>l?s!=="open"?(r(),c(!1),ts):e.current?ts:(e.current=setTimeout(()=>{e.current=null,c(!1)}),r):ts,[s,l,r]);const d=D(u=>{u.propertyName==="height"&&(n(),s==="close"&&a())},[s,a,n]),h=G0({isAnimatingOpenOnMount:l,animate:t.animate,placeholder:t.placeholder});return te.createElement(t.placeholder.tagName,{style:h,"data-rfd-placeholder-context-id":i,onTransitionEnd:d,ref:t.innerRef})};var V0=te.memo(q0);class z0 extends te.PureComponent{constructor(...e){super(...e),this.state={isVisible:!!this.props.on,data:this.props.on,animate:this.props.shouldAnimate&&this.props.on?"open":"none"},this.onClose=()=>{this.state.animate==="close"&&this.setState({isVisible:!1})}}static getDerivedStateFromProps(e,r){return e.shouldAnimate?e.on?{isVisible:!0,data:e.on,animate:"open"}:r.isVisible?{isVisible:!0,data:r.data,animate:"close"}:{isVisible:!1,animate:"close",data:null}:{isVisible:!!e.on,data:e.on,animate:"none"}}render(){if(!this.state.isVisible)return null;const e={onClose:this.onClose,data:this.state.data,animate:this.state.animate};return this.props.children(e)}}const H0=t=>{const e=S.useContext(Ar);e||R();const{contextId:r,isMovementAllowed:s}=e,n=S.useRef(null),a=S.useRef(null),{children:i,droppableId:l,type:c,mode:d,direction:h,ignoreContainerClipping:u,isDropDisabled:f,isCombineEnabled:p,snapshot:g,useClone:m,updateViewportMaxScroll:b,getContainerForClone:x}=t,w=D(()=>n.current,[]),v=D((O=null)=>{n.current=O},[]);D(()=>a.current,[]);const _=D((O=null)=>{a.current=O},[]),N=D(()=>{s()&&b({maxScroll:Ri()})},[s,b]);F0({droppableId:l,type:c,mode:d,direction:h,isDropDisabled:f,isCombineEnabled:p,ignoreContainerClipping:u,getDroppableRef:w});const y=q(()=>te.createElement(z0,{on:t.placeholder,shouldAnimate:t.shouldAnimatePlaceholder},({onClose:O,data:A,animate:I})=>te.createElement(V0,{placeholder:A,onClose:O,innerRef:_,animate:I,contextId:r,onTransitionEnd:N})),[r,N,t.placeholder,t.shouldAnimatePlaceholder,_]),k=q(()=>({innerRef:v,placeholder:y,droppableProps:{"data-rfd-droppable-id":l,"data-rfd-droppable-context-id":r}}),[r,l,y,v]),C=m?m.dragging.draggableId:null,T=q(()=>({droppableId:l,type:c,isUsingCloneFor:C}),[l,C,c]);function j(){if(!m)return null;const{dragging:O,render:A}=m,I=te.createElement(zi,{draggableId:O.draggableId,index:O.source.index,isClone:!0,isEnabled:!0,shouldRespectForcePress:!1,canDragInteractiveElements:!0},(X,M)=>A(X,M,O));return oo.createPortal(I,x())}return te.createElement(Xs.Provider,{value:T},i(k,g),j())};function K0(){return document.body||R(),document.body}const pa={mode:"standard",type:"DEFAULT",direction:"vertical",isDropDisabled:!1,isCombineEnabled:!1,ignoreContainerClipping:!1,renderClone:null,getContainerForClone:K0},Yi=t=>{let e={...t},r;for(r in pa)t[r]===void 0&&(e={...e,[r]:pa[r]});return e},rs=(t,e)=>t===e.droppable.type,ga=(t,e)=>e.draggables[t.draggable.id],J0=()=>{const t={placeholder:null,shouldAnimatePlaceholder:!0,snapshot:{isDraggingOver:!1,draggingOverWith:null,draggingFromThisWith:null,isUsingPlaceholder:!1},useClone:null},e={...t,shouldAnimatePlaceholder:!1},r=oe(a=>({draggableId:a.id,type:a.type,source:{index:a.index,droppableId:a.droppableId}})),s=oe((a,i,l,c,d,h)=>{const u=d.descriptor.id;if(d.descriptor.droppableId===a){const g=h?{render:h,dragging:r(d.descriptor)}:null,m={isDraggingOver:l,draggingOverWith:l?u:null,draggingFromThisWith:u,isUsingPlaceholder:!0};return{placeholder:d.placeholder,shouldAnimatePlaceholder:!1,snapshot:m,useClone:g}}if(!i)return e;if(!c)return t;const p={isDraggingOver:l,draggingOverWith:u,draggingFromThisWith:null,isUsingPlaceholder:!0};return{placeholder:d.placeholder,shouldAnimatePlaceholder:!0,snapshot:p,useClone:null}});return(a,i)=>{const l=Yi(i),c=l.droppableId,d=l.type,h=!l.isDropDisabled,u=l.renderClone;if(Vt(a)){const f=a.critical;if(!rs(d,f))return e;const p=ga(f,a.dimensions),g=we(a.impact)===c;return s(c,h,g,g,p,u)}if(a.phase==="DROP_ANIMATING"){const f=a.completed;if(!rs(d,f.critical))return e;const p=ga(f.critical,a.dimensions);return s(c,h,qi(f.result)===c,we(f.impact)===c,p,u)}if(a.phase==="IDLE"&&a.completed&&!a.shouldFlush){const f=a.completed;if(!rs(d,f.critical))return e;const p=we(f.impact)===c,g=!!(f.impact.at&&f.impact.at.type==="COMBINE"),m=f.critical.droppable.id===c;return p?g?t:e:m?t:e}return e}},Y0={updateViewportMaxScroll:lf},Pr=Ka(J0,Y0,(t,e,r)=>({...Yi(r),...t,...e}),{context:Ks,areStatePropsEqual:Gi})(H0),X0=({isOpen:t,onClose:e,firms:r,setFirms:s,accountSizes:n,setAccountSizes:a,accountStages:i,setAccountStages:l,accountTypes:c,setAccountTypes:d,accountStatuses:h,setAccountStatuses:u})=>{const[f,p]=S.useState("firms");return t?o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[o.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),o.jsxs("div",{className:"relative w-full max-w-7xl h-[700px] bg-[#0e0e11] border border-white/[0.08] rounded-3xl shadow-2xl overflow-hidden flex flex-col md:flex-row",children:[o.jsxs("div",{className:"w-full md:w-64 border-b md:border-b-0 md:border-r border-white/[0.06] bg-white/[0.02] p-6 flex flex-col gap-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-6 px-2",children:[o.jsx(Ss,{className:"w-5 h-5 text-indigo-500"}),o.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:""})]}),o.jsx(Nt,{label:"",icon:o.jsx(fo,{size:18}),active:f==="firms",onClick:()=>p("firms")}),o.jsx(Nt,{label:"",icon:o.jsx($o,{size:18}),active:f==="sizes",onClick:()=>p("sizes")}),o.jsx(Nt,{label:"",icon:o.jsx(on,{size:18}),active:f==="stages",onClick:()=>p("stages")}),o.jsx(Nt,{label:"",icon:o.jsx(on,{size:18}),active:f==="types",onClick:()=>p("types")}),o.jsx(Nt,{label:"",icon:o.jsx(jo,{size:18}),active:f==="statuses",onClick:()=>p("statuses")}),o.jsx("div",{className:"mt-auto pt-6 border-t border-white/[0.06]",children:o.jsxs("button",{onClick:e,className:"flex items-center gap-3 w-full px-4 py-3 rounded-xl text-slate-400 hover:text-white hover:bg-white/[0.05] transition-all text-sm font-medium",children:[o.jsx(bo,{className:"w-4 h-4 rotate-180"})," "]})})]}),o.jsxs("div",{className:"flex-1 p-8 overflow-y-auto custom-scrollbar",children:[f==="firms"&&o.jsx(Q0,{firms:r,setFirms:s}),f==="sizes"&&o.jsx(ma,{title:"",items:n,setItems:a,placeholder:" (: 250K)..."}),f==="stages"&&o.jsx(ma,{title:"",items:i,setItems:l,placeholder:" (: 1)..."}),f==="types"&&o.jsx(Z0,{accountTypes:c,setAccountTypes:d}),f==="statuses"&&o.jsx(eg,{items:h,setItems:u})]})]})]}):null},Nt=({label:t,icon:e,active:r,onClick:s})=>o.jsxs("button",{onClick:s,className:`flex items-center gap-3 w-full px-4 py-3 rounded-xl transition-all text-sm font-medium ${r?"bg-indigo-600/10 text-indigo-400":"text-slate-400 hover:text-white hover:bg-white/[0.05]"}`,children:[e,t]}),Q0=({firms:t,setFirms:e})=>{const[r,s]=S.useState(""),[n,a]=S.useState(""),[i,l]=S.useState(null),[c,d]=S.useState(""),h=b=>{b.preventDefault(),r.trim()&&(t.some(x=>x.name===r.trim())?ue.error(""):(e([...t,{name:r.trim(),type:n}]),s("")))},u=b=>{confirm(` ${b} `)&&e(t.filter(x=>x.name!==b))},f=b=>{l(b),d(b)},p=b=>{c.trim()&&c!==b&&e(t.map(x=>x.name===b?{...x,name:c.trim()}:x)),l(null)},g=t.filter(b=>b.type===n),m=b=>{if(!b.destination)return;const x=Array.from(g),[w]=x.splice(b.source.index,1);x.splice(b.destination.index,0,w);const v=t.filter(_=>_.type!==n);e([...v,...x])};return o.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h2",{className:"text-xl font-bold text-white",children:""}),o.jsx("div",{className:"flex bg-white/[0.03] p-1 rounded-lg border border-white/[0.05]",children:["","CFD"].map(b=>o.jsx("button",{onClick:()=>a(b),className:`px-4 py-1.5 text-xs font-bold rounded-md transition-all ${n===b?"bg-indigo-600 text-white shadow-lg":"text-slate-400 hover:text-white"}`,children:b},b))})]}),o.jsxs("form",{onSubmit:h,className:"flex gap-2",children:[o.jsx("input",{type:"text",placeholder:` ${n} ...`,value:r,onChange:b=>s(b.target.value),className:"flex-1 bg-[#18181b] border border-white/[0.08] rounded-xl px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-indigo-500/50"}),o.jsx("button",{type:"submit",className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-3 rounded-xl font-bold text-sm transition-all whitespace-nowrap",children:""})]}),o.jsx(Or,{onDragEnd:m,children:o.jsx(Pr,{droppableId:"firms-list",children:b=>o.jsxs("div",{className:"space-y-2",...b.droppableProps,ref:b.innerRef,children:[g.map((x,w)=>o.jsx(Tr,{draggableId:`${x.type}-${x.name}`,index:w,children:v=>o.jsx("div",{ref:v.innerRef,...v.draggableProps,children:o.jsx(Xi,{text:x.name,onDelete:()=>u(x.name),isEditing:i===x.name,editValue:c,setEditValue:d,onEditStart:()=>f(x.name),onEditSave:()=>p(x.name),dragHandleProps:v.dragHandleProps})})},`${x.type}-${x.name}-${w}`)),b.placeholder,g.length===0&&o.jsx("p",{className:"text-center text-slate-500 text-sm py-8 border border-dashed border-white/[0.1] rounded-xl",children:""})]})})})]})},Z0=({accountTypes:t,setAccountTypes:e})=>{const[r,s]=S.useState(null),[n,a]=S.useState(""),[i,l]=S.useState(null),[c,d]=S.useState({}),h=S.useMemo(()=>{const N=(y,k,C)=>y?Array.isArray(y)?y:[{id:y.id||`item-${k}-${C}`,...y}]:[];if(t.length>0&&typeof t[0]=="string")return t.map((y,k)=>({id:`group-${k}`,phase1:[{id:`item-${k}-phase1`,name:y,config:{}}],phase2:[],funded:[]}));if(t.length>0&&t[0].phase){const y=[];return t.forEach((k,C)=>{const j={id:`group-${C}`,phase1:[],phase2:[],funded:[]},A={id:`item-${C}-${k.phase}`,name:k.name,config:k.config||{}};k.phase==="phase1"?j.phase1=[A]:k.phase==="phase2"?j.phase2=[A]:k.phase==="funded"&&(j.funded=[A]),y.push(j)}),y}else if(t.length>0&&t[0].id)return t.map(y=>({...y,phase1:N(y.phase1,y.id,"phase1"),phase2:N(y.phase2,y.id,"phase2"),funded:N(y.funded,y.id,"funded")}));return[]},[t]),u=()=>{const N={id:`group-${Date.now()}`,phase1:[],phase2:[],funded:[]};e([...h,N])},f=N=>{confirm("")&&e(h.filter(y=>y.id!==N))},p=(N,y)=>{e(h.map(k=>{if(k.id===N){const C={id:`item-${Date.now()}`,name:"",config:{}};return{...k,[y]:[...k[y],C]}}return k})),s(`${N}-${y}-item-${Date.now()}`),a("")},g=(N,y,k,C)=>{e(h.map(T=>T.id===N?{...T,[y]:T[y].map(j=>j.id===k?{...j,name:C.trim()}:j).filter(j=>j.name.trim()!=="")}:T))},m=(N,y,k)=>{e(h.map(C=>C.id===N?{...C,[y]:C[y].filter(T=>T.id!==k)}:C))},b=(N,y,k,C)=>{n.trim()!==C&&g(N,y,k,n),s(null)},x=N=>{if(i===N)l(null);else{const y=N.split("-"),k=y.pop(),C=y.pop(),T=y.join("-"),O=h.find(A=>A.id===T)?.[C]?.find(A=>A.id===k);l(N),d(O?.config||{})}},w=(N,y,k)=>{const C=h.map(T=>T.id===N?{...T,[y]:T[y].map(j=>j.id===k?{...j,config:c}:j)}:T);e(C),ue.success(""),l(null)},v=N=>{if(!N.destination)return;const y=Array.from(h),[k]=y.splice(N.source.index,1);y.splice(N.destination.index,0,k),e(y)},_=(N,y,k)=>{const C=Array.isArray(N[y])?N[y]:N[y]?[N[y]]:[];return o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("div",{className:"text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:k}),o.jsx("button",{onClick:()=>p(N.id,y),className:"text-[10px] text-indigo-400 hover:text-indigo-300 transition-colors",title:"",children:"+ "})]}),o.jsx("div",{className:"bg-white/[0.03] border border-white/[0.05] rounded-lg p-2 min-h-[60px] space-y-2",children:C.length>0?C.map(T=>{const j=`${N.id}-${y}-${T.id}`,O=`${N.id}-${y}-${T.id}`,A=r===j;return o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between group/cell",children:[A?o.jsx("input",{autoFocus:!0,type:"text",value:n,onChange:I=>a(I.target.value),onBlur:()=>b(N.id,y,T.id,T.name),onKeyDown:I=>{I.key==="Enter"?b(N.id,y,T.id,T.name):I.key==="Escape"&&s(null)},className:"bg-transparent text-white text-sm font-medium focus:outline-none w-full border-b border-indigo-500 pb-1",placeholder:""}):o.jsx("span",{className:"text-slate-200 text-sm font-medium",children:T.name}),!A&&o.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover/cell:opacity-100 transition-opacity",children:[o.jsx("button",{onClick:()=>{s(j),a(T.name)},className:"p-1 text-slate-500 hover:text-indigo-400 transition-colors",title:"",children:o.jsx(wr,{className:"w-3 h-3"})}),o.jsx("button",{onClick:()=>x(O),className:`p-1 transition-colors ${Object.keys(T.config||{}).length>0?"text-emerald-400 hover:text-emerald-300":"text-slate-500 hover:text-indigo-400"}`,title:Object.keys(T.config||{}).length>0?"":"",children:o.jsx(Ss,{className:"w-3 h-3"})}),o.jsx("button",{onClick:()=>m(N.id,y,T.id),className:"p-1 text-slate-500 hover:text-rose-500 transition-colors",title:"",children:o.jsx(lr,{className:"w-3 h-3"})})]})]}),i===O&&o.jsxs("div",{className:"mt-2 p-3 border-t border-white/[0.06] bg-white/[0.02] rounded space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("h4",{className:"text-xs font-semibold text-white",children:[" - ",T.name]}),o.jsx("button",{onClick:()=>l(null),className:"p-1 text-slate-500 hover:text-white transition-colors",children:o.jsx(lr,{className:"w-3 h-3"})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{className:"col-span-2",children:[o.jsx("label",{className:"text-[10px] text-slate-400 mb-1 block",children:""}),o.jsx("div",{className:"flex flex-wrap gap-2",children:[{value:"",label:"",bg:"bg-slate-500",ring:"ring-slate-400"},{value:"red",label:"",bg:"bg-red-500",ring:"ring-red-400"},{value:"orange",label:"",bg:"bg-orange-500",ring:"ring-orange-400"},{value:"amber",label:"",bg:"bg-amber-500",ring:"ring-amber-400"},{value:"yellow",label:"",bg:"bg-yellow-500",ring:"ring-yellow-400"},{value:"lime",label:"",bg:"bg-lime-500",ring:"ring-lime-400"},{value:"emerald",label:"",bg:"bg-emerald-500",ring:"ring-emerald-400"},{value:"teal",label:"",bg:"bg-teal-500",ring:"ring-teal-400"},{value:"cyan",label:"",bg:"bg-cyan-500",ring:"ring-cyan-400"},{value:"blue",label:"",bg:"bg-blue-500",ring:"ring-blue-400"},{value:"indigo",label:"",bg:"bg-indigo-500",ring:"ring-indigo-400"},{value:"violet",label:"",bg:"bg-violet-500",ring:"ring-violet-400"},{value:"purple",label:"",bg:"bg-purple-500",ring:"ring-purple-400"},{value:"pink",label:"",bg:"bg-pink-500",ring:"ring-pink-400"}].map(I=>o.jsx("button",{type:"button",onClick:()=>d({...c,color:I.value}),className:`w-6 h-6 rounded-full ${I.bg} transition-all ${c.color===I.value?`ring-2 ${I.ring} ring-offset-2 ring-offset-[#18181b] scale-110`:"hover:scale-110"}`,title:I.label},I.value))})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsx("label",{className:"text-[10px] text-slate-400 mb-1 block",children:""}),o.jsxs("select",{value:c.drawdownType||"",onChange:I=>d({...c,drawdownType:I.target.value}),className:"w-full bg-[#18181b] border border-white/[0.08] rounded-lg px-2 py-1.5 text-xs text-white focus:outline-none focus:ring-1 focus:ring-indigo-500/50",children:[o.jsx("option",{value:"",children:"..."}),o.jsx("option",{value:"EOD Trailing",children:"EOD Trailing"}),o.jsx("option",{value:"Intraday Trailing",children:"Intraday Trailing"}),o.jsx("option",{value:"Static",children:"Static"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-slate-400 mb-1 block",children:""}),o.jsx("input",{type:"text",placeholder:": $2,000  10%",value:c.maxDrawdown||"",onChange:I=>d({...c,maxDrawdown:I.target.value}),className:"w-full bg-[#18181b] border border-white/[0.08] rounded-lg px-2 py-1.5 text-xs text-white focus:outline-none focus:ring-1 focus:ring-indigo-500/50"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-slate-400 mb-1 block",children:""}),o.jsx("input",{type:"text",placeholder:": $1,000  5%",value:c.dailyDrawdown||"",onChange:I=>d({...c,dailyDrawdown:I.target.value}),className:"w-full bg-[#18181b] border border-white/[0.08] rounded-lg px-2 py-1.5 text-xs text-white focus:outline-none focus:ring-1 focus:ring-indigo-500/50"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-slate-400 mb-1 block",children:""}),o.jsx("input",{type:"text",placeholder:": $3,000  8%",value:c.profitTarget||"",onChange:I=>d({...c,profitTarget:I.target.value}),className:"w-full bg-[#18181b] border border-white/[0.08] rounded-lg px-2 py-1.5 text-xs text-white focus:outline-none focus:ring-1 focus:ring-indigo-500/50"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-slate-400 mb-1 block",children:""}),o.jsx("input",{type:"text",placeholder:": 5 ",value:c.tradingDaysRequired||"",onChange:I=>d({...c,tradingDaysRequired:I.target.value}),className:"w-full bg-[#18181b] border border-white/[0.08] rounded-lg px-2 py-1.5 text-xs text-white focus:outline-none focus:ring-1 focus:ring-indigo-500/50"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-slate-400 mb-1 block",children:""}),o.jsx("input",{type:"text",placeholder:": $200",value:c.minimumProfitAmount||"",onChange:I=>d({...c,minimumProfitAmount:I.target.value}),className:"w-full bg-[#18181b] border border-white/[0.08] rounded-lg px-2 py-1.5 text-xs text-white focus:outline-none focus:ring-1 focus:ring-indigo-500/50"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-slate-400 mb-1 block",children:""}),o.jsx("input",{type:"text",placeholder:": 30% ",value:c.consistency||"",onChange:I=>d({...c,consistency:I.target.value}),className:"w-full bg-[#18181b] border border-white/[0.08] rounded-lg px-2 py-1.5 text-xs text-white focus:outline-none focus:ring-1 focus:ring-indigo-500/50"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-slate-400 mb-1 block",children:""}),o.jsx("input",{type:"text",placeholder:": 10",value:c.maxContracts||"",onChange:I=>d({...c,maxContracts:I.target.value}),className:"w-full bg-[#18181b] border border-white/[0.08] rounded-lg px-2 py-1.5 text-xs text-white focus:outline-none focus:ring-1 focus:ring-indigo-500/50"})]}),y==="funded"&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-slate-400 mb-1 block",children:""}),o.jsx("input",{type:"text",placeholder:": $10,000  80%",value:c.maxPayout||"",onChange:I=>d({...c,maxPayout:I.target.value}),className:"w-full bg-[#18181b] border border-white/[0.08] rounded-lg px-2 py-1.5 text-xs text-white focus:outline-none focus:ring-1 focus:ring-indigo-500/50"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-slate-400 mb-1 block",children:""}),o.jsx("input",{type:"text",placeholder:":   Bi-weekly",value:c.payoutFrequency||"",onChange:I=>d({...c,payoutFrequency:I.target.value}),className:"w-full bg-[#18181b] border border-white/[0.08] rounded-lg px-2 py-1.5 text-xs text-white focus:outline-none focus:ring-1 focus:ring-indigo-500/50"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-[10px] text-slate-400 mb-1 block",children:""}),o.jsxs("select",{value:c.newsTrading||"",onChange:I=>d({...c,newsTrading:I.target.value}),className:"w-full bg-[#18181b] border border-white/[0.08] rounded-lg px-2 py-1.5 text-xs text-white focus:outline-none focus:ring-1 focus:ring-indigo-500/50",children:[o.jsx("option",{value:"",children:"..."}),o.jsx("option",{value:"",children:""}),o.jsx("option",{value:"",children:""})]})]})]}),o.jsxs("div",{className:"col-span-2",children:[o.jsx("label",{className:"text-[10px] text-slate-400 mb-1 block",children:""}),o.jsx("textarea",{placeholder:"...",value:c.notes||"",onChange:I=>d({...c,notes:I.target.value}),rows:2,className:"w-full bg-[#18181b] border border-white/[0.08] rounded-lg px-2 py-1.5 text-xs text-white focus:outline-none focus:ring-1 focus:ring-indigo-500/50 resize-none"})]})]}),o.jsx("button",{onClick:()=>w(N.id,y,T.id),className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white px-3 py-1.5 rounded-lg font-semibold text-xs transition-all",children:""})]})]},T.id)}):o.jsx("div",{className:"text-center text-slate-500 text-xs py-2",children:""})})]})};return o.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-xl font-bold text-white",children:""}),o.jsx("button",{onClick:u,className:"bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-xl font-bold text-sm transition-all whitespace-nowrap",children:""})]}),o.jsxs("div",{className:"grid grid-cols-[auto_1fr_1fr_1fr_auto] gap-4 px-4 pb-2 border-b border-white/[0.08]",children:[o.jsx("div",{className:"w-8"}),o.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:" 1"}),o.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:" 2"}),o.jsx("div",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:"Funded"}),o.jsx("div",{className:"w-8"})]}),o.jsx(Or,{onDragEnd:v,children:o.jsx(Pr,{droppableId:"groups-list",children:N=>o.jsxs("div",{className:"space-y-3",...N.droppableProps,ref:N.innerRef,children:[h.map((y,k)=>o.jsx(Tr,{draggableId:y.id,index:k,children:C=>o.jsxs("div",{ref:C.innerRef,...C.draggableProps,className:"grid grid-cols-[auto_1fr_1fr_1fr_auto] gap-4 bg-white/[0.02] border border-white/[0.05] rounded-xl p-4 hover:bg-white/[0.04] transition-colors group",children:[o.jsx("div",{...C.dragHandleProps,className:"flex items-start pt-6",children:o.jsx("div",{className:"text-slate-600 hover:text-slate-400 cursor-grab active:cursor-grabbing p-1",children:o.jsx(ks,{size:16})})}),_(y,"phase1"," 1"),_(y,"phase2"," 2"),_(y,"funded","Funded"),o.jsx("div",{className:"flex items-start pt-6",children:o.jsx("button",{onClick:()=>f(y.id),className:"p-1 text-slate-500 hover:text-rose-500 transition-colors opacity-0 group-hover:opacity-100",children:o.jsx(pt,{className:"w-4 h-4"})})})]})},y.id)),N.placeholder,h.length===0&&o.jsx("div",{className:"text-center text-slate-500 text-sm py-12 border border-dashed border-white/[0.1] rounded-xl",children:""})]})})})]})},ma=({title:t,items:e,setItems:r,placeholder:s})=>{const[n,a]=S.useState(""),[i,l]=S.useState(null),[c,d]=S.useState(""),h=m=>{m.preventDefault(),n.trim()&&!e.includes(n.trim())&&(r([...e,n.trim()]),a(""))},u=m=>{confirm(` ${m} `)&&r(e.filter(b=>b!==m))},f=m=>{l(m),d(m)},p=m=>{c.trim()&&c!==m&&r(e.map(b=>b===m?c.trim():b)),l(null)},g=m=>{if(!m.destination)return;const b=Array.from(e),[x]=b.splice(m.source.index,1);b.splice(m.destination.index,0,x),r(b)};return o.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[o.jsx("h2",{className:"text-xl font-bold text-white",children:t}),o.jsxs("form",{onSubmit:h,className:"flex gap-2",children:[o.jsx("input",{type:"text",placeholder:s,value:n,onChange:m=>a(m.target.value),className:"flex-1 bg-[#18181b] border border-white/[0.08] rounded-xl px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-indigo-500/50"}),o.jsx("button",{type:"submit",className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-3 rounded-xl font-bold text-sm transition-all whitespace-nowrap",children:""})]}),o.jsx(Or,{onDragEnd:g,children:o.jsx(Pr,{droppableId:"simple-list",children:m=>o.jsxs("div",{className:"space-y-2",...m.droppableProps,ref:m.innerRef,children:[e.map((b,x)=>o.jsx(Tr,{draggableId:`${b}-${x}`,index:x,children:w=>o.jsx("div",{ref:w.innerRef,...w.draggableProps,children:o.jsx(Xi,{text:b,onDelete:()=>u(b),isEditing:i===b,editValue:c,setEditValue:d,onEditStart:()=>f(b),onEditSave:()=>p(b),dragHandleProps:w.dragHandleProps})})},`${b}-${x}`)),m.placeholder]})})})]})},eg=({items:t,setItems:e})=>{const[r,s]=S.useState(""),[n,a]=S.useState(null),[i,l]=S.useState(""),[c,d]=S.useState(null),h=[{value:"slate",label:"",bg:"bg-slate-500"},{value:"red",label:"",bg:"bg-red-500"},{value:"orange",label:"",bg:"bg-orange-500"},{value:"amber",label:"",bg:"bg-amber-500"},{value:"yellow",label:"",bg:"bg-yellow-500"},{value:"lime",label:"",bg:"bg-lime-500"},{value:"emerald",label:"",bg:"bg-emerald-500"},{value:"teal",label:"",bg:"bg-teal-500"},{value:"cyan",label:"",bg:"bg-cyan-500"},{value:"blue",label:"",bg:"bg-blue-500"},{value:"indigo",label:"",bg:"bg-indigo-500"},{value:"violet",label:"",bg:"bg-violet-500"},{value:"purple",label:"",bg:"bg-purple-500"},{value:"pink",label:"",bg:"bg-pink-500"}],u=t.map(v=>typeof v=="string"?{name:v,color:"slate"}:v),f=v=>{v.preventDefault(),r.trim()&&!u.find(_=>_.name===r.trim())&&(e([...u,{name:r.trim(),color:"slate"}]),s(""))},p=v=>{confirm(` ${v} `)&&e(u.filter(_=>_.name!==v))},g=v=>{a(v),l(v)},m=v=>{i.trim()&&i!==v&&e(u.map(_=>_.name===v?{..._,name:i.trim()}:_)),a(null)},b=(v,_)=>{e(u.map(N=>N.name===v?{...N,color:_}:N)),d(null)},x=v=>{if(!v.destination)return;const _=Array.from(u),[N]=_.splice(v.source.index,1);_.splice(v.destination.index,0,N),e(_)},w=v=>{const _=h.find(N=>N.value===v);return _?_.bg:"bg-slate-500"};return o.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[o.jsx("h2",{className:"text-xl font-bold text-white",children:""}),o.jsxs("form",{onSubmit:f,className:"flex gap-2",children:[o.jsx("input",{type:"text",placeholder:" (: Active)...",value:r,onChange:v=>s(v.target.value),className:"flex-1 bg-[#18181b] border border-white/[0.08] rounded-xl px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-indigo-500/50"}),o.jsx("button",{type:"submit",className:"bg-indigo-600 hover:bg-indigo-500 text-white px-6 py-3 rounded-xl font-bold text-sm transition-all whitespace-nowrap",children:""})]}),o.jsx(Or,{onDragEnd:x,children:o.jsx(Pr,{droppableId:"status-list",children:v=>o.jsxs("div",{className:"space-y-2",...v.droppableProps,ref:v.innerRef,children:[u.map((_,N)=>o.jsx(Tr,{draggableId:_.name,index:N,children:y=>o.jsx("div",{ref:y.innerRef,...y.draggableProps,children:o.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl bg-white/[0.03] border border-white/[0.05] group hover:bg-white/[0.05] transition-colors",children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[o.jsx("div",{...y.dragHandleProps,className:"text-slate-600 hover:text-slate-400 cursor-grab active:cursor-grabbing p-1",children:o.jsx(ks,{size:16})}),o.jsxs("div",{className:"relative",children:[o.jsx("button",{onClick:()=>d(c===_.name?null:_.name),className:`w-6 h-6 rounded-full ${w(_.color)} hover:scale-110 transition-transform border-2 border-white/20`,title:""}),c===_.name&&o.jsx("div",{className:"absolute top-8 left-0 z-50 p-2 bg-[#1a1a1d] border border-white/10 rounded-lg shadow-xl",children:o.jsx("div",{className:"flex flex-wrap gap-1.5 w-[180px]",children:h.map(k=>o.jsx("button",{onClick:()=>b(_.name,k.value),className:`w-5 h-5 rounded-full ${k.bg} hover:scale-110 transition-transform ${_.color===k.value?"ring-2 ring-white ring-offset-1 ring-offset-[#1a1a1d]":""}`,title:k.label},k.value))})})]}),n===_.name?o.jsx("input",{autoFocus:!0,type:"text",value:i,onChange:k=>l(k.target.value),onBlur:()=>m(_.name),onKeyDown:k=>k.key==="Enter"&&m(_.name),className:"flex-1 bg-transparent border-b border-indigo-500 text-white focus:outline-none px-1"}):o.jsx("span",{className:"text-white font-medium",children:_.name})]}),o.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[o.jsx("button",{onClick:()=>g(_.name),className:"p-2 text-slate-400 hover:text-indigo-400 transition-colors",children:o.jsx(zo,{size:14})}),o.jsx("button",{onClick:()=>p(_.name),className:"p-2 text-slate-400 hover:text-red-400 transition-colors",children:o.jsx(pt,{size:14})})]})]})})},_.name)),v.placeholder]})})})]})},Xi=({text:t,onDelete:e,isEditing:r,editValue:s,setEditValue:n,onEditStart:a,onEditSave:i,dragHandleProps:l})=>o.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl bg-white/[0.03] border border-white/[0.05] group hover:bg-white/[0.05] transition-colors",children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[o.jsx("div",{...l,className:"text-slate-600 hover:text-slate-400 cursor-grab active:cursor-grabbing p-1",children:o.jsx(ks,{size:16})}),r?o.jsx("input",{autoFocus:!0,type:"text",value:s,onChange:c=>n(c.target.value),onBlur:i,onKeyDown:c=>c.key==="Enter"&&i(),className:"bg-transparent text-white text-sm font-medium focus:outline-none w-full border-b border-indigo-500 pb-1"}):o.jsx("span",{className:"text-slate-200 text-sm font-medium",children:t})]}),o.jsxs("div",{className:"flex items-center gap-1 opacity-100 sm:opacity-0 group-hover:opacity-100 transition-opacity",children:[o.jsx("button",{onClick:a,className:"p-2 text-slate-500 hover:text-indigo-400 transition-colors rounded-lg hover:bg-indigo-500/10",children:o.jsx(wr,{className:"w-3.5 h-3.5"})}),o.jsx("button",{onClick:e,className:"p-2 text-slate-500 hover:text-rose-500 transition-colors rounded-lg hover:bg-rose-500/10",children:o.jsx(pt,{className:"w-4 h-4"})})]})]}),ar=({title:t,value:e,prefix:r="",suffix:s="",icon:n,color:a,trend:i,trendUp:l})=>o.jsxs("div",{className:"bg-white dark:bg-[#111827]/60 backdrop-blur-sm p-6 rounded-3xl border border-slate-200 dark:border-slate-800 hover:border-emerald-500/50 transition-all duration-300 group hover:shadow-lg hover:shadow-emerald-500/10 hover:-translate-y-1 relative overflow-hidden",children:[o.jsxs("div",{className:"flex justify-between items-start mb-4 relative z-10",children:[o.jsx("div",{className:`p-3 rounded-2xl bg-slate-100 dark:bg-slate-800/80 border border-slate-200 dark:border-slate-700 ${a} group-hover:scale-110 group-hover:border-emerald-500/30 transition-all duration-300`,children:te.cloneElement(n,{size:20})}),i&&o.jsx("span",{className:`text-[10px] font-bold px-2 py-1 rounded-full border ${l?"bg-emerald-500/10 text-emerald-600 dark:text-emerald-400 border-emerald-500/20":"bg-rose-500/10 text-rose-600 dark:text-rose-400 border-rose-500/20"} ${i==="All time"?"bg-slate-500/10 text-slate-600 dark:text-slate-400 border-slate-500/20":""}`,children:i})]}),o.jsxs("div",{className:"space-y-1 relative z-10",children:[o.jsx("span",{className:"text-slate-600 dark:text-slate-400 text-xs font-semibold uppercase tracking-wider",children:t}),o.jsxs("div",{className:"flex items-baseline gap-1",children:[o.jsx("span",{className:"text-sm font-medium text-slate-500",children:r}),o.jsx("h3",{className:"text-2xl font-bold text-slate-900 dark:text-white font-mono tracking-tight",children:(Number(e)||0).toLocaleString()}),o.jsx("span",{className:"text-sm font-medium text-slate-500",children:s})]})]})]}),Qi=t=>{if(t==null||isNaN(t))return"0";try{return Number(t).toLocaleString()}catch{return String(t)}},ba=({label:t,value:e,total:r,color:s,showPercent:n=!0})=>{const a=r>0?e/r*100:0;return o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between text-xs font-semibold",children:[o.jsx("span",{className:"text-slate-300",children:t}),o.jsxs("span",{className:"text-slate-500",children:["$",Qi(e)," ",n&&`(${a.toFixed(0)}%)`]})]}),o.jsx("div",{className:"h-2 w-full bg-slate-800/50 rounded-full overflow-hidden",children:o.jsx("div",{className:`h-full ${s} shadow-[0_0_10px_currentColor] transition-all duration-1000 ease-out`,style:{width:`${Math.min(100,a)}%`,opacity:.8}})})]})},ss=({data:t,total:e,label:r})=>{const l=2*Math.PI*80;let c=-90;return o.jsxs("div",{className:"flex flex-col items-center gap-4",children:[o.jsxs("div",{className:"relative flex items-center justify-center",children:[o.jsxs("svg",{width:180,height:180,viewBox:"0 0 180 180",className:"transform rotate-0",children:[o.jsx("circle",{cx:90,cy:90,r:80,fill:"none",stroke:"currentColor",strokeWidth:20,className:"text-slate-100 dark:text-white/[0.05]"}),t.map((d,h)=>{if(d.value<=0)return null;const u=e>0?d.value/e:0,f=`${u*l} ${l}`,p=c;return c+=u*360,o.jsx("circle",{cx:90,cy:90,r:80,fill:"none",stroke:d.color,strokeWidth:20,strokeDasharray:f,strokeLinecap:"round",transform:`rotate(${p} 90 90)`,className:"transition-all duration-1000 ease-out"},h)})]}),o.jsxs("div",{className:"absolute flex flex-col items-center justify-center text-center",children:[o.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-1",children:r}),o.jsxs("span",{className:"text-2xl font-black text-slate-900 dark:text-white font-mono tracking-tight",children:["$",Qi(e)]})]})]}),o.jsx("div",{className:"w-full flex flex-col gap-2",children:t.map((d,h)=>{const u=e>0?d.value/e*100:0;return o.jsxs("div",{className:"flex items-center gap-3 text-xs w-fit mx-auto",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"w-2.5 h-2.5 rounded-full",style:{backgroundColor:d.color}}),o.jsx("span",{className:"text-slate-600 dark:text-slate-300 font-medium",children:d.label})]}),o.jsx("div",{className:"w-px h-3 bg-slate-200 dark:bg-slate-700 mx-1"}),o.jsxs("span",{className:"text-slate-500 font-mono",children:["$",(Number(d.value)||0).toLocaleString()," ",o.jsxs("span",{className:"text-[10px] opacity-70",children:["(",u.toFixed(1),"%)"]})]})]},h)})})]})},V=(t,e="")=>t?typeof t=="string"?t:typeof t=="object"&&t.name?t.name:e:e,tg=({data:t})=>{const[e,r]=S.useState([]),s=d=>{r(h=>h.includes(d)?h.filter(u=>u!==d):[...h,d])},n=S.useMemo(()=>{const d=new Map;return t.forEach((h,u)=>{const f=h.firm||"",p=h.accountStage||"",g=h.category||"",m=`${f}-${p}`,b=`${f.substring(0,1)}${u+1}`,x=h.payouts&&h.payouts.length>0,w=x?h.payouts.length:0,v=h.accountRecords||[];d.has(m)||d.set(m,{firm:f,accountStage:p,category:g,accounts:[]}),d.get(m).accounts.push({id:b,accountStatus:V(h.accountStatus)||"Active",hasPayouts:x,payoutCount:w,accountRecords:v,payouts:h.payouts||[],baseCost:h.baseCost||0})}),Array.from(d.values())},[t]),a=S.useMemo(()=>{let d=0;return n.forEach(h=>{h.accounts.forEach(u=>{const f=u.accountRecords.length;f>d&&(d=f)})}),d},[n]),i=d=>{const h=[{border:"border-emerald-500",bg:"bg-emerald-500",light:"bg-emerald-50 dark:bg-emerald-500/10",text:"text-emerald-600 dark:text-emerald-400",badge:"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-300"},{border:"border-blue-500",bg:"bg-blue-500",light:"bg-blue-50 dark:bg-blue-500/10",text:"text-blue-600 dark:text-blue-400",badge:"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300"},{border:"border-purple-500",bg:"bg-purple-500",light:"bg-purple-50 dark:bg-purple-500/10",text:"text-purple-600 dark:text-purple-400",badge:"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300"},{border:"border-cyan-500",bg:"bg-cyan-500",light:"bg-cyan-50 dark:bg-cyan-500/10",text:"text-cyan-600 dark:text-cyan-400",badge:"bg-cyan-100 dark:bg-cyan-900/30 text-cyan-700 dark:text-cyan-300"},{border:"border-pink-500",bg:"bg-pink-500",light:"bg-pink-50 dark:bg-pink-500/10",text:"text-pink-600 dark:text-pink-400",badge:"bg-pink-100 dark:bg-pink-900/30 text-pink-700 dark:text-pink-300"},{border:"border-amber-500",bg:"bg-amber-500",light:"bg-amber-50 dark:bg-amber-500/10",text:"text-amber-600 dark:text-amber-400",badge:"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300"},{border:"border-indigo-500",bg:"bg-indigo-500",light:"bg-indigo-50 dark:bg-indigo-500/10",text:"text-indigo-600 dark:text-indigo-400",badge:"bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300"},{border:"border-teal-500",bg:"bg-teal-500",light:"bg-teal-50 dark:bg-teal-500/10",text:"text-teal-600 dark:text-teal-400",badge:"bg-teal-100 dark:bg-teal-900/30 text-teal-700 dark:text-teal-300"},{border:"border-rose-500",bg:"bg-rose-500",light:"bg-rose-50 dark:bg-rose-500/10",text:"text-rose-600 dark:text-rose-400",badge:"bg-rose-100 dark:bg-rose-900/30 text-rose-700 dark:text-rose-300"},{border:"border-orange-500",bg:"bg-orange-500",light:"bg-orange-50 dark:bg-orange-500/10",text:"text-orange-600 dark:text-orange-400",badge:"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300"},{border:"border-lime-500",bg:"bg-lime-500",light:"bg-lime-50 dark:bg-lime-500/10",text:"text-lime-600 dark:text-lime-400",badge:"bg-lime-100 dark:bg-lime-900/30 text-lime-700 dark:text-lime-300"},{border:"border-violet-500",bg:"bg-violet-500",light:"bg-violet-50 dark:bg-violet-500/10",text:"text-violet-600 dark:text-violet-400",badge:"bg-violet-100 dark:bg-violet-900/30 text-violet-700 dark:text-violet-300"}];return h[d%h.length]},l=(d,h)=>{const u=[];if(h?.includes("")){u.push(null),a>1&&u.push(null);const p={created:[],active:[],passed:[],failed:[],suspended:[],withdrawn:[]};d.forEach(g=>{p.created.push(g);const m=V(g.accountStatus).toLowerCase();m==="active"?p.active.push(g):m==="passed"?p.passed.push(g):m==="failed"?p.failed.push(g):m==="suspended"?p.suspended.push(g):m==="withdrawn"&&p.withdrawn.push(g)}),u.push(p)}else for(let p=0;p<=a;p++){const g={created:[],active:[],passed:[],failed:[],suspended:[],withdrawn:[]};d.forEach(m=>{if(p===0){if(g.created.push(m),m.accountRecords.length===0)V(m.accountStatus).toLowerCase()==="active"&&g.active.push(m);else if(m.accountRecords?.length>0){const b=m.accountRecords[0],x=V(b?.status).toLowerCase();x==="active"?g.active.push(m):x==="passed"?g.passed.push(m):x==="failed"?g.failed.push(m):x==="suspended"&&g.suspended.push(m)}}else if(p<=a&&p<m.accountRecords.length+1){const b=p-1;if(b<m.accountRecords.length){const x=m.accountRecords[b],w=V(x?.status).toLowerCase(),v=m.accountRecords[b-1];(b===0||V(v?.status).toLowerCase()==="passed")&&g.created.push(m),w==="active"?g.active.push(m):w==="passed"?g.passed.push(m):w==="failed"?g.failed.push(m):w==="suspended"&&g.suspended.push(m)}else if(p===a&&m.accountRecords?.length>0){const x=m.accountRecords[m.accountRecords.length-1];V(x?.status).toLowerCase()==="passed"&&(g.created.push(m),g.active.push(m))}}}),u.push(g)}return u};if(n.length===0)return o.jsx("div",{className:"flex items-center justify-center h-96 text-slate-500 dark:text-slate-400",children:""});const c=Math.max(3,a+1);return o.jsx("div",{className:"w-full overflow-x-auto",children:o.jsxs("div",{className:"min-w-[900px]",children:[o.jsxs("div",{className:"grid gap-4 mb-6 border-b border-slate-200 dark:border-slate-700 pb-4",style:{gridTemplateColumns:`200px repeat(${c}, 1fr)`},children:[o.jsx("div",{className:"font-bold text-slate-400 dark:text-slate-500 text-xs uppercase tracking-wider pl-2",children:"Firm / Model"}),Array.from({length:c},(d,h)=>{let u="";return h<a?u=`Phase ${h+1}`:u="Funded & Payouts",o.jsx("div",{className:`font-bold text-xs uppercase tracking-wider ${h===c-1?"text-slate-900 dark:text-white":"text-slate-400 dark:text-slate-500"}`,children:u},h)})]}),n.map((d,h)=>{const u=i(h),f=d.accountStage.includes(""),p=l(d.accounts,d.accountStage);return d.accounts.length,o.jsxs("div",{className:"grid gap-4 mb-6 group",style:{gridTemplateColumns:`200px repeat(${c}, 1fr)`},children:[o.jsxs("div",{className:`flex flex-col justify-center border-l-4 ${u.border} pl-4 py-2 ${u.light} rounded-r-xl`,children:[o.jsx("div",{className:"font-bold text-slate-800 dark:text-white text-lg",children:d.firm}),o.jsx("span",{className:`text-[10px] font-bold uppercase tracking-wide ${u.text} mt-1`,children:d.accountStage})]}),Array.from({length:c},(g,m)=>{const b=d.accountStage.includes("1");if(f&&m<c-1)return o.jsx("div",{className:`relative h-full flex items-center justify-center bg-slate-50/30 dark:bg-slate-800/20 rounded-xl border-2 border-dashed ${u.border}/20`,children:o.jsx("div",{className:`z-10 ${u.badge} text-xs font-bold px-3 py-1 rounded-full border ${u.border}/20`,children:m===0&&c>2?" Skipped":"Skipped"})},m);if(b&&m===1&&c>2)return o.jsx("div",{className:`relative h-full flex items-center justify-center bg-slate-50/30 dark:bg-slate-800/20 rounded-xl border-2 border-dashed ${u.border}/20`,children:o.jsx("div",{className:`z-10 ${u.badge} text-xs font-bold px-3 py-1 rounded-full border ${u.border}/20`,children:" Skipped"})},m);const x=p[m];if(!x||x.created.length===0&&x.active.length===0&&x.passed.length===0&&x.failed.length===0)return o.jsx("div",{className:"relative h-full flex items-center justify-center bg-slate-50/30 dark:bg-slate-800/20 rounded-xl border-2 border-dashed border-slate-200 dark:border-slate-700/50",children:o.jsx("div",{className:"text-xs text-slate-400 dark:text-slate-600 italic",children:""})},m);const w=m===c-1;return o.jsxs("div",{className:`bg-white dark:bg-slate-800/50 border ${w?u.border:"border-slate-200 dark:border-slate-700"} ${w?u.light:""} rounded-xl p-3 hover:border-slate-300 dark:hover:border-slate-600 hover:shadow-lg transition-all duration-200 hover:-translate-y-1`,children:[o.jsx("div",{className:`text-xs font-bold mb-3 border-b pb-1 ${w?`${u.text} ${u.border}/20`:"text-slate-600 dark:text-slate-400 border-slate-100 dark:border-slate-700"}`,children:m<a?`Phase ${m+1}`:"Funded Status"}),x.created.length>0&&o.jsxs("div",{className:`mb-3 border-b ${w?`${u.border}/10`:"border-slate-50 dark:border-slate-800"} pb-2`,children:[o.jsxs("div",{className:"text-[10px] font-bold uppercase tracking-wide text-slate-400 dark:text-slate-500 mb-1.5",children:[m===0?"":m<a?"":""," (",x.created.length,")"]}),o.jsxs("div",{className:"flex flex-wrap gap-1 opacity-60",children:[x.created.slice(0,8).map((v,_)=>o.jsx("span",{className:"bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-400 text-[9px] font-bold px-1.5 py-0.5 rounded",children:v.id},_)),x.created.length>8&&o.jsxs("span",{className:"text-[9px] text-slate-400 dark:text-slate-500 px-1",children:["+",x.created.length-8]})]})]}),x.active.length>0&&o.jsxs("div",{className:"mb-3",children:[o.jsxs("div",{className:"text-[10px] font-bold uppercase tracking-wide mb-1.5 flex items-center",children:[o.jsx("span",{className:`w-1.5 h-1.5 rounded-full ${w?u.bg.replace("bg-","bg-"):"bg-amber-500 dark:bg-amber-400"} animate-pulse mr-1.5`}),o.jsxs("span",{className:w?u.text:"text-amber-500 dark:text-amber-400",children:[" (",x.active.length,")"]})]}),o.jsx("div",{className:"flex flex-col gap-1.5",children:x.active.map((v,_)=>{const N=`${d.firm}-${v.id}-active-${m}`,y=e.includes(N);return o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsxs("button",{onClick:()=>s(N),className:`${u.bg} text-white text-[9px] font-bold px-1.5 py-0.5 rounded cursor-pointer hover:opacity-80 transition-opacity`,title:"",children:[v.id," ",y?"":""]}),w&&v.hasPayouts&&o.jsxs("span",{className:"bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-200 dark:border-yellow-800 text-yellow-700 dark:text-yellow-300 text-[8px] font-bold px-1.5 py-0.5 rounded",children:[v.payoutCount," "]})]}),y&&!w&&v.accountRecords&&v.accountRecords.length>0&&o.jsxs("div",{className:"mt-2 p-2 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-200 dark:border-slate-700 text-[10px]",children:[o.jsx("div",{className:"font-bold text-slate-600 dark:text-slate-300 mb-2",children:""}),o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"text-slate-500 dark:text-slate-400 border-b border-slate-200 dark:border-slate-600",children:[o.jsx("th",{className:"text-left py-1 px-1",children:""}),o.jsx("th",{className:"text-left py-1 px-1",children:""}),o.jsx("th",{className:"text-left py-1 px-1",children:""}),o.jsx("th",{className:"text-left py-1 px-1",children:""})]})}),o.jsx("tbody",{children:v.accountRecords.map((k,C)=>o.jsxs("tr",{className:"border-b border-slate-100 dark:border-slate-700/50",children:[o.jsx("td",{className:"py-1 px-1 text-slate-600 dark:text-slate-300 font-mono",children:k.date}),o.jsx("td",{className:"py-1 px-1",children:o.jsx("span",{className:`px-1 py-0.5 rounded text-[8px] font-bold ${V(k.status)==="Passed"?"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400":V(k.status)==="Active"?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":V(k.status)==="Failed"?"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-400"}`,children:V(k.status)})}),o.jsx("td",{className:"py-1 px-1 text-slate-600 dark:text-slate-300",children:k.type||"-"}),o.jsx("td",{className:"py-1 px-1 text-slate-600 dark:text-slate-300 font-mono",children:k.number||"-"})]},C))})]})]}),y&&!w&&(!v.accountRecords||v.accountRecords.length===0)&&o.jsx("div",{className:"mt-2 p-2 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-200 dark:border-slate-700 text-[10px] text-slate-500 italic",children:""}),y&&w&&o.jsxs("div",{className:"mt-2 p-2 bg-emerald-50 dark:bg-emerald-900/20 rounded-lg border border-emerald-200 dark:border-emerald-700 text-[10px]",children:[o.jsx("div",{className:"font-bold text-emerald-600 dark:text-emerald-300 mb-2",children:""}),v.payouts&&v.payouts.length>0?o.jsxs(o.Fragment,{children:[o.jsxs("table",{className:"w-full mb-2",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"text-emerald-600 dark:text-emerald-400 border-b border-emerald-200 dark:border-emerald-600",children:[o.jsx("th",{className:"text-left py-1 px-1",children:""}),o.jsx("th",{className:"text-right py-1 px-1",children:""}),o.jsx("th",{className:"text-center py-1 px-1",children:""})]})}),o.jsx("tbody",{children:v.payouts.map((k,C)=>o.jsxs("tr",{className:"border-b border-emerald-100 dark:border-emerald-700/50",children:[o.jsx("td",{className:"py-1 px-1 text-slate-600 dark:text-slate-300 font-mono",children:k.date}),o.jsxs("td",{className:"py-1 px-1 text-right text-emerald-600 dark:text-emerald-400 font-mono font-bold",children:["+$",Number(k.amount||0).toLocaleString()]}),o.jsx("td",{className:`py-1 px-1 text-center font-bold ${k.arrived===""?"text-emerald-600 dark:text-emerald-400":"text-amber-500 dark:text-amber-400"}`,children:k.arrived||""})]},C))})]}),o.jsxs("div",{className:"pt-2 border-t border-emerald-200 dark:border-emerald-600 flex justify-between items-center",children:[o.jsx("span",{className:"text-emerald-600 dark:text-emerald-400 font-bold",children:":"}),o.jsxs("span",{className:"text-emerald-600 dark:text-emerald-400 font-mono font-bold text-sm",children:["$",v.payouts.reduce((k,C)=>C.arrived===""?k+Number(C.amount||0):k,0).toLocaleString()]})]})]}):o.jsx("div",{className:"text-slate-500 italic",children:""})]})]},_)})})]}),x.passed.length>0&&o.jsxs("div",{className:"mb-3",children:[o.jsxs("div",{className:"text-[10px] font-bold uppercase tracking-wide text-emerald-600 dark:text-emerald-400 mb-1.5",children:[" (",x.passed.length,")"]}),o.jsx("div",{className:"flex flex-col gap-1.5",children:x.passed.map((v,_)=>{const N=`${d.firm}-${v.id}-passed-${m}`,y=e.includes(N);return o.jsxs("div",{children:[o.jsxs("button",{onClick:()=>s(N),className:`${u.bg} text-white text-[9px] font-bold px-1.5 py-0.5 rounded cursor-pointer hover:opacity-80 transition-opacity`,title:w?"":"",children:[v.id," ",y?"":""]}),y&&!w&&v.accountRecords&&v.accountRecords.length>0&&o.jsxs("div",{className:"mt-2 p-2 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-200 dark:border-slate-700 text-[10px]",children:[o.jsx("div",{className:"font-bold text-slate-600 dark:text-slate-300 mb-2",children:""}),o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"text-slate-500 dark:text-slate-400 border-b border-slate-200 dark:border-slate-600",children:[o.jsx("th",{className:"text-left py-1 px-1",children:""}),o.jsx("th",{className:"text-left py-1 px-1",children:""}),o.jsx("th",{className:"text-left py-1 px-1",children:""}),o.jsx("th",{className:"text-left py-1 px-1",children:""})]})}),o.jsx("tbody",{children:v.accountRecords.map((k,C)=>o.jsxs("tr",{className:"border-b border-slate-100 dark:border-slate-700/50",children:[o.jsx("td",{className:"py-1 px-1 text-slate-600 dark:text-slate-300 font-mono",children:k.date}),o.jsx("td",{className:"py-1 px-1",children:o.jsx("span",{className:`px-1 py-0.5 rounded text-[8px] font-bold ${V(k.status)==="Passed"?"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400":V(k.status)==="Active"?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":V(k.status)==="Failed"?"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-400"}`,children:V(k.status)})}),o.jsx("td",{className:"py-1 px-1 text-slate-600 dark:text-slate-300",children:k.type||"-"}),o.jsx("td",{className:"py-1 px-1 text-slate-600 dark:text-slate-300 font-mono",children:k.number||"-"})]},C))})]})]}),y&&!w&&(!v.accountRecords||v.accountRecords.length===0)&&o.jsx("div",{className:"mt-2 p-2 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-200 dark:border-slate-700 text-[10px] text-slate-500 italic",children:""}),y&&w&&o.jsxs("div",{className:"mt-2 p-2 bg-emerald-50 dark:bg-emerald-900/20 rounded-lg border border-emerald-200 dark:border-emerald-700 text-[10px]",children:[o.jsx("div",{className:"font-bold text-emerald-600 dark:text-emerald-300 mb-2",children:""}),v.payouts&&v.payouts.length>0?o.jsxs(o.Fragment,{children:[o.jsxs("table",{className:"w-full mb-2",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"text-emerald-600 dark:text-emerald-400 border-b border-emerald-200 dark:border-emerald-600",children:[o.jsx("th",{className:"text-left py-1 px-1",children:""}),o.jsx("th",{className:"text-right py-1 px-1",children:""}),o.jsx("th",{className:"text-center py-1 px-1",children:""})]})}),o.jsx("tbody",{children:v.payouts.map((k,C)=>o.jsxs("tr",{className:"border-b border-emerald-100 dark:border-emerald-700/50",children:[o.jsx("td",{className:"py-1 px-1 text-slate-600 dark:text-slate-300 font-mono",children:k.date}),o.jsxs("td",{className:"py-1 px-1 text-right text-emerald-600 dark:text-emerald-400 font-mono font-bold",children:["+$",Number(k.amount||0).toLocaleString()]}),o.jsx("td",{className:`py-1 px-1 text-center font-bold ${k.arrived===""?"text-emerald-600 dark:text-emerald-400":"text-amber-500 dark:text-amber-400"}`,children:k.arrived||""})]},C))})]}),o.jsxs("div",{className:"pt-2 border-t border-emerald-200 dark:border-emerald-600 flex justify-between items-center",children:[o.jsx("span",{className:"text-emerald-600 dark:text-emerald-400 font-bold",children:":"}),o.jsxs("span",{className:"text-emerald-600 dark:text-emerald-400 font-mono font-bold text-sm",children:["$",v.payouts.reduce((k,C)=>C.arrived===""?k+Number(C.amount||0):k,0).toLocaleString()]})]})]}):o.jsx("div",{className:"text-slate-500 italic",children:""})]})]},_)})})]}),x.suspended.length>0&&o.jsxs("div",{className:"mb-3",children:[o.jsxs("div",{className:"text-[10px] font-bold uppercase tracking-wide text-orange-500 dark:text-orange-400 mb-1.5",children:[" (",x.suspended.length,")"]}),o.jsx("div",{className:"flex flex-col gap-1.5",children:x.suspended.map((v,_)=>{const N=`${d.firm}-${v.id}-suspended-${m}`,y=e.includes(N);return o.jsxs("div",{children:[o.jsxs("button",{onClick:()=>s(N),className:"border border-orange-200 dark:border-orange-800 bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 text-[9px] font-bold px-1.5 py-0.5 rounded cursor-pointer hover:opacity-80 transition-opacity",title:"",children:[v.id," ",y?"":""]}),y&&v.accountRecords&&v.accountRecords.length>0&&o.jsxs("div",{className:"mt-2 p-2 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-200 dark:border-slate-700 text-[10px]",children:[o.jsx("div",{className:"font-bold text-slate-600 dark:text-slate-300 mb-2",children:""}),o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"text-slate-500 dark:text-slate-400 border-b border-slate-200 dark:border-slate-600",children:[o.jsx("th",{className:"text-left py-1 px-1",children:""}),o.jsx("th",{className:"text-left py-1 px-1",children:""}),o.jsx("th",{className:"text-left py-1 px-1",children:""}),o.jsx("th",{className:"text-left py-1 px-1",children:""})]})}),o.jsx("tbody",{children:v.accountRecords.map((k,C)=>o.jsxs("tr",{className:"border-b border-slate-100 dark:border-slate-700/50",children:[o.jsx("td",{className:"py-1 px-1 text-slate-600 dark:text-slate-300 font-mono",children:k.date}),o.jsx("td",{className:"py-1 px-1",children:o.jsx("span",{className:`px-1 py-0.5 rounded text-[8px] font-bold ${V(k.status)==="Passed"?"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400":V(k.status)==="Active"?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":V(k.status)==="Failed"?"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400":V(k.status)==="Suspended"?"bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-400"}`,children:V(k.status)})}),o.jsx("td",{className:"py-1 px-1 text-slate-600 dark:text-slate-300",children:k.type||"-"}),o.jsx("td",{className:"py-1 px-1 text-slate-600 dark:text-slate-300 font-mono",children:k.number||"-"})]},C))})]})]}),y&&(!v.accountRecords||v.accountRecords.length===0)&&o.jsx("div",{className:"mt-2 p-2 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-200 dark:border-slate-700 text-[10px] text-slate-500 italic",children:""})]},_)})})]}),x.failed.length>0&&o.jsxs("div",{className:"mb-3",children:[o.jsxs("div",{className:"text-[10px] font-bold uppercase tracking-wide text-red-400 dark:text-red-400 mb-1.5",children:[" (",x.failed.length,")"]}),o.jsx("div",{className:"flex flex-col gap-1.5",children:x.failed.map((v,_)=>{const N=`${d.firm}-${v.id}-failed-${m}`,y=e.includes(N);return o.jsxs("div",{children:[o.jsxs("button",{onClick:()=>s(N),className:"border border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20 text-red-400 dark:text-red-400 text-[9px] font-bold px-1.5 py-0.5 rounded cursor-pointer hover:opacity-80 transition-opacity",title:"",children:[v.id," ",y?"":""]}),y&&v.accountRecords&&v.accountRecords.length>0&&o.jsxs("div",{className:"mt-2 p-2 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-200 dark:border-slate-700 text-[10px]",children:[o.jsx("div",{className:"font-bold text-slate-600 dark:text-slate-300 mb-2",children:""}),o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"text-slate-500 dark:text-slate-400 border-b border-slate-200 dark:border-slate-600",children:[o.jsx("th",{className:"text-left py-1 px-1",children:""}),o.jsx("th",{className:"text-left py-1 px-1",children:""}),o.jsx("th",{className:"text-left py-1 px-1",children:""}),o.jsx("th",{className:"text-left py-1 px-1",children:""})]})}),o.jsx("tbody",{children:v.accountRecords.map((k,C)=>o.jsxs("tr",{className:"border-b border-slate-100 dark:border-slate-700/50",children:[o.jsx("td",{className:"py-1 px-1 text-slate-600 dark:text-slate-300 font-mono",children:k.date}),o.jsx("td",{className:"py-1 px-1",children:o.jsx("span",{className:`px-1 py-0.5 rounded text-[8px] font-bold ${V(k.status)==="Passed"?"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400":V(k.status)==="Active"?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400":V(k.status)==="Failed"?"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400":V(k.status)==="Suspended"?"bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400":"bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-400"}`,children:V(k.status)})}),o.jsx("td",{className:"py-1 px-1 text-slate-600 dark:text-slate-300",children:k.type||"-"}),o.jsx("td",{className:"py-1 px-1 text-slate-600 dark:text-slate-300 font-mono",children:k.number||"-"})]},C))})]})]}),y&&(!v.accountRecords||v.accountRecords.length===0)&&o.jsx("div",{className:"mt-2 p-2 bg-slate-50 dark:bg-slate-800/50 rounded-lg border border-slate-200 dark:border-slate-700 text-[10px] text-slate-500 italic",children:""})]},_)})})]}),x.withdrawn.length>0&&o.jsxs("div",{children:[o.jsxs("div",{className:"text-[10px] font-bold uppercase tracking-wide text-slate-400 dark:text-slate-500 mb-1.5",children:[" (",x.withdrawn.length,")"]}),o.jsx("div",{className:"flex flex-wrap gap-1.5",children:x.withdrawn.map((v,_)=>o.jsx("span",{className:"border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-400 dark:text-slate-500 text-[9px] font-bold px-1.5 py-0.5 rounded",children:v.id},_))})]}),!w&&x.active.length===0&&x.passed.length===0&&x.failed.length===0&&x.suspended.length===0&&x.withdrawn.length===0&&x.created.length===0&&o.jsx("div",{className:"text-[10px] text-slate-300 dark:text-slate-600 italic",children:""})]},m)})]},h)})]})})},rg=({data:t,onEdit:e,onDelete:r,accountTypes:s=[],accountStages:n=[],accountStatuses:a=[]})=>{const[i,l]=S.useState([]),[c,d]=S.useState(!1),[h,u]=S.useState([]),[f,p]=S.useState([]),g=S.useRef(null),m=S.useCallback(j=>{g.current&&!g.current.contains(j.target)&&d(!1)},[]);S.useEffect(()=>{if(c)return document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[c,m]);const b=S.useMemo(()=>a.length>0?a.map(j=>typeof j=="string"?j:j.name):["Active","Passed","Suspended","Failed","Withdrawn"],[a]),x=S.useMemo(()=>{let j=t;return i.length>0&&(j=j.filter(O=>!i.includes(O.accountStatus))),j},[t,i]),w=S.useMemo(()=>{const j={};x.forEach(A=>{j[A.firm]||(j[A.firm]=[]),j[A.firm].push(A)});const O={};return Object.keys(j).forEach(A=>{j[A].sort((X,M)=>new Date(X.date)-new Date(M.date)).forEach((X,M)=>{O[X.id]=M+1})}),O},[x]),v=j=>{l(O=>O.includes(j)?O.filter(A=>A!==j):[...O,j])},_=j=>{u(O=>O.includes(j)?O.filter(A=>A!==j):[...O,j])},N=j=>{p(O=>O.includes(j)?O.filter(A=>A!==j):[...O,j])},y=j=>{const O=A=>{if(!A)return null;if(Array.isArray(A)){const I=A.find(X=>X.name===j);if(I?.config)return I.config}else if(A.name===j&&A.config)return A.config;return null};for(const A of s)if(typeof A!="string"){if(A.name===j&&A.config)return A.config;if(A.id){const I=O(A.phase1)||O(A.phase2)||O(A.funded);if(I)return I}}return null},k=j=>{if(!j.accountRecords||j.accountRecords.length===0)return V(j.accountStatus);const I=j.accountRecords.map((X,M)=>({...X,_index:M})).sort((X,M)=>{const U=new Date(M.date)-new Date(X.date);return U!==0?U:M._index-X._index})[0];return I.status?V(I.status):V(j.accountStatus)},C=j=>{if(!j.accountRecords||j.accountRecords.length===0)return j.phase;const I=j.accountRecords.map((X,M)=>({...X,_index:M})).sort((X,M)=>{const U=new Date(M.date)-new Date(X.date);return U!==0?U:M._index-X._index})[0];return I.type?I.type:j.phase},T=j=>{const O=a.find(A=>(typeof A=="string"?A:A.name)===j);if(O&&typeof O=="object"&&O.color)return{slate:"text-slate-600 dark:text-slate-400",red:"text-red-600 dark:text-red-400",orange:"text-orange-600 dark:text-orange-400",amber:"text-amber-600 dark:text-amber-400",yellow:"text-yellow-600 dark:text-yellow-400",lime:"text-lime-600 dark:text-lime-400",emerald:"text-emerald-600 dark:text-emerald-400",teal:"text-teal-600 dark:text-teal-400",cyan:"text-cyan-600 dark:text-cyan-400",blue:"text-blue-600 dark:text-blue-400",indigo:"text-indigo-600 dark:text-indigo-400",violet:"text-violet-600 dark:text-violet-400",purple:"text-purple-600 dark:text-purple-400",pink:"text-pink-600 dark:text-pink-400"}[O.color]||"text-slate-600 dark:text-slate-400";switch(j){case"Active":return"text-emerald-600 dark:text-emerald-400";case"Passed":return"text-blue-600 dark:text-blue-400";case"Suspended":return"text-amber-600 dark:text-amber-400";case"Failed":return"text-rose-600 dark:text-rose-400";case"Withdrawn":return"text-slate-600 dark:text-slate-400";default:return"text-slate-600 dark:text-slate-400"}};return o.jsxs("div",{className:"w-full glass-card rounded-3xl overflow-hidden flex flex-col",children:[o.jsxs("div",{className:"p-8 border-b border-slate-100 dark:border-white/[0.06] flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-emerald-500/10 rounded-lg",children:o.jsx(vo,{className:"w-5 h-5 text-emerald-400"})}),o.jsx("h3",{className:"font-bold text-lg text-slate-900 dark:text-white",children:""}),i.length>0&&o.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-amber-500/10 text-amber-600 dark:text-amber-400 border border-amber-500/30",children:[" ",i.length," "]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("div",{className:"relative",ref:g,children:[o.jsx("button",{onClick:()=>d(!c),className:`p-2 rounded-lg transition-colors ${i.length>0?"bg-emerald-500/10 text-emerald-600 dark:text-emerald-400":"text-slate-400 hover:text-indigo-500 dark:hover:text-white"}`,title:"",children:o.jsx(ya,{className:"w-5 h-5"})}),c&&o.jsxs("div",{className:"absolute right-0 top-12 z-50 w-64 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 shadow-2xl py-2",children:[o.jsx("div",{className:"px-4 py-2 border-b border-slate-200 dark:border-slate-700",children:o.jsx("p",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400 uppercase tracking-wider",children:""})}),o.jsx("div",{className:"py-2",children:b.map(j=>o.jsxs("label",{className:"flex items-center gap-3 px-4 py-2 hover:bg-slate-50 dark:hover:bg-slate-700/50 cursor-pointer transition-colors",children:[o.jsx("input",{type:"checkbox",checked:i.includes(j),onChange:()=>v(j),className:"w-4 h-4 rounded border-slate-300 dark:border-slate-600 text-emerald-600 focus:ring-emerald-500 focus:ring-offset-0"}),o.jsx("span",{className:`text-sm font-medium ${T(j)}`,children:j})]},j))}),i.length>0&&o.jsx("div",{className:"px-4 py-2 border-t border-slate-200 dark:border-slate-700",children:o.jsx("button",{onClick:()=>l([]),className:"text-xs text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200 font-medium transition-colors",children:""})})]})]}),o.jsx("button",{className:"text-slate-400 hover:text-indigo-500 dark:hover:text-white transition-colors",children:o.jsx(Ao,{className:"w-5 h-5"})})]})]}),o.jsx("div",{className:"flex-1",children:o.jsxs("table",{className:"w-full text-left border-collapse",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"text-xs font-medium text-slate-500 uppercase tracking-wider border-b border-slate-100 dark:border-white/[0.04]",children:[o.jsx("th",{className:"px-4 py-5 whitespace-nowrap",children:" / "}),o.jsx("th",{className:"px-4 py-5 whitespace-nowrap",children:""}),o.jsx("th",{className:"px-4 py-5 whitespace-nowrap",children:""}),o.jsx("th",{className:"px-4 py-5 whitespace-nowrap",children:""}),o.jsx("th",{className:"px-4 py-5 whitespace-nowrap",children:""}),o.jsx("th",{className:"px-4 py-5 text-right whitespace-nowrap",children:""}),o.jsx("th",{className:"px-4 py-5 text-right whitespace-nowrap",children:""}),o.jsx("th",{className:"px-4 py-5 text-right whitespace-nowrap",children:""}),o.jsx("th",{className:"px-4 py-5 text-center whitespace-nowrap",children:""}),o.jsx("th",{className:"px-4 py-5 text-center whitespace-nowrap",children:""})]})}),o.jsxs("tbody",{className:"divide-y divide-slate-100 dark:divide-white/[0.04]",children:[x.map(j=>{const O=Math.abs(j.cost),A=j.revenue-O,I=w[j.id]||1,X=`${j.firm} ${I}`;return o.jsxs(te.Fragment,{children:[o.jsxs("tr",{className:"group hover:bg-slate-50 dark:hover:bg-white/[0.02] transition-colors",children:[o.jsx("td",{className:"px-4 py-5 align-middle",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-[10px] font-bold border ${j.firm==="FNF"?"bg-orange-500/10 text-orange-400 border-orange-500/20":"bg-blue-500/10 text-blue-400 border-blue-500/20"}`,children:j.firm.substring(0,2)}),o.jsxs("div",{children:[o.jsx("span",{className:"font-bold text-slate-900 dark:text-white whitespace-nowrap",children:X}),o.jsx("div",{className:"text-xs text-slate-500 font-mono mt-0.5 whitespace-nowrap",children:j.date})]})]})}),o.jsx("td",{className:"px-4 py-5 align-middle",children:o.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold border ${j.category===""?"bg-amber-500/10 text-amber-600 dark:text-amber-400 border-amber-500/30":"bg-cyan-500/10 text-cyan-600 dark:text-cyan-400 border-cyan-500/30"}`,children:j.category})}),o.jsx("td",{className:"px-4 py-5 align-middle",children:o.jsx("span",{className:"text-sm font-medium text-slate-900 dark:text-white whitespace-nowrap",children:j.size})}),o.jsx("td",{className:"px-4 py-5 align-middle",children:(()=>{const M=C(j),Ee=y(M)?.color||"",F=Te=>({red:"bg-red-500/10 text-red-600 dark:text-red-300 border-red-500/20 hover:bg-red-500/20",orange:"bg-orange-500/10 text-orange-600 dark:text-orange-300 border-orange-500/20 hover:bg-orange-500/20",amber:"bg-amber-500/10 text-amber-600 dark:text-amber-300 border-amber-500/20 hover:bg-amber-500/20",yellow:"bg-yellow-500/10 text-yellow-600 dark:text-yellow-300 border-yellow-500/20 hover:bg-yellow-500/20",lime:"bg-lime-500/10 text-lime-600 dark:text-lime-300 border-lime-500/20 hover:bg-lime-500/20",emerald:"bg-emerald-500/10 text-emerald-600 dark:text-emerald-300 border-emerald-500/20 hover:bg-emerald-500/20",teal:"bg-teal-500/10 text-teal-600 dark:text-teal-300 border-teal-500/20 hover:bg-teal-500/20",cyan:"bg-cyan-500/10 text-cyan-600 dark:text-cyan-300 border-cyan-500/20 hover:bg-cyan-500/20",blue:"bg-blue-500/10 text-blue-600 dark:text-blue-300 border-blue-500/20 hover:bg-blue-500/20",indigo:"bg-indigo-500/10 text-indigo-600 dark:text-indigo-300 border-indigo-500/20 hover:bg-indigo-500/20",violet:"bg-violet-500/10 text-violet-600 dark:text-violet-300 border-violet-500/20 hover:bg-violet-500/20",purple:"bg-purple-500/10 text-purple-600 dark:text-purple-300 border-purple-500/20 hover:bg-purple-500/20",pink:"bg-pink-500/10 text-pink-600 dark:text-pink-300 border-pink-500/20 hover:bg-pink-500/20"})[Te]||"bg-slate-100 dark:bg-slate-800 text-slate-500 dark:text-slate-400 border-slate-200 dark:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-700";return o.jsxs("button",{onClick:()=>_(j.id),className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-semibold border transition-all whitespace-nowrap ${F(Ee)}`,children:[M,o.jsx(Ze,{className:`w-3 h-3 transition-transform ${h.includes(j.id)?"rotate-180":""}`})]})})()}),o.jsx("td",{className:"px-4 py-5 align-middle",children:o.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:j.accountStage||"-"})}),o.jsx("td",{className:"px-4 py-5 text-right align-middle",children:o.jsxs("span",{className:"font-mono text-rose-500 dark:text-rose-400",children:["-$",O.toLocaleString()]})}),o.jsx("td",{className:"px-4 py-5 text-right align-middle",children:o.jsxs("span",{className:`font-mono font-bold whitespace-nowrap ${j.revenue>0?"text-emerald-500 dark:text-emerald-400":"text-slate-400 dark:text-slate-600"}`,children:[j.revenue>0?"+":"","$",j.revenue.toLocaleString()]})}),o.jsx("td",{className:"px-4 py-5 text-right align-middle",children:o.jsxs("span",{className:`font-mono font-bold ${A>0?"text-emerald-500 dark:text-emerald-400":A<0?"text-rose-500 dark:text-rose-400":"text-slate-400 dark:text-slate-600"}`,children:[A>0?"+":"","$",A.toLocaleString()]})}),o.jsx("td",{className:"px-4 py-5 text-center align-middle",children:(()=>{const M=k(j);return M?o.jsxs("button",{onClick:()=>N(j.id),className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full border text-xs font-semibold transition-all whitespace-nowrap ${M==="Active"?"bg-emerald-500/10 text-emerald-600 dark:text-emerald-400 border-emerald-500/30 hover:bg-emerald-500/20":M==="Passed"?"bg-blue-500/10 text-blue-600 dark:text-blue-400 border-blue-500/30 hover:bg-blue-500/20":M==="Suspended"?"bg-amber-500/10 text-amber-600 dark:text-amber-400 border-amber-500/30 hover:bg-amber-500/20":M==="Failed"?"bg-rose-500/10 text-rose-600 dark:text-rose-400 border-rose-500/30 hover:bg-rose-500/20":M==="Withdrawn"?"bg-slate-500/10 text-slate-600 dark:text-slate-400 border-slate-500/30 hover:bg-slate-500/20":"bg-slate-100 dark:bg-slate-800 text-slate-500 dark:text-slate-400 border-slate-200 dark:border-slate-700 hover:bg-slate-200 dark:hover:bg-slate-700"}`,children:[M,o.jsx(Ze,{className:`w-3 h-3 transition-transform ${f.includes(j.id)?"rotate-180":""}`})]}):o.jsx("span",{className:"text-slate-400 dark:text-slate-600 text-xs",children:"-"})})()}),o.jsx("td",{className:"px-4 py-5 text-center align-middle",children:o.jsxs("div",{className:"flex items-center justify-center gap-1",children:[o.jsx("button",{onClick:()=>e(j),className:"p-2 rounded-lg text-slate-400 dark:text-slate-500 hover:bg-slate-100 dark:hover:bg-white/[0.05] hover:text-indigo-500 dark:hover:text-indigo-400 transition-colors",children:o.jsx(wr,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>r(j.id),className:"p-2 rounded-lg text-slate-400 dark:text-slate-500 hover:bg-rose-500/10 hover:text-rose-500 transition-colors",children:o.jsx(pt,{className:"w-4 h-4"})})]})})]}),h.includes(j.id)&&(()=>{const M=C(j),U=y(M);return!U||Object.keys(U).length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:10,className:"px-8 py-4 bg-slate-50 dark:bg-white/[0.02] border-t border-slate-100 dark:border-white/[0.04]",children:o.jsxs("div",{className:"text-center text-sm text-slate-500 dark:text-slate-400 italic",children:[" (",M,") "]})})}):o.jsx("tr",{children:o.jsxs("td",{colSpan:10,className:"px-8 py-6 bg-slate-50 dark:bg-white/[0.02] border-t border-slate-100 dark:border-white/[0.04]",children:[o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[U.drawdownType&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("div",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400",children:""}),o.jsx("div",{className:"text-sm font-medium text-slate-900 dark:text-white",children:U.drawdownType})]}),U.maxDrawdown&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("div",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400",children:""}),o.jsx("div",{className:"text-sm font-medium text-slate-900 dark:text-white",children:U.maxDrawdown})]}),U.dailyDrawdown&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("div",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400",children:""}),o.jsx("div",{className:"text-sm font-medium text-slate-900 dark:text-white",children:U.dailyDrawdown})]}),U.profitTarget&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("div",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400",children:""}),o.jsx("div",{className:"text-sm font-medium text-emerald-600 dark:text-emerald-400",children:U.profitTarget})]}),U.tradingDaysRequired&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("div",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400",children:""}),o.jsx("div",{className:"text-sm font-medium text-slate-900 dark:text-white",children:U.tradingDaysRequired})]}),U.minimumProfitAmount&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("div",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400",children:""}),o.jsx("div",{className:"text-sm font-medium text-slate-900 dark:text-white",children:U.minimumProfitAmount})]}),U.consistency&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("div",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400",children:""}),o.jsx("div",{className:"text-sm font-medium text-slate-900 dark:text-white",children:U.consistency})]}),U.maxContracts&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("div",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400",children:""}),o.jsx("div",{className:"text-sm font-medium text-slate-900 dark:text-white",children:U.maxContracts})]}),U.maxPayout&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("div",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400",children:""}),o.jsx("div",{className:"text-sm font-medium text-emerald-600 dark:text-emerald-400",children:U.maxPayout})]}),U.payoutFrequency&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("div",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400",children:""}),o.jsx("div",{className:"text-sm font-medium text-slate-900 dark:text-white",children:U.payoutFrequency})]}),U.newsTrading&&o.jsxs("div",{className:"space-y-1",children:[o.jsx("div",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400",children:""}),o.jsx("div",{className:`text-sm font-medium ${U.newsTrading===""?"text-emerald-600 dark:text-emerald-400":"text-rose-600 dark:text-rose-400"}`,children:U.newsTrading})]})]}),U.notes&&o.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 dark:border-white/[0.06]",children:[o.jsx("div",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 mb-2",children:""}),o.jsx("div",{className:"text-sm text-slate-700 dark:text-slate-300",children:U.notes})]})]})})})(),f.includes(j.id)&&(()=>{const M=j.accountRecords||[];return M.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:10,className:"px-8 py-4 bg-slate-50 dark:bg-white/[0.02] border-t border-slate-100 dark:border-white/[0.04]",children:o.jsx("div",{className:"text-center text-sm text-slate-500 dark:text-slate-400 italic",children:""})})}):o.jsx("tr",{children:o.jsx("td",{colSpan:10,className:"px-8 py-6 bg-slate-50 dark:bg-white/[0.02] border-t border-slate-100 dark:border-white/[0.04]",children:o.jsxs("div",{className:"space-y-3",children:[o.jsx("div",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3",children:""}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-slate-200 dark:border-slate-700",children:[o.jsx("th",{className:"text-left py-2 px-3 text-xs font-semibold text-slate-600 dark:text-slate-400",children:""}),o.jsx("th",{className:"text-left py-2 px-3 text-xs font-semibold text-slate-600 dark:text-slate-400",children:""}),o.jsx("th",{className:"text-left py-2 px-3 text-xs font-semibold text-slate-600 dark:text-slate-400",children:""}),o.jsx("th",{className:"text-left py-2 px-3 text-xs font-semibold text-slate-600 dark:text-slate-400",children:""}),o.jsx("th",{className:"text-right py-2 px-3 text-xs font-semibold text-slate-600 dark:text-slate-400",children:""})]})}),o.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:M.map((U,Ee)=>{const F=V(U.status);return o.jsxs("tr",{className:"hover:bg-slate-100 dark:hover:bg-white/[0.02]",children:[o.jsx("td",{className:"py-2 px-3 text-slate-700 dark:text-slate-300 font-mono text-xs",children:U.date}),o.jsx("td",{className:"py-2 px-3",children:o.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold ${F==="Active"?"bg-emerald-500/10 text-emerald-600 dark:text-emerald-400":F==="Passed"?"bg-blue-500/10 text-blue-600 dark:text-blue-400":F==="Suspended"?"bg-amber-500/10 text-amber-600 dark:text-amber-400":F==="Failed"?"bg-rose-500/10 text-rose-600 dark:text-rose-400":"bg-slate-500/10 text-slate-600 dark:text-slate-400"}`,children:F})}),o.jsx("td",{className:"py-2 px-3 text-slate-700 dark:text-slate-300",children:U.type}),o.jsx("td",{className:"py-2 px-3 text-slate-700 dark:text-slate-300 font-mono text-xs",children:U.number||"-"}),o.jsx("td",{className:"py-2 px-3 text-right text-slate-700 dark:text-slate-300 font-mono",children:U.extraCost>0?`-$${Number(U.extraCost).toLocaleString()}`:"-"})]},U.id||`record-${Ee}`)})})]})})]})})})})()]},j.id)}),x.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:10,className:"px-8 py-16 text-center text-slate-500 dark:text-slate-500",children:t.length===0?"":""})})]})]})})]})},xa=({label:t,type:e="text",placeholder:r,value:s,onChange:n,required:a=!0})=>o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase ml-1",children:t}),o.jsx("input",{type:e,required:a,placeholder:r,value:s,onChange:n,className:"w-full bg-slate-100 dark:bg-[#18181b] border border-slate-200 dark:border-white/[0.08] rounded-xl px-4 py-3 text-sm text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-transparent transition-all placeholder:text-slate-400 dark:placeholder:text-slate-600"})]}),jt=({label:t,value:e,onChange:r,options:s})=>o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase ml-1",children:t}),o.jsxs("div",{className:"relative",children:[o.jsx("select",{value:e,onChange:r,className:"w-full bg-slate-100 dark:bg-[#18181b] border border-slate-200 dark:border-white/[0.08] rounded-xl px-4 py-3 text-sm text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-transparent transition-all appearance-none cursor-pointer",children:s.map((n,a)=>{const i=typeof n=="string"?n:n.name;return o.jsx("option",{value:i,children:i},i||a)})}),o.jsx(Ze,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500 pointer-events-none"})]})]}),Et=t=>V(t,"Active"),sg=({isOpen:t,onClose:e,isEditing:r,formData:s,setFormData:n,handleSubmit:a,accountStages:i=[],accountTypes:l=[],accountSizes:c=[],accountStatuses:d=["Active","Suspended","Failed","Passed","Withdrawn"],availableFirms:h=[]})=>t?o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[o.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),o.jsxs("div",{className:"relative w-full max-w-3xl bg-white dark:bg-[#0e0e11] border border-slate-200 dark:border-white/[0.08] rounded-3xl shadow-2xl overflow-hidden scale-in-center animate-in fade-in zoom-in-95 duration-200",children:[o.jsxs("div",{className:"px-8 py-6 border-b border-slate-100 dark:border-white/[0.06] flex items-center justify-between bg-slate-50/50 dark:bg-white/[0.02]",children:[o.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[r?o.jsx(wr,{className:"w-5 h-5 text-indigo-500"}):o.jsx(ir,{className:"w-5 h-5 text-indigo-500"}),r?"":""]}),o.jsx("button",{onClick:e,className:"text-slate-400 hover:text-slate-900 dark:hover:text-white transition-colors",children:o.jsx(lr,{className:"w-5 h-5"})})]}),o.jsxs("form",{onSubmit:a,className:"p-8 space-y-5",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[o.jsx(xa,{label:"",type:"date",value:s.date,onChange:u=>n({...s,date:u.target.value})}),o.jsx(jt,{label:"",value:s.category,onChange:u=>n({...s,category:u.target.value,firm:""}),options:["","CFD"]}),o.jsxs("div",{className:"space-y-1.5",children:[o.jsxs("label",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase ml-1",children:[" (",s.category,")"]}),o.jsxs("div",{className:"relative",children:[o.jsxs("select",{required:!0,value:s.firm,onChange:u=>n({...s,firm:u.target.value}),className:"w-full bg-slate-100 dark:bg-[#18181b] border border-slate-200 dark:border-white/[0.08] rounded-xl px-4 py-3 text-sm text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-indigo-500/50 focus:border-transparent transition-all appearance-none cursor-pointer",children:[o.jsx("option",{value:"",disabled:!0,children:""}),h.map(u=>o.jsx("option",{value:u.name,children:u.name},u.name))]}),o.jsx(Ze,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500 pointer-events-none"})]})]}),o.jsx(jt,{label:"",value:s.accountStage,onChange:u=>n({...s,accountStage:u.target.value}),options:i}),o.jsx(jt,{label:"",value:s.phase,onChange:u=>n({...s,phase:u.target.value}),options:l}),o.jsx(jt,{label:"",value:s.size,onChange:u=>n({...s,size:u.target.value}),options:c}),o.jsx(xa,{label:" ($)",type:"number",value:s.baseCost,onChange:u=>n({...s,baseCost:u.target.value})}),o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase ml-1",children:" ()"}),o.jsxs("div",{className:"w-full bg-slate-100 dark:bg-[#18181b] border border-slate-200 dark:border-white/[0.08] rounded-xl px-4 py-3 text-sm text-slate-500 dark:text-slate-400 font-mono",children:["$",(Number(s.baseCost||0)+(s.accountRecords||[]).reduce((u,f)=>u+Number(f.extraCost||0),0)).toLocaleString()]})]}),o.jsx("div",{className:"col-span-2",children:o.jsx(jt,{label:"",value:Et(s.accountStatus)||Et(d[0]),onChange:u=>n({...s,accountStatus:u.target.value}),options:d})}),o.jsxs("div",{className:"col-span-2 space-y-3 bg-slate-50 dark:bg-white/[0.02] p-4 rounded-xl border border-slate-100 dark:border-white/[0.05]",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("label",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 ml-1 flex-1",children:[" (: $",(s.accountRecords||[]).reduce((u,f)=>u+Number(f.extraCost||0),0).toLocaleString(),")"]}),o.jsxs("button",{type:"button",onClick:()=>{const u={id:Date.now(),date:new Date().toISOString().split("T")[0],status:Et(d?.[0]),type:s.phase,number:"",extraCost:0};n({...s,accountRecords:[...s.accountRecords||[],u]})},className:"text-xs font-bold text-indigo-500 hover:text-indigo-400 flex items-center gap-1 bg-indigo-500/10 px-2 py-1 rounded-lg transition-colors whitespace-nowrap",children:[o.jsx(ir,{className:"w-3 h-3"})," "]})]}),(s.accountRecords||[]).length>0&&o.jsxs("div",{className:"grid grid-cols-12 gap-3 px-1 pb-1 border-b border-slate-200 dark:border-white/[0.08]",children:[o.jsx("div",{className:"col-span-2 text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase",children:""}),o.jsx("div",{className:"col-span-2 text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase",children:""}),o.jsx("div",{className:"col-span-2 text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase",children:""}),o.jsx("div",{className:"col-span-3 text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase",children:""}),o.jsx("div",{className:"col-span-2 text-[10px] font-bold text-slate-500 dark:text-slate-400 uppercase",children:""}),o.jsx("div",{className:"col-span-1"})]}),o.jsxs("div",{className:"space-y-3",children:[(s.accountRecords||[]).map((u,f)=>o.jsxs("div",{className:"grid grid-cols-12 gap-3 items-start animate-in fade-in slide-in-from-top-2 duration-200",children:[o.jsx("div",{className:"col-span-2",children:o.jsx("input",{type:"date",value:u.date,onChange:p=>{const g=[...s.accountRecords];g[f].date=p.target.value,n({...s,accountRecords:g})},className:"w-full bg-white dark:bg-[#18181b] border border-slate-200 dark:border-white/[0.08] rounded-lg px-2 py-2 text-xs text-slate-900 dark:text-white focus:outline-none focus:ring-1 focus:ring-indigo-500",placeholder:""})}),o.jsxs("div",{className:"col-span-2 relative",children:[o.jsx("select",{value:Et(u.status)||Et(d[0]),onChange:p=>{const g=[...s.accountRecords];g[f].status=p.target.value,n({...s,accountRecords:g})},className:"w-full bg-emerald-50 dark:bg-emerald-900/20 border-2 border-emerald-500 dark:border-emerald-600 rounded-lg px-2 py-2 text-xs text-slate-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-emerald-500 appearance-none cursor-pointer font-bold",children:d.map((p,g)=>{const m=typeof p=="string"?p:p.name;return o.jsx("option",{value:m,children:m},m||g)})}),o.jsx(Ze,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-3 h-3 text-emerald-600 dark:text-emerald-400 pointer-events-none"})]}),o.jsxs("div",{className:"col-span-2 relative",children:[o.jsx("select",{value:u.type||s.phase,onChange:p=>{const g=[...s.accountRecords];g[f].type=p.target.value,n({...s,accountRecords:g})},className:"w-full bg-white dark:bg-[#18181b] border border-slate-200 dark:border-white/[0.08] rounded-lg px-2 py-2 text-xs text-slate-900 dark:text-white focus:outline-none focus:ring-1 focus:ring-indigo-500 appearance-none cursor-pointer",children:l.map((p,g)=>{const m=typeof p=="string"?p:p.name;return o.jsx("option",{value:m,children:m},m||g)})}),o.jsx(Ze,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-3 h-3 text-slate-500 dark:text-slate-400 pointer-events-none"})]}),o.jsx("div",{className:"col-span-3",children:o.jsx("input",{type:"text",value:u.number,onChange:p=>{const g=[...s.accountRecords];g[f].number=p.target.value,n({...s,accountRecords:g})},className:"w-full bg-white dark:bg-[#18181b] border border-slate-200 dark:border-white/[0.08] rounded-lg px-2 py-2 text-xs text-slate-900 dark:text-white focus:outline-none focus:ring-1 focus:ring-indigo-500 font-mono",placeholder:""})}),o.jsx("div",{className:"col-span-2",children:o.jsx("input",{type:"number",value:u.extraCost,onChange:p=>{const g=[...s.accountRecords];g[f].extraCost=p.target.value,n({...s,accountRecords:g})},className:"w-full bg-white dark:bg-[#18181b] border border-slate-200 dark:border-white/[0.08] rounded-lg px-2 py-2 text-xs text-slate-900 dark:text-white focus:outline-none focus:ring-1 focus:ring-indigo-500 font-mono",placeholder:""})}),o.jsx("div",{className:"col-span-1 flex justify-center pt-2",children:o.jsx("button",{type:"button",onClick:()=>{n({...s,accountRecords:s.accountRecords.filter(p=>p.id!==u.id)})},className:"text-slate-400 hover:text-rose-500 transition-colors",children:o.jsx(pt,{className:"w-4 h-4"})})})]},u.id)),(s.accountRecords||[]).length===0&&o.jsx("div",{className:"text-center py-4 text-xs text-slate-400 italic",children:""})]})]}),o.jsxs("div",{className:"col-span-2 space-y-3 bg-slate-50 dark:bg-white/[0.02] p-4 rounded-xl border border-slate-100 dark:border-white/[0.05]",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("label",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 ml-1 flex-1",children:[" (: $",(s.payouts||[]).reduce((u,f)=>f.arrived===""?u+(Number(f.amount)||0):u,0).toLocaleString(),")"]}),o.jsxs("button",{type:"button",onClick:()=>{const u={id:Date.now(),date:new Date().toISOString().split("T")[0],amount:"",arrivalDate:"",arrived:"",notes:""};n({...s,payouts:[...s.payouts||[],u]})},className:"text-xs font-bold text-indigo-500 hover:text-indigo-400 flex items-center gap-1 bg-indigo-500/10 px-2 py-1 rounded-lg transition-colors whitespace-nowrap",children:[o.jsx(ir,{className:"w-3 h-3"})," "]})]}),o.jsxs("div",{className:"space-y-3",children:[(s.payouts||[]).map((u,f)=>o.jsxs("div",{className:"grid grid-cols-12 gap-3 items-start animate-in fade-in slide-in-from-top-2 duration-200",children:[o.jsx("div",{className:"col-span-2",children:o.jsx("input",{type:"date",value:u.date,onChange:p=>{const g=[...s.payouts];g[f].date=p.target.value,n({...s,payouts:g})},className:"w-full bg-white dark:bg-[#18181b] border border-slate-200 dark:border-white/[0.08] rounded-lg px-2 py-2 text-xs text-slate-900 dark:text-white focus:outline-none focus:ring-1 focus:ring-indigo-500",placeholder:""})}),o.jsx("div",{className:"col-span-2",children:o.jsx("input",{type:"number",value:u.amount,onChange:p=>{const g=[...s.payouts];g[f].amount=p.target.value,n({...s,payouts:g})},className:"w-full bg-white dark:bg-[#18181b] border border-slate-200 dark:border-white/[0.08] rounded-lg px-2 py-2 text-xs text-slate-900 dark:text-white focus:outline-none focus:ring-1 focus:ring-indigo-500 font-mono",placeholder:""})}),o.jsx("div",{className:"col-span-2",children:o.jsx("input",{type:"text",value:u.arrivalDate,onChange:p=>{const g=[...s.payouts];g[f].arrivalDate=p.target.value,n({...s,payouts:g})},className:"w-full bg-white dark:bg-[#18181b] border border-slate-200 dark:border-white/[0.08] rounded-lg px-2 py-2 text-xs text-slate-900 dark:text-white focus:outline-none focus:ring-1 focus:ring-indigo-500",placeholder:""})}),o.jsx("div",{className:"col-span-2",children:o.jsxs("select",{value:u.arrived||"",onChange:p=>{const g=[...s.payouts];g[f].arrived=p.target.value,n({...s,payouts:g})},className:"w-full bg-white dark:bg-[#18181b] border border-slate-200 dark:border-white/[0.08] rounded-lg px-2 py-2 text-xs text-slate-900 dark:text-white focus:outline-none focus:ring-1 focus:ring-indigo-500",children:[o.jsx("option",{value:"",children:""}),o.jsx("option",{value:"",children:""}),o.jsx("option",{value:"",children:""})]})}),o.jsx("div",{className:"col-span-3",children:o.jsx("input",{type:"text",value:u.notes,onChange:p=>{const g=[...s.payouts];g[f].notes=p.target.value,n({...s,payouts:g})},className:"w-full bg-white dark:bg-[#18181b] border border-slate-200 dark:border-white/[0.08] rounded-lg px-2 py-2 text-xs text-slate-900 dark:text-white focus:outline-none focus:ring-1 focus:ring-indigo-500",placeholder:""})}),o.jsx("div",{className:"col-span-1 flex justify-center pt-2",children:o.jsx("button",{type:"button",onClick:()=>{n({...s,payouts:s.payouts.filter(p=>p.id!==u.id)})},className:"text-slate-400 hover:text-rose-500 transition-colors",children:o.jsx(pt,{className:"w-4 h-4"})})})]},u.id)),(s.payouts||[]).length===0&&o.jsx("div",{className:"text-center py-4 text-xs text-slate-400 italic",children:""})]})]})]}),o.jsx("button",{type:"submit",className:"w-full mt-4 bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3.5 rounded-xl transition-all shadow-lg shadow-indigo-600/25",children:r?"":""})]})]})]}):null,ug=()=>{const{theme:t,toggleTheme:e}=lo(),[r,s]=S.useState(null);S.useEffect(()=>{Se.auth.getSession().then(({data:{session:$}})=>{s($)});const{data:{subscription:E}}=Se.auth.onAuthStateChange(($,W)=>{s(W)});return()=>E.unsubscribe()},[]);const[n,a]=S.useState([]),[i,l]=S.useState(!0),[c,d]=S.useState([{name:"Tradeify",type:""},{name:"Apex",type:""},{name:"Topstep",type:""},{name:"FNF",type:"CFD"},{name:"Funding Pips",type:"CFD"}]),[h,u]=S.useState(["25K","50K","100K","150K","200K","300K","400K"]),[f,p]=S.useState(["1","2",""]),[g,m]=S.useState(["","Live","PA","Express","Funded"]),[b,x]=S.useState(["Active","Suspended","Failed","Passed","Withdrawn"]),[w,v]=S.useState("All"),[_,N]=S.useState([]),[y,k]=S.useState([]),[C,T]=S.useState({start:"",end:""}),[j,O]=S.useState(!1),[A,I]=S.useState(!1),[X,M]=S.useState(!1),[U,Ee]=S.useState(null),[F,Te]=S.useState({date:new Date().toISOString().split("T")[0],firm:"",category:"",accountStage:"",phase:"",size:"50K",baseCost:0,cost:0,revenue:0,status:"Active",accountStatus:"Active",payouts:[],accountRecords:[]}),me=S.useMemo(()=>{let E=n;return w!=="All"&&(E=E.filter($=>$.category===w)),_.length>0&&(E=E.filter($=>_.includes($.firm))),y.length>0&&(E=E.filter($=>y.includes($.accountStage))),C.start&&(E=E.filter($=>$.date>=C.start)),C.end&&(E=E.filter($=>$.date<=C.end)),E},[n,w,_,y,C]);S.useEffect(()=>{N([])},[w]);const wt=S.useMemo(()=>w==="All"?[...new Set(c.map($=>$.name))]:c.filter(E=>E.type===w).map(E=>E.name),[c,w]),De=S.useMemo(()=>{const E=me.reduce((Q,z)=>Q+Math.abs(Number(z.cost)),0),$=me.reduce((Q,z)=>Q+Number(z.revenue),0),W=$-E,K=E>0?($/E*100).toFixed(1):0;return{totalExpenses:E,totalRevenue:$,netProfit:W,roi:K}},[me]),se=S.useMemo(()=>{const E=me.reduce((G,Z)=>G+Math.abs(Z.cost),0),$=me.reduce((G,Z)=>G+Z.revenue,0),W=$-E,K=me.reduce((G,Z)=>(G[Z.firm]||(G[Z.firm]={cost:0,revenue:0}),G[Z.firm].cost+=Math.abs(Z.cost),G[Z.firm].revenue+=Z.revenue,G),{}),Q=["#3b82f6","#10b981","#f59e0b","#8b5cf6","#ec4899","#06b6d4","#f43f5e","#6366f1"],z=G=>Q[G%Q.length],ie=Object.keys(K),$e=ie.map((G,Z)=>({label:G,value:K[G].revenue,color:z(Z)})).filter(G=>G.value>0).sort((G,Z)=>Z.value-G.value),ro=ie.map((G,Z)=>({label:G,value:K[G].cost,color:z(Z+2)})).filter(G=>G.value>0).sort((G,Z)=>Z.value-G.value),so=E,en=ie.map((G,Z)=>{const tn=K[G],ao=tn.revenue-tn.cost;return{label:G,value:ao,color:z(Z+4)}}).filter(G=>G.value>0).sort((G,Z)=>Z.value-G.value),no=en.reduce((G,Z)=>G+Z.value,0);return{totalExpenses:E,totalRevenue:$,netProfit:W,roi:E>0?$/E*100:0,payoutStats:$e,costStats:ro,totalCostForChart:so,marginStats:en,totalPositiveNetProfit:no}},[me]),Jt=S.useMemo(()=>c.filter(E=>E.type===F.category),[c,F.category]),Ce=S.useMemo(()=>{const E=[],$=W=>{W&&(Array.isArray(W)?W.forEach(K=>{K.name&&E.push(K.name)}):W.name&&E.push(W.name))};return g.forEach(W=>{typeof W=="string"?E.push(W):W.name&&!W.id?E.push(W.name):W.id&&($(W.phase1),$(W.phase2),$(W.funded))}),E},[g]),tt=async()=>{if(r?.user)try{const{data:E,error:$}=await Se.from("transactions").select("*").eq("user_id",r.user.id).order("date",{ascending:!1});if($)throw $;const W=E.map(K=>({...K,baseCost:K.base_cost,accountStage:K.account_stage,accountRecords:K.account_records,accountStatus:K.account_status,cost:(Number(K.base_cost)||0)+(K.account_records||[]).reduce((Q,z)=>{const ie=Number(z?.extraCost);return Q+(isNaN(ie)?0:ie)},0),revenue:(K.payouts||[]).reduce((Q,z)=>{if(z?.arrived!=="")return Q;const ie=Number(z?.amount);return Q+(isNaN(ie)?0:ie)},0)}));a(W)}catch(E){console.error("Error fetching transactions:",E),ue.error("")}},Yt=async()=>{if(r?.user)try{const{data:E,error:$}=await Se.from("user_settings").select("*").eq("user_id",r.user.id).single();if($&&$.code!=="PGRST116")throw $;if(E){let W=E.firms&&E.firms.length>0?E.firms:c;W=W.filter(K=>K.name!=="IBKR"),d(W),E.account_sizes&&E.account_sizes.length>0&&u(E.account_sizes),E.account_stages&&E.account_stages.length>0&&p(E.account_stages),E.account_types&&E.account_types.length>0&&m(E.account_types),E.account_statuses&&E.account_statuses.length>0&&x(E.account_statuses)}else await Pe(c,h,f,g,b)}catch(E){console.error("Error fetching settings:",E),ue.error("")}};S.useEffect(()=>{let E=!0;return(async()=>{if(r){l(!0);try{await Yt(),await tt()}finally{E&&l(!1)}}else l(!1)})(),()=>{E=!1}},[r]),S.useEffect(()=>{Ce.length>0&&!F.phase&&Te(E=>({...E,phase:Ce[0]}))},[Ce,F.phase]);const Dr=async E=>{if(E.preventDefault(),!F.firm?.trim()){ue.error("");return}if(!F.date){ue.error("");return}if(!F.category){ue.error("");return}const $=(F.payouts||[]).reduce((Q,z)=>{if(z?.arrived!=="")return Q;const ie=Number(z?.amount);return Q+(isNaN(ie)?0:ie)},0);(Number(F.baseCost)||0)+(F.accountRecords||[]).reduce((Q,z)=>{const ie=Number(z?.extraCost);return Q+(isNaN(ie)?0:ie)},0);let W=V(F.accountStatus,"Active");if(F.accountRecords&&F.accountRecords.length>0){const z=[...F.accountRecords].sort((ie,$e)=>new Date($e.date)-new Date(ie.date))[0];z.status&&(W=V(z.status))}const K={date:F.date,firm:F.firm,category:F.category,account_stage:F.accountStage,phase:F.phase,size:F.size,base_cost:F.baseCost,payouts:F.payouts||[],account_records:F.accountRecords||[],account_status:W,status:$>0?"Payout":"Active",user_id:r.user.id};try{if(U){const{data:Q,error:z}=await Se.from("transactions").update(K).eq("id",U).select();if(z)throw z;ue.success("")}else{const{data:Q,error:z}=await Se.from("transactions").insert([K]).select();if(z)throw z;ue.success("")}tt(),Zs()}catch(Q){console.error("Error saving transaction:",Q),ue.error(": "+Q.message)}},rt=S.useCallback(async E=>{if(confirm(""))try{const{error:$}=await Se.from("transactions").delete().eq("id",E);if($)throw $;a(W=>W.filter(K=>K.id!==E)),ue.success("")}catch($){console.error("Error deleting transaction:",$),ue.error(": "+$.message)}},[]),Pe=async(E,$,W,K,Q)=>{if(r?.user)try{const z={user_id:r.user.id,firms:E||c,account_sizes:$||h,account_stages:W||f,account_types:K||g,account_statuses:Q||b},{data:ie,error:$e}=await Se.from("user_settings").upsert(z,{onConflict:"user_id"}).select();if($e)throw console.error("Error saving settings:",$e),ue.error(": "+($e.message||$e.code||"Unknown error")),$e;ue.success("")}catch(z){console.error("Error saving settings:",z),ue.error("")}},Qs=E=>{d(E),Pe(E,null,null,null,null)},ge=E=>{u(E),Pe(null,E,null,null,null)},qe=E=>{p(E),Pe(null,null,E,null,null)},Zi=E=>{m(E),Pe(null,null,null,E,null).catch($=>{console.error("Failed to save account types:",$)})},eo=E=>{x(E),Pe(null,null,null,null,E)},Zs=S.useCallback(()=>{O(!1),Ee(null),Te({date:new Date().toISOString().split("T")[0],firm:"",category:"",accountStage:f[0]||"",phase:Ce[0]||"",size:"50K",baseCost:0,cost:0,revenue:0,status:"Active",accountStatus:"Active",payouts:[],accountRecords:[]})},[f,Ce]),to=S.useCallback(E=>{Ee(E.id),Te({...E,baseCost:E.baseCost!==void 0?E.baseCost:E.cost,payouts:E.payouts||[],accountRecords:E.accountRecords||[]}),O(!0)},[]);return r?o.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-[#050911] text-slate-800 dark:text-slate-200 font-sans selection:bg-emerald-500/30 overflow-x-hidden relative transition-colors duration-300",children:[o.jsx("div",{className:"fixed inset-0 z-0 pointer-events-none",children:o.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(to_right,#e2e8f0_1px,transparent_1px),linear-gradient(to_bottom,#e2e8f0_1px,transparent_1px)] dark:bg-[linear-gradient(to_right,#1f2937_1px,transparent_1px),linear-gradient(to_bottom,#1f2937_1px,transparent_1px)] bg-[size:4rem_4rem] [mask-image:radial-gradient(ellipse_60%_50%_at_50%_0%,#000_70%,transparent_100%)] opacity-[0.15]"})}),o.jsxs("div",{className:"max-w-7xl mx-auto p-6 lg:p-10 space-y-12 relative z-10",children:[o.jsxs("header",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6",children:[o.jsxs(rn,{to:"/",className:"group cursor-pointer",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-emerald-500 to-cyan-600 rounded-xl shadow-[0_0_15px_rgba(16,185,129,0.3)] group-hover:shadow-[0_0_25px_rgba(16,185,129,0.5)] transition-all duration-300",children:o.jsx(ka,{className:"w-6 h-6 text-white"})}),o.jsxs("h1",{className:"text-3xl font-bold tracking-tight text-slate-900 dark:text-white group-hover:text-emerald-600 dark:group-hover:text-emerald-400 transition-colors",children:["Propfirm ",o.jsx("span",{className:"text-slate-500 dark:text-slate-500 group-hover:text-slate-400 transition-colors",children:""})]})]}),o.jsx("p",{className:"text-slate-600 dark:text-slate-400 text-sm font-medium ml-1 group-hover:text-slate-500 dark:group-hover:text-slate-300 transition-colors",children:""})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs(rn,{to:"/",className:"flex items-center gap-2 px-4 py-2.5 rounded-xl bg-white dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700/50 hover:border-emerald-500/30 transition-all text-slate-700 dark:text-slate-300 hover:text-emerald-600 dark:hover:text-white font-medium text-sm",title:"",children:[o.jsx(po,{className:"w-5 h-5"}),o.jsx("span",{className:"hidden sm:inline",children:""})]}),o.jsx("button",{onClick:e,className:"p-3 rounded-xl bg-white dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700/50 hover:border-emerald-500/30 transition-all text-slate-700 dark:text-slate-300 hover:text-emerald-600 dark:hover:text-white",title:t==="dark"?"":"",children:t==="dark"?o.jsx(co,{className:"w-5 h-5"}):o.jsx(uo,{className:"w-5 h-5"})}),o.jsx("button",{onClick:()=>I(!0),className:"p-3 rounded-xl bg-white dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700/50 hover:border-emerald-500/30 transition-all text-slate-700 dark:text-slate-300 hover:text-emerald-600 dark:hover:text-white",title:"",children:o.jsx(Ss,{className:"w-5 h-5"})}),o.jsx("button",{onClick:()=>M(!0),className:"p-3 rounded-xl bg-white dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700/50 hover:border-emerald-500/30 transition-all text-slate-700 dark:text-slate-300 hover:text-emerald-600 dark:hover:text-white",title:"",children:o.jsx(_a,{className:"w-5 h-5"})})]})]}),o.jsxs("div",{className:"bg-white dark:bg-[#111827] p-4 rounded-2xl border border-slate-200 dark:border-slate-800 shadow-lg animate-in fade-in slide-in-from-top-4 duration-500 space-y-4",children:[o.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-3",children:[o.jsxs("div",{className:"relative group min-w-[180px] w-full md:w-auto",children:[o.jsx(ya,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500 group-hover:text-emerald-400 transition-colors"}),o.jsxs("select",{value:w,onChange:E=>v(E.target.value),className:"w-full pl-10 pr-10 py-2.5 bg-slate-50 dark:bg-black/20 border border-slate-300 dark:border-slate-700 rounded-xl text-sm font-bold text-slate-700 dark:text-slate-300 focus:outline-none focus:ring-2 focus:ring-emerald-500/50 hover:bg-slate-100 dark:hover:bg-slate-800/50 transition-all appearance-none cursor-pointer",children:[o.jsx("option",{value:"All",children:""}),o.jsx("option",{value:"",children:""}),o.jsx("option",{value:"CFD",children:"CFD / "})]}),o.jsx("div",{className:"absolute right-3.5 top-1/2 -translate-y-1/2 pointer-events-none",children:o.jsx(Ze,{className:"w-3 h-3 text-slate-400"})})]}),o.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 dark:bg-black/20 p-2 rounded-xl border border-slate-300 dark:border-slate-700",children:[o.jsx("input",{type:"date",value:C.start,onChange:E=>T({...C,start:E.target.value}),className:"bg-transparent text-xs font-mono font-medium text-slate-400 focus:outline-none w-[100px] px-1",title:""}),o.jsx("span",{className:"text-slate-500",children:"-"}),o.jsx("input",{type:"date",value:C.end,onChange:E=>T({...C,end:E.target.value}),className:"bg-transparent text-xs font-mono font-medium text-slate-400 focus:outline-none w-[100px] px-1",title:""}),(C.start||C.end)&&o.jsx("button",{onClick:()=>T({start:"",end:""}),className:"p-1 hover:bg-rose-500/10 rounded-md text-slate-400 hover:text-rose-500 transition-colors",children:o.jsx("span",{className:"text-[10px] font-bold",children:""})})]}),o.jsx("div",{className:"flex-1"}),o.jsxs("button",{onClick:()=>{Ee(null),Te({date:new Date().toISOString().split("T")[0],firm:"",category:"",accountStage:f[0]||"",phase:Ce[0]||"",size:"50K",baseCost:0,cost:0,revenue:0,status:"Active",accountStatus:"Active",payouts:[],accountRecords:[]}),O(!0)},className:"flex items-center gap-2 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500 text-white px-4 py-2.5 rounded-xl font-bold text-xs transition-all shadow-lg shadow-emerald-600/20 hover:scale-105 active:scale-95 ml-2 min-w-fit",children:[o.jsx(ir,{className:"w-3.5 h-3.5"})," "]})]}),o.jsxs("div",{className:"space-y-3 pt-2 border-t border-slate-200 dark:border-slate-700",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2",children:"FILTER"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:wt.map(E=>o.jsx("button",{onClick:()=>{_.includes(E)?N(_.filter($=>$!==E)):N([..._,E])},className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-all ${_.includes(E)?"bg-emerald-500 text-white shadow-lg shadow-emerald-500/30":"bg-slate-100 dark:bg-slate-800/50 text-slate-600 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700/50"}`,children:E},E))})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2",children:""}),o.jsx("div",{className:"flex flex-wrap gap-2",children:f.map(E=>o.jsx("button",{onClick:()=>{y.includes(E)?k(y.filter($=>$!==E)):k([...y,E])},className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-all ${y.includes(E)?"bg-purple-500 text-white shadow-lg shadow-purple-500/30":"bg-slate-100 dark:bg-slate-800/50 text-slate-600 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700/50"}`,children:E},E))})]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center gap-3 px-2",children:[o.jsx(Xt,{className:"w-6 h-6 text-emerald-500"}),o.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white italic",children:""})]}),o.jsx(rg,{data:me,onEdit:to,onDelete:rt,accountTypes:g,accountStages:f,accountStatuses:b})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[o.jsx(ar,{title:"",value:De.totalExpenses,prefix:"$",icon:o.jsx(nn,{}),color:"text-rose-400"}),o.jsx(ar,{title:"",value:De.totalRevenue,prefix:"$",icon:o.jsx(an,{}),color:"text-emerald-400"}),o.jsx(ar,{title:"",value:De.netProfit,prefix:"$",icon:o.jsx(Co,{}),color:De.netProfit>=0?"text-cyan-400":"text-rose-400"}),o.jsx(ar,{title:" (ROI)",value:De.roi,suffix:"%",icon:o.jsx(Xt,{}),color:"text-purple-400"})]}),o.jsx("div",{className:"flex flex-col gap-8",children:o.jsxs("div",{className:"w-full bg-white dark:bg-[#111827]/60 backdrop-blur-sm rounded-3xl border border-slate-200 dark:border-slate-800 p-8 flex flex-col relative overflow-hidden group",children:[o.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-50 group-hover:opacity-100 transition-opacity",children:o.jsx("div",{className:"w-24 h-24 bg-emerald-500/20 blur-[60px] rounded-full pointer-events-none"})}),o.jsx("div",{className:"flex items-center justify-between mb-8 relative z-10",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-emerald-500/10 rounded-lg border border-emerald-500/20",children:o.jsx(sn,{className:"w-5 h-5 text-emerald-400"})}),o.jsx("h3",{className:"font-bold text-lg text-slate-900 dark:text-white",children:""})]})}),o.jsxs("div",{className:"flex-1 flex flex-col justify-center gap-10",children:[o.jsx(ba,{label:"",value:se.totalRevenue,total:se.totalRevenue+se.totalExpenses,color:"bg-emerald-500",showPercent:!1}),o.jsx(ba,{label:"",value:se.totalExpenses,total:se.totalRevenue+se.totalExpenses,color:"bg-rose-500",showPercent:!1}),o.jsxs("div",{className:"mt-4 pt-6 border-t border-slate-200 dark:border-slate-700",children:[o.jsxs("div",{className:"flex justify-between items-center text-sm",children:[o.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:" (/)"}),o.jsxs("span",{className:"text-slate-900 dark:text-white font-mono font-bold",children:[se.roi.toFixed(1),"%"]})]}),o.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-800/50 h-2 rounded-full mt-3 overflow-hidden",children:o.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-cyan-500",style:{width:`${Math.min(100,Math.max(0,se.roi))}%`}})})]})]})]})}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center gap-3 px-2",children:[o.jsx(sn,{className:"w-6 h-6 text-emerald-500"}),o.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white italic",children:""})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"bg-white dark:bg-[#111827]/60 backdrop-blur-sm p-8 rounded-3xl border border-slate-200 dark:border-slate-800 hover:border-emerald-500/50 transition-all flex flex-col items-center justify-center relative min-h-[320px]",children:[o.jsxs("h3",{className:"text-sm font-bold text-slate-600 dark:text-slate-400 uppercase tracking-widest mb-8 flex items-center gap-2",children:[o.jsx(an,{className:"w-4 h-4 text-emerald-500"})," "]}),o.jsx(ss,{data:se.payoutStats,total:se.totalRevenue,label:"TOTAL REV"})]}),o.jsxs("div",{className:"bg-white dark:bg-[#111827]/60 backdrop-blur-sm p-8 rounded-3xl border border-slate-200 dark:border-slate-800 hover:border-emerald-500/50 transition-all flex flex-col items-center justify-center relative min-h-[320px]",children:[o.jsxs("h3",{className:"text-sm font-bold text-slate-600 dark:text-slate-400 uppercase tracking-widest mb-8 flex items-center gap-2",children:[o.jsx(nn,{className:"w-4 h-4 text-rose-500"}),"  (By Firm)"]}),o.jsx(ss,{data:se.costStats,total:se.totalCostForChart,label:"TOTAL COST"})]}),o.jsxs("div",{className:"bg-white dark:bg-[#111827]/60 backdrop-blur-sm p-8 rounded-3xl border border-slate-200 dark:border-slate-800 hover:border-emerald-500/50 transition-all flex flex-col items-center justify-center relative min-h-[320px]",children:[o.jsxs("h3",{className:"text-sm font-bold text-slate-600 dark:text-slate-400 uppercase tracking-widest mb-8 flex items-center gap-2",children:[o.jsx(Xt,{className:"w-4 h-4 text-cyan-400"}),"  (Margin)"]}),o.jsx(ss,{data:se.marginStats,total:se.totalPositiveNetProfit,label:"NET PROFIT"})]})]})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center gap-3 px-2",children:[o.jsx(Xt,{className:"w-6 h-6 text-emerald-500"}),o.jsx("h2",{className:"text-xl font-bold text-slate-900 dark:text-white italic",children:""})]}),o.jsxs("div",{className:"bg-white dark:bg-[#111827]/60 backdrop-blur-sm p-8 rounded-3xl border border-slate-200 dark:border-slate-800 hover:border-emerald-500/50 transition-all",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h3",{className:"text-sm font-bold text-slate-600 dark:text-slate-400 uppercase tracking-widest mb-2",children:""}),o.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-500",children:""})]}),o.jsx(tg,{data:me})]})]})]}),o.jsx(sg,{isOpen:j,onClose:Zs,isEditing:!!U,formData:F,setFormData:Te,handleSubmit:Dr,accountStages:f,accountTypes:Ce,accountSizes:h,accountStatuses:b,availableFirms:Jt}),A&&o.jsx(X0,{isOpen:A,onClose:()=>I(!1),firms:c,setFirms:Qs,accountSizes:h,setAccountSizes:ge,accountStages:f,setAccountStages:qe,accountTypes:g,setAccountTypes:Zi,accountStatuses:b,setAccountStatuses:eo}),X&&o.jsx(Pd,{isOpen:X,onClose:()=>M(!1),session:r})]}):o.jsx(Td,{})};export{ug as default};
